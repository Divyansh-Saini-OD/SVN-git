DECLARE

CURSOR active_check_cur
IS 
   SELECT a.primary_flag ,
          a.payment_method_code ,
		  a.ext_pmt_party_id payment_party_id,
		  a.ext_party_pmt_mthd_id party_pmt_mthd_id
     FROM iby_ext_party_pmt_mthds a,
	      iby_external_payees_all b,
          ap_supplier_sites_all c,
          ap_suppliers d
    WHERE 1 = 1
	  AND d.vendor_id = c.vendor_id
      AND c.vendor_site_id = b.supplier_site_id
	  AND a.ext_pmt_party_id = b.ext_payee_id
	  AND a.primary_flag = 'Y'
      AND c.attribute8 LIKE 'TR%'
      AND ((c.inactive_date IS NULL) OR (c.inactive_date > SYSDATE)) 
      AND c.vendor_site_code IN ( 'TCN999916',
                                  'TCN996859PR',
                                  'TCN989529',
                                  'TCN985082',
                                  'TCN982525',
                                  'TCN955618',
                                  'TCN941060PR',
                                  'TCN936279PY',
                                  'TCN936279PR',
                                  'TCN885035PY',
                                  'TCN885035PR',
                                  'TCN877992PY',
                                  'TCN877992PR',
                                  'TCN850743PY',
                                  'TCN850743PR',
                                  'TCN833759PR',
                                  'TCN816390PY',
                                  'TCN816390PR',
                                  'TCN814110PY',
                                  'TCN814110PR',
                                  'TCN806250PY',
                                  'TCN806250PR',
                                  'TCN803710PY',
                                  'TCN803710PR',
                                  'TCN799726PR',
                                  'TCN799019PY',
                                  'TCN799019PR',
                                  'TCN789894PY',
                                  'TCN789894PR',
                                  'TCN768637PY',
                                  'TCN768637PR',
                                  'TCN762270',
                                  'TCN754852PY',
                                  'TCN754852PR',
                                  'TCN745013PY',
                                  'TCN745013PR',
                                  'TCN738623PY',
                                  'TCN738623PR',
                                  'TCN735374PY',
                                  'TCN735374PR',
                                  'TCN730670PY',
                                  'TCN730670PR',
                                  'TCN722847PY',
                                  'TCN722847PR',
                                  'TCN721899PY',
                                  'TCN721899PR',
                                  'TCN720419',
                                  'TCN688529',
                                  'TCN686233',
                                  'TCN681451',
                                  'TCN679120PY',
                                  'TCN679120PR',
                                  'TCN1258125',
                                  'TCN1252764',
                                  'TCN1252756PY',
                                  'TCN1252756PR',
                                  'TCN1252111PY',
                                  'TCN1252111PR',
                                  'TCN1247461PY',
                                  'TCN1247461PR',
                                  'TCN1247460',
                                  'TCN1242280',
                                  'TCN1242136',
                                  'TCN1242082',
                                  'TCN1240227',
                                  'TCN1240118PY',
                                  'TCN1240118PR',
                                  'TCN1234606PY',
                                  'TCN1234606PR',
                                  'TCN1213063',
                                  'TCN1207813',
                                  'TCN1207728',
                                  'TCN1189998PY',
                                  'TCN1189998PR',
                                  'TCN1172035',
                                  'TCN1168788',
                                  'TCN1153549',
                                  'TCN1146484PY',
                                  'TCN1146484PR',
                                  'TCN1146219',
                                  'TCN1121645PY',
                                  'TCN1121645PR',
                                  'TCN1095323',
                                  'TCN1088102',
                                  'TCN1080665',
                                  'TCN1069266',
                                  'TCN1048006',
                                  'TCN1044750',
                                  'TCN1036143',
                                  'TCN1031912',
                                  'TCN1015988',
                                  'TCN1012530',
                                  'TCN1009565',
                                  'TCN1009526',
                                  'TCN1009448',
                                  'TCN1003932',
                                  'TCN1003839',
                                  'TCN1003314',
                                  'TCN0000479241',
                                  'TCN0000479071',
                                  'TCN0000476872',
                                  'TCN0000476368',
                                  'TCN0000470104PY',
                                  'TCN0000470104PR',
                                  'TCN0000468154PY',
                                  'TCN0000468154PR',
                                  'TCN0000468153',
                                  'TCN0000467448',
                                  'TCN0000467333PY',
                                  'TCN0000467333PR',
                                  'TCN0000466952',
                                  'TCN0000465376',
                                  'TCN0000464645',
                                  'TCN0000463425',
                                  'TCN0000463424',
                                  'TCN0000462045PY',
                                  'TCN0000462045PR',
                                  'TCN0000461686',
                                  'TCN0000454454PR',
                                  'TCN0000451028',
                                  'TCN0000443274PR',
                                  'TCN0000443133',
                                  'TCN0000442643PY',
                                  'TCN0000442643PR',
                                  'TCN0000442272',
                                  'TCN0000442064PR',
                                  'TCN0000442063PY',
                                  'TCN0000442063PR',
                                  'TCN0000441461PY',
                                  'TCN0000441461PR',
                                  'TCN0000440946PY',
                                  'TCN0000440946PR',
                                  'TCN0000439027PY',
                                  'TCN0000439027PR',
                                  'TCN0000435850PR',
                                  'TCN0000435353',
                                  'TCN0000427033',
                                  'TCN0000421952',
                                  'TCN0000418176PY',
                                  'TCN0000418176PR',
                                  'TCN0000418118PR',
                                  'TCN0000416924PY',
                                  'TCN0000416924PR',
                                  'TCN0000416241',
                                  'TCN0000416040',
                                  'TCN0000411849PY',
                                  'TCN0000411849PR',
                                  'TCN0000411183PY',
                                  'TCN0000411183PR',
                                  'TCN0000409772PY',
                                  'TCN0000409772PR',
                                  'TCN0000408809PY',
                                  'TCN0000408809PR',
                                  'TCN0000407383PR',
                                  'TCN0000407013',
                                  'TCN0000405615',
                                  'TCN0000009992PR',
                                  'TCN0000009989PR',
                                  'TCN0000009982',
                                  'TCN0000009969',
                                  'TCN0000009967PR',
                                  'TCN0000009965',
                                  'TCN0000009947PR',
                                  'TCN0000009933',
                                  'TCN0000009925',
                                  'TCN0000009923PR',
                                  'OMX999948',
                                  'OMX1146870',
                                  'OMX1091066',
                                  'OMX1069331',
                                  'OMX1048068',
                                  'OMX1004827',
                                  'OMX1004653',
                                  'OMX1004213',
                                  'OMX1004176',
                                  'OMX1004165',
                                  'OMX1004055',
                                  'OMX1004048',
                                  'OMX1003987',
                                  'OMX1003959',
                                  'OMX1003889',
                                  'OMX1003638',
                                  'OMX1003548',
                                  'OMX1003527',
                                  'OMX1003426',
                                  'OMX1003334',
                                  'OMX1003302',
                                  'OMX1003266',
                                  'OMX1003192',
                                  'OMX1003102',
                                  'OMX1003001',
                                  'OMX1002626PY',
                                  'OMX1002626PR',
                                  'OMX1002574',
                                  'OMX1002531',
                                  'OMX1002404',
                                  'OMX1002362',
                                  'OMX1002361',
                                  'OMX1002248',
                                  'OMX1002217',
                                  'OMX1002126',
                                  'OMX1002052',
                                  'OMX1001942',
                                  'OMX1001888',
                                  'OMX1001711',
                                  'OMX1001699',
                                  'OMX1001622',
                                  'OMX1001456',
                                  'OMX1001414',
                                  'OMX1001405',
                                  'OMX1001349',
                                  'OMX1001246',
                                  'OMX1001231',
                                  'OMX1001163',
                                  'OMX1001150',
                                  'OMX1001133',
                                  'OMX1001093',
                                  'OMX1001047',
                                  'OMX1001040',
                                  'OMX1000989',
                                  'OMX1000829',
                                  'OMX1000780',
                                  'OMX1000745',
                                  'OMX1000717',
                                  'OMX1000541',
                                  'OMX1000520',
                                  'OMX1000417',
                                  'OMX1000153',
                                  'OMX1000011',
                                  'OMX1000005'
                                 );
								 
	CURSOR active_eft_cur
	IS
	  SELECT a.primary_flag ,
          a.payment_method_code ,
		  a.ext_pmt_party_id payment_party_id,
		  a.ext_party_pmt_mthd_id party_pmt_mthd_id
     FROM iby_ext_party_pmt_mthds a,
	      iby_external_payees_all b,
          ap_supplier_sites_all c,
          ap_suppliers d
    WHERE 1 = 1
	  AND d.vendor_id = c.vendor_id
      AND c.vendor_site_id = b.supplier_site_id
	  AND a.ext_pmt_party_id = b.ext_payee_id
	  AND a.primary_flag = 'Y'
      AND c.attribute8 LIKE 'TR%'
      AND ((c.inactive_date IS NULL) OR (c.inactive_date > SYSDATE)) 
      AND c.vendor_site_code IN ( 'TCN999715',
                                  'TCN997636',
                                  'TCN996859PY',
                                  'TCN968098',
                                  'TCN966833',
                                  'TCN955959',
                                  'TCN948720PY',
                                  'TCN948720PR',
                                  'TCN941060PY',
                                  'TCN934999PY',
                                  'TCN934999PR',
                                  'TCN897513PY',
                                  'TCN897513PR',
                                  'TCN854783PY',
                                  'TCN854783PR',
                                  'TCN844260PY',
                                  'TCN844260PR',
                                  'TCN841972PY',
                                  'TCN841972PR',
                                  'TCN833759PY',
                                  'TCN819350PY',
                                  'TCN819350PR',
                                  'TCN818110PY',
                                  'TCN818110PR',
                                  'TCN817249PY',
                                  'TCN817249PR',
                                  'TCN807335PY',
                                  'TCN807335PR',
                                  'TCN805941PY',
                                  'TCN805941PR',
                                  'TCN799726PY',
                                  'TCN787250PY',
                                  'TCN787250PR',
                                  'TCN766630PY',
                                  'TCN766630PR',
                                  'TCN753095PY',
                                  'TCN753095PR',
                                  'TCN742576PY',
                                  'TCN742576PR',
                                  'TCN741085PY',
                                  'TCN741085PR',
                                  'TCN738625PY',
                                  'TCN738625PR',
                                  'TCN722006PY',
                                  'TCN722006PR',
                                  'TCN720418',
                                  'TCN714055',
                                  'TCN710748',
                                  'TCN703323',
                                  'TCN690148PY',
                                  'TCN690148PR',
                                  'TCN683515',
                                  'TCN674382',
                                  'TCN673969PY',
                                  'TCN673969PR',
                                  'TCN1190020',
                                  'TCN1190005',
                                  'TCN1156931PY',
                                  'TCN1156931PR',
                                  'TCN1132448',
                                  'TCN1121457',
                                  'TCN1115834',
                                  'TCN1110979',
                                  'TCN1098430',
                                  'TCN1069870',
                                  'TCN1063905',
                                  'TCN1052665',
                                  'TCN1044709',
                                  'TCN1025879PY',
                                  'TCN1025879PR',
                                  'TCN1024985',
                                  'TCN1012814',
                                  'TCN1012598',
                                  'TCN1005539',
                                  'TCN1005530',
                                  'TCN1004663',
                                  'TCN1001968',
                                  'TCN1001486',
                                  'TCN1000634',
                                  'TCN0000479740',
                                  'TCN0000479537PY',
                                  'TCN0000479537PR',
                                  'TCN0000479508',
                                  'TCN0000479073PY',
                                  'TCN0000479073PR',
                                  'TCN0000478765PY',
                                  'TCN0000478765PR',
                                  'TCN0000468756PY',
                                  'TCN0000468756PR',
                                  'TCN0000467627PY',
                                  'TCN0000467627PR',
                                  'TCN0000466110',
                                  'TCN0000463425PY',
                                  'TCN0000463425PR',
                                  'TCN0000462504PY',
                                  'TCN0000462504PR',
                                  'TCN0000456873',
                                  'TCN0000456657PY',
                                  'TCN0000456657PR',
                                  'TCN0000455545PY',
                                  'TCN0000455545PR',
                                  'TCN0000454454PY',
                                  'TCN0000453870',
                                  'TCN0000449834PY',
                                  'TCN0000449834PR',
                                  'TCN0000446741PY',
                                  'TCN0000446741PR',
                                  'TCN0000443274PY',
                                  'TCN0000443193PY',
                                  'TCN0000443193PR',
                                  'TCN0000442064PY',
                                  'TCN0000439894PY',
                                  'TCN0000439894PR',
                                  'TCN0000433395',
                                  'TCN0000430490PY',
                                  'TCN0000430490PR',
                                  'TCN0000428582PY',
                                  'TCN0000428582PR',
                                  'TCN0000428390',
                                  'TCN0000428384PY',
                                  'TCN0000428384PR',
                                  'TCN0000418179',
                                  'TCN0000418118PY',
                                  'TCN0000410039PY',
                                  'TCN0000410039PR',
                                  'TCN0000407499PY',
                                  'TCN0000407499PR',
                                  'TCN0000407383PY',
                                  'TCN0000407014',
                                  'TCN0000406626PY',
                                  'TCN0000406626PR',
                                  'TCN0000404677',
                                  'TCN0000404275',
                                  'TCN0000404043PY',
                                  'TCN0000404043PR',
                                  'TCN0000402911PY',
                                  'TCN0000402911PR',
                                  'TCN0000401769',
                                  'TCN0000401194PY',
                                  'TCN0000401194PR',
                                  'TCN0000009992PY',
                                  'TCN0000009989PY',
                                  'TCN0000009986PY',
                                  'TCN0000009986PR',
                                  'TCN0000009983PY',
                                  'TCN0000009983PR',
                                  'TCN0000009977',
                                  'TCN0000009976',
                                  'TCN0000009974PY',
                                  'TCN0000009974PR',
                                  'TCN0000009970PY',
                                  'TCN0000009970PR',
                                  'TCN0000009967PY',
                                  'TCN0000009947PY',
                                  'TCN0000009940PY',
                                  'TCN0000009940PR',
                                  'TCN0000009938',
                                  'TCN0000009927PY',
                                  'TCN0000009927PR',
                                  'TCN0000009926PY',
                                  'TCN0000009926PR',
                                  'TCN0000009923PY',
                                  'OMX999979',
                                  'OMX999789',
                                  'OMX999773',
                                  'OMX1031968',
                                  'OMX1004826',
                                  'OMX1004656',
                                  'OMX1004206',
                                  'OMX1004073',
                                  'OMX1004063',
                                  'OMX1003872',
                                  'OMX1003536',
                                  'OMX1003462',
                                  'OMX1003433',
                                  'OMX1003405',
                                  'OMX1003043',
                                  'OMX1002937',
                                  'OMX1002897',
                                  'OMX1002703',
                                  'OMX1002677',
                                  'OMX1002675',
                                  'OMX1002597',
                                  'OMX1002419',
                                  'OMX1002418',
                                  'OMX1002364',
                                  'OMX1002207',
                                  'OMX1002094',
                                  'OMX1000967',
                                  'OMX1000963',
                                  'OMX1000934',
                                  'OMX1000811',
                                  'OMX1000767',
                                  'OMX1000698',
                                  'OMX1000682',
                                  'OMX1000540',
                                  'OMX1000488',
                                  'OMX1000483',
                                  'OMX1000397',
                                  'OMX1000323',
                                  'OMX1000247'
                                );
								
	CURSOR inactive_check_cur
    IS 
        SELECT a.primary_flag ,
               a.payment_method_code ,
		       a.ext_pmt_party_id payment_party_id,
		       a.ext_party_pmt_mthd_id party_pmt_mthd_id
          FROM iby_ext_party_pmt_mthds a,
	           iby_external_payees_all b,
               ap_supplier_sites_all c,
               ap_suppliers d
         WHERE 1 = 1
	       AND d.vendor_id = c.vendor_id
           AND c.vendor_site_id = b.supplier_site_id
	       AND a.ext_pmt_party_id = b.ext_payee_id
		   AND a.primary_flag = 'Y'
           AND c.attribute8 LIKE 'TR%'
           AND ((c.inactive_date IS NOT NULL) OR (c.inactive_date < SYSDATE)) 
           AND c.vendor_site_code IN ( 'TCN984221',
                                       'TCN984026PY',
                                       'TCN984026PR',
                                       'TCN950960PY',
                                       'TCN950960PR',
                                       'TCN945680PY',
                                       'TCN945680PR',
                                       'TCN941060PY',
                                       'TCN941060PR',
                                       'TCN939457PY',
                                       'TCN939457PR',
                                       'TCN889372PY',
                                       'TCN889372PR',
                                       'TCN883077PY',
                                       'TCN883077PR',
                                       'TCN833759PY',
                                       'TCN833759PR',
                                       'TCN807890PY',
                                       'TCN807890PR',
                                       'TCN803713PY',
                                       'TCN803713PR',
                                       'TCN799726PY',
                                       'TCN799726PR',
                                       'TCN792912PY',
                                       'TCN792912PR',
                                       'TCN791731PY',
                                       'TCN791731PR',
                                       'TCN791433PY',
                                       'TCN791433PR',
                                       'TCN790869',
                                       'TCN789524',
                                       'TCN762270',
                                       'TCN760769PY',
                                       'TCN760769PR',
                                       'TCN755868PY',
                                       'TCN755868PY',
                                       'TCN755868PR',
                                       'TCN755868PR',
                                       'TCN754854PY',
                                       'TCN754854PR',
                                       'TCN754221PY',
                                       'TCN754221PR',
                                       'TCN752231PY',
                                       'TCN752231PR',
                                       'TCN748682PY',
                                       'TCN748682PR',
                                       'TCN742002PY',
                                       'TCN742002PR',
                                       'TCN739398PY',
                                       'TCN739398PR',
                                       'TCN714476',
                                       'TCN714006',
                                       'TCN690465PY',
                                       'TCN690465PR',
                                       'TCN690463PY',
                                       'TCN690463PR',
                                       'TCN689463PY',
                                       'TCN689463PR',
                                       'TCN686662',
                                       'TCN686660',
                                       'TCN1137757',
                                       'TCN1132448',
                                       'TCN1052665',
                                       'TCN1052665',
                                       'TCN1025879',
                                       'TCN1002510',
                                       'TCN1000890',
                                       'TCN0000479740',
                                       'TCN0000479524',
                                       'TCN0000479237',
                                       'TCN0000478311',
                                       'TCN0000477745',
                                       'TCN0000476598PY',
                                       'TCN0000476598PR',
                                       'TCN0000473371PY',
                                       'TCN0000473371PR',
                                       'TCN0000472275',
                                       'TCN0000471266',
                                       'TCN0000470867',
                                       'TCN0000470558',
                                       'TCN0000470558',
                                       'TCN0000466873PY',
                                       'TCN0000466873PR',
                                       'TCN0000464525',
                                       'TCN0000464403PY',
                                       'TCN0000464403PR',
                                       'TCN0000463968',
                                       'TCN0000463425',
                                       'TCN0000462270',
                                       'TCN0000461657PY',
                                       'TCN0000461657PR',
                                       'TCN0000460087',
                                       'TCN0000459904',
                                       'TCN0000458838PY',
                                       'TCN0000458838PR',
                                       'TCN0000455727PY',
                                       'TCN0000455727PR',
                                       'TCN0000455455',
                                       'TCN0000455108',
                                       'TCN0000454454PY',
                                       'TCN0000454454PR',
                                       'TCN0000454286',
                                       'TCN0000453872',
                                       'TCN0000452231',
                                       'TCN0000452030',
                                       'TCN0000450506',
                                       'TCN0000446793',
                                       'TCN0000446284PY',
                                       'TCN0000446284PR',
                                       'TCN0000445306',
                                       'TCN0000444398',
                                       'TCN0000443274PY',
                                       'TCN0000443274PR',
                                       'TCN0000442836PY',
                                       'TCN0000442836PR',
                                       'TCN0000442628PY',
                                       'TCN0000442628PR',
                                       'TCN0000442531',
                                       'TCN0000442322',
                                       'TCN0000442126PY',
                                       'TCN0000442126PR',
                                       'TCN0000442064PY',
                                       'TCN0000442064PR',
                                       'TCN0000442063',
                                       'TCN0000441919',
                                       'TCN0000441744',
                                       'TCN0000441704',
                                       'TCN0000440734PY',
                                       'TCN0000440734PR',
                                       'TCN0000440104PY',
                                       'TCN0000440104PR',
                                       'TCN0000439494',
                                       'TCN0000437800',
                                       'TCN0000437505',
                                       'TCN0000436940',
                                       'TCN0000436870',
                                       'TCN0000436200PY',
                                       'TCN0000436200PR',
                                       'TCN0000435850PY',
                                       'TCN0000435186',
                                       'TCN0000435054',
                                       'TCN0000434870',
                                       'TCN0000434666',
                                       'TCN0000434062PY',
                                       'TCN0000434062PR',
                                       'TCN0000433501PY',
                                       'TCN0000433501PR',
                                       'TCN0000432573',
                                       'TCN0000432526',
                                       'TCN0000431510',
                                       'TCN0000431149PY',
                                       'TCN0000431149PR',
                                       'TCN0000431091PY',
                                       'TCN0000431091PR',
                                       'TCN0000430963',
                                       'TCN0000430436PY',
                                       'TCN0000430436PR',
                                       'TCN0000429909',
                                       'TCN0000429837',
                                       'TCN0000429489',
                                       'TCN0000425434',
                                       'TCN0000422890PY',
                                       'TCN0000422890PR',
                                       'TCN0000422394',
                                       'TCN0000422393',
                                       'TCN0000420882',
                                       'TCN0000420155',
                                       'TCN0000419953',
                                       'TCN0000419859PY',
                                       'TCN0000419859PR',
                                       'TCN0000419382',
                                       'TCN0000418763',
                                       'TCN0000418118PY',
                                       'TCN0000418118PR',
                                       'TCN0000416925',
                                       'TCN0000416595PY',
                                       'TCN0000416595PR',
                                       'TCN0000415657',
                                       'TCN0000415651',
                                       'TCN0000415643PY',
                                       'TCN0000415643PR',
                                       'TCN0000415608',
                                       'TCN0000415607PY',
                                       'TCN0000415607PR',
                                       'TCN0000415603',
                                       'TCN0000415599',
                                       'TCN0000415598',
                                       'TCN0000415596PY',
                                       'TCN0000415596PR',
                                       'TCN0000415595PY',
                                       'TCN0000415595PR',
                                       'TCN0000415594',
                                       'TCN0000415590PY',
                                       'TCN0000415590PR',
                                       'TCN0000415584',
                                       'TCN0000415576',
                                       'TCN0000411029PY',
                                       'TCN0000411029PR',
                                       'TCN0000408810',
                                       'TCN0000407383PY',
                                       'TCN0000407383PR',
                                       'TCN0000405576',
                                       'TCN0000404818',
                                       'TCN0000404698',
                                       'TCN0000402832PY',
                                       'TCN0000402832PR',
                                       'TCN0000402832',
                                       'TCN0000401976PY',
                                       'TCN0000401976PR',
                                       'TCN0000401900',
                                       'TCN0000009994PY',
                                       'TCN0000009994PR',
                                       'TCN0000009993PY',
                                       'TCN0000009993PR',
                                       'TCN0000009992PY',
                                       'TCN0000009992PR',
                                       'TCN0000009990PY',
                                       'TCN0000009990PR',
                                       'TCN0000009989PY',
                                       'TCN0000009989PR',
                                       'TCN0000009985',
                                       'TCN0000009981',
                                       'TCN0000009980PY',
                                       'TCN0000009980PR',
                                       'TCN0000009979',
                                       'TCN0000009978',
                                       'TCN0000009973',
                                       'TCN0000009971PY',
                                       'TCN0000009971PR',
                                       'TCN0000009968PY',
                                       'TCN0000009968PR',
                                       'TCN0000009967PY',
                                       'TCN0000009967PR',
                                       'TCN0000009964',
                                       'TCN0000009949PY',
                                       'TCN0000009949PR',
                                       'TCN0000009947PY',
                                       'TCN0000009947PR',
                                       'TCN0000009946',
                                       'TCN0000009945PY',
                                       'TCN0000009945PR',
                                       'TCN0000009944PY',
                                       'TCN0000009944PR',
                                       'TCN0000009943',
                                       'TCN0000009939',
                                       'TCN0000009937PY',
                                       'TCN0000009937PR',
                                       'TCN0000009936',
                                       'TCN0000009934',
                                       'TCN0000009928',
                                       'TCN0000009923PY',
                                       'TCN0000009923PR',
                                       'TCN0000007269',
                                       'OMX999992',
                                       'OMX999982',
                                       'OMX999981',
                                       'OMX999980',
                                       'OMX999966',
                                       'OMX999965',
                                       'OMX999964',
                                       'OMX999963',
                                       'OMX999962',
                                       'OMX999951',
                                       'OMX999948',
                                       'OMX999937',
                                       'OMX999912',
                                       'OMX999858',
                                       'OMX999805',
                                       'OMX999804',
                                       'OMX999790',
                                       'OMX999779',
                                       'OMX999774',
                                       'OMX999770',
                                       'OMX999765',
                                       'OMX999764',
                                       'OMX1156933',
                                       'OMX1146569',
                                       'OMX1146533',
                                       'OMX1144013',
                                       'OMX1095333',
                                       'OMX1091012',
                                       'OMX1069333',
                                       'OMX1048101',
                                       'OMX1048087',
                                       'OMX1048068',
                                       'OMX1047938PY',
                                       'OMX1047938PY',
                                       'OMX1047938PR',
                                       'OMX1047938PR',
                                       'OMX1044859',
                                       'OMX1033185',
                                       'OMX1033185',
                                       'OMX1005303',
                                       'OMX1005257',
                                       'OMX1005256',
                                       'OMX1005253',
                                       'OMX1005173',
                                       'OMX1005170',
                                       'OMX1004864',
                                       'OMX1004859',
                                       'OMX1004849',
                                       'OMX1004827',
                                       'OMX1004827',
                                       'OMX1004826',
                                       'OMX1004826',
                                       'OMX1004740',
                                       'OMX1004737',
                                       'OMX1004737',
                                       'OMX1004737',
                                       'OMX1004734',
                                       'OMX1004734',
                                       'OMX1004734',
                                       'OMX1004734',
                                       'OMX1004728',
                                       'OMX1004728',
                                       'OMX1004717',
                                       'OMX1004714',
                                       'OMX1004682',
                                       'OMX1004679',
                                       'OMX1004207',
                                       'OMX1004197',
                                       'OMX1004191',
                                       'OMX1004176',
                                       'OMX1004175',
                                       'OMX1004175',
                                       'OMX1004169',
                                       'OMX1004164',
                                       'OMX1004114',
                                       'OMX1004109',
                                       'OMX1004073',
                                       'OMX1004063',
                                       'OMX1004060',
                                       'OMX1004056',
                                       'OMX1004054',
                                       'OMX1004049',
                                       'OMX1004042',
                                       'OMX1004041',
                                       'OMX1004036',
                                       'OMX1004010',
                                       'OMX1004001',
                                       'OMX1003988',
                                       'OMX1003988',
                                       'OMX1003987',
                                       'OMX1003961',
                                       'OMX1003960',
                                       'OMX1003958',
                                       'OMX1003933',
                                       'OMX1003905',
                                       'OMX1003880',
                                       'OMX1003879',
                                       'OMX1003875',
                                       'OMX1003804',
                                       'OMX1003798',
                                       'OMX1003719',
                                       'OMX1003678',
                                       'OMX1003678',
                                       'OMX1003647',
                                       'OMX1003637',
                                       'OMX1003626',
                                       'OMX1003572',
                                       'OMX1003572',
                                       'OMX1003571',
                                       'OMX1003571',
                                       'OMX1003544',
                                       'OMX1003543',
                                       'OMX1003537',
                                       'OMX1003528',
                                       'OMX1003523',
                                       'OMX1003519',
                                       'OMX1003462',
                                       'OMX1003461',
                                       'OMX1003434',
                                       'OMX1003434',
                                       'OMX1003433',
                                       'OMX1003406',
                                       'OMX1003404',
                                       'OMX1003358',
                                       'OMX1003335',
                                       'OMX1003333',
                                       'OMX1003319',
                                       'OMX1003304',
                                       'OMX1003298',
                                       'OMX1003268',
                                       'OMX1003204',
                                       'OMX1003193',
                                       'OMX1003058',
                                       'OMX1003043',
                                       'OMX1003042',
                                       'OMX1003042',
                                       'OMX1003000',
                                       'OMX1002984',
                                       'OMX1002979',
                                       'OMX1002958',
                                       'OMX1002950',
                                       'OMX1002936',
                                       'OMX1002896',
                                       'OMX1002848',
                                       'OMX1002847',
                                       'OMX1002792',
                                       'OMX1002792',
                                       'OMX1002768',
                                       'OMX1002703',
                                       'OMX1002702',
                                       'OMX1002702',
                                       'OMX1002678',
                                       'OMX1002677',
                                       'OMX1002676',
                                       'OMX1002675',
                                       'OMX1002657',
                                       'OMX1002656',
                                       'OMX1002641',
                                       'OMX1002625',
                                       'OMX1002602',
                                       'OMX1002597',
                                       'OMX1002597',
                                       'OMX1002597',
                                       'OMX1002592',
                                       'OMX1002588',
                                       'OMX1002575',
                                       'OMX1002536',
                                       'OMX1002530',
                                       'OMX1002521',
                                       'OMX1002469',
                                       'OMX1002429',
                                       'OMX1002424',
                                       'OMX1002420',
                                       'OMX1002403',
                                       'OMX1002380',
                                       'OMX1002365',
                                       'OMX1002363',
                                       'OMX1002307',
                                       'OMX1002284',
                                       'OMX1002284',
                                       'OMX1002283',
                                       'OMX1002283',
                                       'OMX1002267',
                                       'OMX1002262',
                                       'OMX1002262',
                                       'OMX1002261',
                                       'OMX1002261',
                                       'OMX1002245',
                                       'OMX1002245',
                                       'OMX1002230',
                                       'OMX1002230',
                                       'OMX1002220',
                                       'OMX1002220',
                                       'OMX1002206',
                                       'OMX1002196',
                                       'OMX1002146',
                                       'OMX1002145',
                                       'OMX1002133',
                                       'OMX1002118',
                                       'OMX1002117',
                                       'OMX1002111',
                                       'OMX1002095',
                                       'OMX1002078',
                                       'OMX1002051',
                                       'OMX1002041',
                                       'OMX1002040',
                                       'OMX1002037',
                                       'OMX1002036',
                                       'OMX1001943',
                                       'OMX1001939',
                                       'OMX1001915',
                                       'OMX1001843',
                                       'OMX1001842',
                                       'OMX1001808',
                                       'OMX1001782',
                                       'OMX1001736',
                                       'OMX1001735',
                                       'OMX1001716',
                                       'OMX1001702',
                                       'OMX1001702',
                                       'OMX1001635',
                                       'OMX1001623',
                                       'OMX1001568',
                                       'OMX1001536',
                                       'OMX1001529',
                                       'OMX1001528',
                                       'OMX1001487',
                                       'OMX1001485',
                                       'OMX1001459',
                                       'OMX1001451',
                                       'OMX1001445',
                                       'OMX1001415',
                                       'OMX1001386',
                                       'OMX1001385',
                                       'OMX1001356',
                                       'OMX1001350',
                                       'OMX1001350',
                                       'OMX1001349',
                                       'OMX1001302',
                                       'OMX1001284',
                                       'OMX1001281',
                                       'OMX1001250',
                                       'OMX1001240',
                                       'OMX1001239',
                                       'OMX1001220',
                                       'OMX1001215',
                                       'OMX1001214',
                                       'OMX1001183',
                                       'OMX1001164',
                                       'OMX1001134',
                                       'OMX1001123',
                                       'OMX1001122',
                                       'OMX1001094',
                                       'OMX1001076',
                                       'OMX1001075',
                                       'OMX1001046',
                                       'OMX1001041',
                                       'OMX1001023',
                                       'OMX1001016',
                                       'OMX1000967',
                                       'OMX1000966',
                                       'OMX1000966',
                                       'OMX1000963',
                                       'OMX1000960',
                                       'OMX1000960',
                                       'OMX1000955',
                                       'OMX1000947',
                                       'OMX1000946',
                                       'OMX1000938',
                                       'OMX1000917',
                                       'OMX1000917',
                                       'OMX1000904',
                                       'OMX1000903',
                                       'OMX1000829',
                                       'OMX1000822',
                                       'OMX1000814',
                                       'OMX1000805',
                                       'OMX1000780',
                                       'OMX1000768',
                                       'OMX1000744',
                                       'OMX1000743',
                                       'OMX1000718',
                                       'OMX1000710',
                                       'OMX1000699',
                                       'OMX1000649',
                                       'OMX1000637',
                                       'OMX1000605',
                                       'OMX1000604',
                                       'OMX1000579',
                                       'OMX1000578',
                                       'OMX1000574',
                                       'OMX1000573',
                                       'OMX1000557',
                                       'OMX1000542',
                                       'OMX1000539',
                                       'OMX1000521',
                                       'OMX1000493',
                                       'OMX1000489',
                                       'OMX1000483',
                                       'OMX1000469',
                                       'OMX1000468',
                                       'OMX1000423',
                                       'OMX1000422',
                                       'OMX1000409',
                                       'OMX1000398',
                                       'OMX1000391',
                                       'OMX1000390',
                                       'OMX1000330',
                                       'OMX1000324',
                                       'OMX1000305',
                                       'OMX1000294',
                                       'OMX1000287',
                                       'OMX1000268',
                                       'OMX1000263',
                                       'OMX1000262',
                                       'OMX1000261',
                                       'OMX1000253',
                                       'OMX1000248',
                                       'OMX1000246',
                                       'OMX1000225',
                                       'OMX1000208',
                                       'OMX1000208',
                                       'OMX1000179',
                                       'OMX1000155',
                                       'OMX1000102',
                                       'OMX1000070',
                                       'OMX1000037',
                                       'OMX1000030',
                                       'OMX1000029',
                                       'OMX1000028',
                                       'OMX1000012'
									 );
									 
	ln_active_check_cnt    NUMBER;
	ln_active_eft_cnt      NUMBER;
	ln_inactive_check_cnt  NUMBER;
	  
BEGIN   
    ln_active_check_cnt   := 0; 
	ln_active_eft_cnt     := 0;
	ln_inactive_check_cnt := 0;
	
    dbms_output.put_line('Updating the IBY payment Methods for the respective Active Supplier Site having Payment Method as CHECK');
   
    FOR i IN active_check_cur
	LOOP 
	
	   IF i.payment_method_code = 'CHECK'
	   THEN
	       CONTINUE;
	   ELSE
           UPDATE iby_ext_party_pmt_mthds a
              SET a.primary_flag = 'Y',
                  a.payment_method_code = 'CHECK'
            WHERE a.ext_pmt_party_id = i.payment_party_id
		      AND a.ext_party_pmt_mthd_id  = i.party_pmt_mthd_id;
			  
			ln_active_check_cnt := SQL%ROWCOUNT;
		    
			COMMIT;
	   END IF;
	END LOOP;
	dbms_output.put_line('Number of Rows Updated:'||ln_active_check_cnt);
	COMMIT;
		
	dbms_output.put_line('Updating the IBY payment Methods for the respective Active Supplier Site having Payment Method as EFT');
	
	FOR i IN active_eft_cur
	LOOP 
	
	   IF i.payment_method_code = 'EFT'
	   THEN
	       CONTINUE;
	   ELSE
           UPDATE iby_ext_party_pmt_mthds a
              SET a.primary_flag = 'Y',
                  a.payment_method_code = 'EFT'
            WHERE a.ext_pmt_party_id = i.payment_party_id
		      AND a.ext_party_pmt_mthd_id  = i.party_pmt_mthd_id;
			  
			ln_active_eft_cnt := SQL%ROWCOUNT;
		    
			COMMIT;
	   END IF;
	END LOOP;
	dbms_output.put_line('Number of Rows Updated:'||ln_active_eft_cnt);
	COMMIT;
		
	dbms_output.put_line('Updating the IBY payment Methods for the respective Inactive Supplier Site having Payment Method as CHECK');
    FOR i IN inactive_check_cur
	LOOP 
	
	   IF i.payment_method_code = 'CHECK'
	   THEN
	       CONTINUE;
	   ELSE
           UPDATE iby_ext_party_pmt_mthds a
              SET a.primary_flag = 'Y',
                  a.payment_method_code = 'CHECK'
            WHERE a.ext_pmt_party_id = i.payment_party_id
		      AND a.ext_party_pmt_mthd_id  = i.party_pmt_mthd_id;
			  
			ln_inactive_check_cnt := SQL%ROWCOUNT;
		    
			COMMIT;
	   END IF;
	END LOOP;
	dbms_output.put_line('Number of Rows Updated:'||ln_inactive_check_cnt);
	COMMIT;
	
EXCEPTION
WHEN OTHERS 
THEN
    dbms_output.put_line('Unable to update the IBY Payment Methods Details :'||SQLERRM);
END;	    
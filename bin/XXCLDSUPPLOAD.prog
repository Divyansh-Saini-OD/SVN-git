# +===================================================================+
# |		     Office Depot - Project Beacon                    |
# |			Office Depot			              |
# +===================================================================+
# | Name  :	  XXCLDSUPPLOAD (Shell Script)	              |
# | Description : To Load the Supplier Data from the Cloud to On-Prem |
# |   EBS tables	                                              |
# |	    				                              |
# |								      |
# |Change Record:						      |
# |===============						      |
# |Version   Date	   Author	       Remarks		      |
# |=======   ===========  ================    ========================|
# |1.0	   26-JUN-2019    Arun DSouza	       Initial version        |
# |-------------------------------------------------------------------|
# |								      |                      |
# +===================================================================+
#
echo "Supplier Extract to Load : " [$5]
#echo "File Name : " [$6]
p_request_id=`echo $1|awk '{print(substr($2,11))}'`
FILE_DIR="$XXFIN_DATA/ftp/in/cloudsupplier"
FILE_ARCHIVE="$XXFIN_DATA/archive/inbound"
DATE_YYMMDD=`date +%Y%m%d`; 
echo " DATE_YYMMDD :" [$DATE_YYMMDD]
#
#if [ "${5}" = "SUPPLIER" ]
then
echo "----------------------------------------------------------------------------------------------"
echo "----------------------------------------------------------------------------------------------"
echo "                         SUPPLIER LOAD                                                        "
echo "----------------------------------------------------------------------------------------------"
echo "----------------------------------------------------------------------------------------------"
FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLOUD_SUPP_XTRCT_$DATE_YYMMDD.csv"
CONTROL_FILE="$XXFIN_TOP/bin/XX_AP_CLD_SUPPLIERS_STG.ctl"
BAD_FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLD_SUPPLIERS_STG.bad"
LOG_FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLD_SUPPLIERS_STG.log"
LDRCMD="sqlldr parfile=$HOME/parfile.apps data=$FILE control=$CONTROL_FILE log=$LOG_FILE bad=$BAD_FILE"
echo " Data File  :" [$FILE]
echo " Control File  :" [$CONTROL_FILE]
echo " SqlLoad Command  :" [$LDRCMD]
#
#
sqlldr parfile=$HOME/parfile.apps data=$FILE control=$CONTROL_FILE log=$LOG_FILE bad=$BAD_FILE
#
#if [ $? -ne 0 ]
#then
#echo "Error in running sqlloader. Please Check log for Error Details "
#else
#echo "Completed successfully "
#fi
#
echo "------------ Log File--------------"
cat $LOG_FILE
#
echo "-------------Bad Data file----------"
cat $BAD_FILE
#
#fi
#
#if [ "${5}" = "SITES" ]
then
echo "----------------------------------------------------------------------------------------------"
echo "----------------------------------------------------------------------------------------------"
echo "                         SITES    LOAD                                                        "
echo "----------------------------------------------------------------------------------------------"
echo "----------------------------------------------------------------------------------------------"
#
FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLOUD_SUPP_SITES_XTRCT_$DATE_YYMMDD.csv"
CONTROL_FILE="$XXFIN_TOP/bin/XX_AP_CLD_SUPP_SITES_STG.ctl"
BAD_FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLD_SUPP_SITES_STG.bad"
LOG_FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLD_SUPP_SITES_STG.log"
LDRCMD="sqlldr parfile=$HOME/parfile.apps data=$FILE control=$CONTROL_FILE log=$LOG_FILE bad=$BAD_FILE"
echo " Data File  :" [$FILE]
echo " Control File  :" [$CONTROL_FILE]
echo " SqlLoad Command  :" [$LDRCMD]
#
#
sqlldr parfile=$HOME/parfile.apps data=$FILE control=$CONTROL_FILE log=$LOG_FILE bad=$BAD_FILE
#
#if [ $? -ne 0 ]
#then
#echo "Error in running sqlloader. Please Check log for Error Details "
#else
#echo "Completed successfully "
#fi
#
echo "------------ Sites Log File--------------"
cat $LOG_FILE
#
echo "-------------Sites Bad Data file----------"
cat $BAD_FILE
#
#fi
#
#if [ "${5}" = "CONTACTS" ]
then
echo "----------------------------------------------------------------------------------------------"
echo "----------------------------------------------------------------------------------------------"
echo "                         CONTACTS LOAD                                                        "
echo "----------------------------------------------------------------------------------------------"
echo "----------------------------------------------------------------------------------------------"
#
FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLOUD_SUPP_CONTACTS_XTRCT_$DATE_YYMMDD.csv"
CONTROL_FILE="$XXFIN_TOP/bin/XX_AP_CLD_SUPP_CONTACT_STG.ctl"
BAD_FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLD_SUPP_CONTACT_STG.bad"
LOG_FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLD_SUPP_CONTACT_STG.log"
LDRCMD="sqlldr parfile=$HOME/parfile.apps data=$FILE control=$CONTROL_FILE log=$LOG_FILE bad=$BAD_FILE"
echo " Data File  :" [$FILE]
echo " Control File  :" [$CONTROL_FILE]
echo " SqlLoad Command  :" [$LDRCMD]
#
#
sqlldr parfile=$HOME/parfile.apps data=$FILE control=$CONTROL_FILE log=$LOG_FILE bad=$BAD_FILE
#
#if [ $? -ne 0 ]
#then
#echo "Error in running sqlloader. Please Check log for Error Details "
#else
#echo "Completed successfully "
#fi
#
echo "------------ Contacts Log File--------------"
cat $LOG_FILE
#
echo "-------------Contacts Bad Data file----------"
cat $BAD_FILE
#
#fi
#
#if [ "${5}" = "CLASSIFICATION" ]
then
echo "----------------------------------------------------------------------------------------------"
echo "----------------------------------------------------------------------------------------------"
echo "                         BUSINESS CLASSIFICATION LOAD                                         "
echo "----------------------------------------------------------------------------------------------"
echo "----------------------------------------------------------------------------------------------"
#
FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLOUD_SUPP_BUS_CLASS_XTRCT_$DATE_YYMMDD.csv"
CONTROL_FILE="$XXFIN_TOP/bin/XX_AP_CLD_SUPP_BCLS_STG.ctl"
BAD_FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLD_SUPP_BCLS_STG.bad"
LOG_FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLD_SUPP_BCLS_STG.log"
LDRCMD="sqlldr parfile=$HOME/parfile.apps data=$FILE control=$CONTROL_FILE log=$LOG_FILE bad=$BAD_FILE"
echo " Data File  :" [$FILE]
echo " Control File  :" [$CONTROL_FILE]
echo " SqlLoad Command  :" [$LDRCMD]
#
#
sqlldr parfile=$HOME/parfile.apps data=$FILE control=$CONTROL_FILE log=$LOG_FILE bad=$BAD_FILE
#
#if [ $? -ne 0 ]
#then
#echo "Error in running sqlloader. Please Check log for Error Details "
#else
#echo "Completed successfully "
#fi
#
echo "------------Classification Log File--------------"
cat $LOG_FILE
#
echo "-------------Classification Bad Data file----------"
cat $BAD_FILE
#
#fi
#
#if [ "${5}" = "BANKS" ]
then
echo "----------------------------------------------------------------------------------------------"
echo "----------------------------------------------------------------------------------------------"
echo "                         BANKING DETAILS LOAD                                                 "
echo "----------------------------------------------------------------------------------------------"
echo "----------------------------------------------------------------------------------------------"
#
FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLOUD_SUPP_BANK_ACCTS_XTRCT_$DATE_YYMMDD.csv"
CONTROL_FILE="$XXFIN_TOP/bin/XX_AP_CLD_SUPP_BNKACT_STG.ctl"
BAD_FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLD_SUPP_BNKACT_STG.bad"
LOG_FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLD_SUPP_BNKACT_STG.log"
LDRCMD="sqlldr parfile=$HOME/parfile.apps data=$FILE control=$CONTROL_FILE log=$LOG_FILE bad=$BAD_FILE"
echo " Data File  :" [$FILE]
echo " Control File  :" [$CONTROL_FILE]
echo " SqlLoad Command  :" [$LDRCMD]
#
#
sqlldr parfile=$HOME/parfile.apps data=$FILE control=$CONTROL_FILE log=$LOG_FILE bad=$BAD_FILE
#
#if [ $? -ne 0 ]
#then
#echo "Error in running sqlloader. Please Check log for Error Details "
#else
#echo "Completed successfully "
#fi
#
echo "------------Banking Log File--------------"
cat $LOG_FILE
#
echo "-------------Banking Bad Data file----------"
cat $BAD_FILE
#
#fi
#
#if [ "${5}" = "DFF" ]
then
echo "----------------------------------------------------------------------------------------------"
echo "----------------------------------------------------------------------------------------------"
echo "                         DFF LOAD                                                             "
echo "----------------------------------------------------------------------------------------------"
echo "----------------------------------------------------------------------------------------------"
#
FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLOUD_SUPP_CUSTOM_DFF_XTRCT_$DATE_YYMMDD.csv"
CONTROL_FILE="$XXFIN_TOP/bin/XX_AP_CLD_SITE_DFF_STG.ctl"
BAD_FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLD_SITE_DFF.bad"
LOG_FILE="$XXFIN_DATA/ftp/in/cloudsupplier/XX_AP_CLD_SITE_DFF.log"
LDRCMD="sqlldr parfile=$HOME/parfile.apps data=$FILE control=$CONTROL_FILE log=$LOG_FILE bad=$BAD_FILE"
echo " Data File  :" [$FILE]
echo " Control File  :" [$CONTROL_FILE]
echo " SqlLoad Command  :" [$LDRCMD]
#
#
sqlldr parfile=$HOME/parfile.apps data=$FILE control=$CONTROL_FILE log=$LOG_FILE bad=$BAD_FILE
#
#if [ $? -ne 0 ]
#then
#echo "Error in running sqlloader. Please Check log for Error Details "
#else
#echo "Completed successfully "
#fi
#
echo "------------DFF Log File--------------"
cat $LOG_FILE
#
echo "-------------DFF Bad Data file----------"
cat $BAD_FILE
#
#fi
# Exiting from the shell program.
exit 0;

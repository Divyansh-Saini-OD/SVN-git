<?xml version = "1.0" encoding = "UTF-8" ?>
<!--
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  Oracle JDeveloper BPEL Designer 
  
  Created: Mon Aug 06 11:38:08 IST 2012
  Author:  VELAMBIL
  Type: BPEL 2.0 Process
  Purpose: Asynchronous BPEL Process
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
-->
<process name="SynchSupplierPSFTProvABCS"
         targetNamespace="http://xmlns.officedepot.com/VendorSynch/SynchSupplierPSFTProvABCS/SynchSupplierPSFTProvABCS"
         xmlns="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
         xmlns:client="http://xmlns.officedepot.com/VendorSynch/SynchSupplierPSFTProvABCS/SynchSupplierPSFTProvABCS"
         xmlns:ora="http://schemas.oracle.com/xpath/extension"
         xmlns:bpelx="http://schemas.oracle.com/bpel/extension"
         xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
         xmlns:ns1="http://xmlns.officedepot.org/EnterpriseObjects/Core/EBO/Supplier/V1"
         xmlns:ns2="http://xmlns.oracle.com/pcbpel/adapter/file/VendorSynch/SynchSupplierPSFTProvABCS/SynchSupplierPSFTFileAdaptorV1"
         xmlns:ns3="http://xmlns.oracle.com/Enterprise/HCM/services"
         xmlns:xsd="http://www.w3.org/2001/XMLSchema"
         xmlns:ns4="http://xmlns.officedepot.com/EnterpriseObjects/Core/Common/V3"
         xmlns:ns5="http://xmlns.oracle.com/pcbpel/adapter/jms/VendorSynch/SynchSupplierPSFTProvABCS/CommonErrorLoggingService"
         xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
         xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/"
         xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
         xmlns:ns6="http://xmlns.officedepot.com/VendorSynch/SynchSupplierPSFTFileAdaptorV1"
         xmlns:dvm="http://www.oracle.com/XSL/Transform/java/oracle.tip.dvm.LookupValue"
         xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath"
         xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath"
         xmlns:bpm="http://xmlns.oracle.com/bpmn20/extensions"
         xmlns:xdk="http://schemas.oracle.com/bpel/extension/xpath/function/xdk"
         xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions"
         xmlns:ns7="http://xmlns.oracle.com/Enterprise/Tools/schemas/VENDOR_SYNC.VERSION_1"
         xmlns:ldap="http://schemas.oracle.com/xpath/extension/ldap"
         xmlns:ns8="http://www.officedepot.com/officedepot/ODComnErrorStructure/1.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns:ns9="http://xmlns.oracle.com/pcbpel/adapter/db/VendorSynch/SynchSupplierPSFTProvABCS/UpdateSupplierCPEbizDBAdaptorV1"
         xmlns:ns10="http://xmlns.oracle.com/pcbpel/adapter/db/top/UpdateSupplierCPEbizDBAdaptorV1"
         xmlns:ns11="http://xmlns.oracle.com/pcbpel/adapter/jms/VendorSynchSIT/SynchSupplierPSFTProvABCS/InsertErrorLogger"
         xmlns:ns12="ODError"
         xmlns:ns13="http://xmlns.oracle.com/pcbpel/adapter/jms/VendorSynchSIT/SynchSupplierPSFTProvABCS/InsertTransactionLogger"
         xmlns:ns16="http://xmlns.oracle.com/TransactionData">
    <import namespace="http://xmlns.officedepot.com/VendorSynch/SynchSupplierPSFTProvABCS/SynchSupplierPSFTProvABCS"
            location="SynchSupplierPSFTProvABCS.wsdl"
            importType="http://schemas.xmlsoap.org/wsdl/"/>
    <partnerLinks>
        <partnerLink name="SynchSupplierPSFTService"
                     partnerLinkType="ns1:SynchSupplierPSFTService"
                     myRole="SynchSupplierEBS"/>
        <partnerLink name="SynchSupplierPSFTFileAdaptorV1"
                     partnerLinkType="ns2:SynchRead_plt"
                     partnerRole="SynchRead_role"/>
        <partnerLink name="UpdateSupplierPSFTService"
                     partnerLinkType="ns3:VENDOR_SYNC_PartnerLinkType"
                     partnerRole="VENDOR_SYNC_Provider"/>
        <partnerLink name="SelectUpdateSupplierCPEbizDBAdaptorV1"
                     partnerLinkType="ns9:UpdateSupplierCPEbizDBAdaptorV1_plt"
                     partnerRole="UpdateSupplierCPEbizDBAdaptorV1_role"/>
        <partnerLink name="InsertErrorLogger"
                     partnerLinkType="ns11:Produce_Message_plt"
                     partnerRole="Produce_Message_role"/>
        <partnerLink name="InsertTransactionLogger"
                     partnerLinkType="ns13:Produce_Message_plt"
                     partnerRole="Produce_Message_role"/>
    </partnerLinks>
    <!-- 
      ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        PARTNERLINKS                                                      
        List of services participating in this BPEL process               
      ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    -->
    <!-- 
      ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        VARIABLES                                                        
        List of messages and XML documents used within this BPEL process 
      ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    -->
    <variables>
        <!-- Reference to the message passed as input during initiation -->
        <!-- Reference to the message that will be sent back to the requester during callback -->
        <variable name="receiveInput_synchronizeSupplier_InputVariable"
                  messageType="ns1:SynchSupplierFileReqMsg"/>
        <variable name="SyncFileName" type="xsd:string"/>
        <variable name="SyncDirName" type="xsd:string"/>
        <variable name="Read_File_Data_SynchRead_InputVariable"
                  messageType="ns2:Empty_msg"/>
        <variable name="Read_File_Data_SynchRead_OutputVariable"
                  messageType="ns2:SynchRead_msg"/>
        <variable name="Acknowledge_synchronizeSupplier_OutputVariable"
                  messageType="ns1:SynchSupplierFileRespMsg"/>
        <variable name="ErrorLoggerData"
                  messageType="ns11:Produce_Message_msg"/>
        <variable name="fileName" type="xsd:string"/>
        <variable name="fileSize" type="xsd:integer"/>
        <variable name="GlobalParameterFileName" type="xsd:string"/>
        <variable name="xmlFragment" type="xsd:string"/>
        <variable name="logTransactionInput"
                  messageType="ns13:Produce_Message_msg"/>
        <variable name="NumberOfRecords" type="xsd:string"/>    
    </variables>
    <faultHandlers>
        <catchAll>
            <sequence name="Sequence3">
                <scope name="Scope3">
                    <variables>
                        <variable name="messagePayload" type="xsd:string"/>
                        <variable name="emailSubject" type="xsd:string"/>
                        <variable name="errorText" type="xsd:string"/>
                        <variable name="systemName" type="xsd:string"/>
                        <variable name="messageOperation" type="xsd:string"/>
                        <variable name="applicationTeamErrorText"
                                  type="xsd:string"/>
                    </variables>
                    <sequence name="Sequence4">
                        <assign name="AssignRunTimeErrorRelatedData">
                            <copy>
                                <from>concat(ora:getPreference("SOA_ADMIN_ERROR_MESSAGE"),$fileName)</from>
                                <to>$emailSubject</to>
                            </copy>
                            <copy>
                                <from>substring(ora:getFaultAsString(),1,4000)</from>
                                <to>$errorText</to>
                            </copy>
                            <copy>
                                <from>string(' ')</from>
                                <to>$messagePayload</to>
                            </copy>
                            <copy>
                                <from>ora:getPreference('SOA_ADMIN_APP_NAME')</from>
                                <to>$systemName</to>
                            </copy>
                            <copy>
                                <from>concat(ora:getPreference('APPLICATION_EMAIL_SUBJECT'),$fileName)</from>
                                <to>$applicationTeamErrorText</to>
                            </copy>
                        </assign>
                        <assign name="AssignPopulateCommonErrorLoggingData">
                            <copy>
                                <from>ora:doc(concat('oramds:/apps/ODCommon/xmllib/finance/xml/', $GlobalParameterFileName),'/GlobalParameters/Finance_Domain/PROCESS_DOMAIN')</from>
                                <to>$ErrorLoggerData.body/ns12:ProcessInfo/ns12:BusinessProcessDomain</to>
                            </copy>
                            <copy>
                                <from>ora:getProcessId()</from>
                                <to>$ErrorLoggerData.body/ns12:ProcessInfo/ns12:BusinessProcessName</to>
                            </copy>
                            <copy>
                                <from>ora:getCompositeInstanceId()</from>
                                <to>$ErrorLoggerData.body/ns12:ProcessInfo/ns12:BusinessProcessId</to>
                            </copy>
                            <copy>
                                <from>'I0380 Supplier Interface'</from>
                                <to>$ErrorLoggerData.body/ns12:ProcessInfo/ns12:SystemName</to>
                            </copy>
                            <copy>
                                <from>ora:getCurrentDateTime()</from>
                                <to>$ErrorLoggerData.body/ns12:ErrorDetails/ns12:ErrorDateTime</to>
                            </copy>
                            <copy>
                                <from>ora:getPreference('CATCH_ALL_PROCESS_STEP')</from>
                                <to>$ErrorLoggerData.body/ns12:ProcessInfo/ns12:BusinessProcessStep</to>
                            </copy>
                            <copy>
                                <from>ora:getFaultName()</from>
                                <to>$ErrorLoggerData.body/ns12:ErrorDetails/ns12:ErrorCode</to>
                            </copy>
                            <copy>
                                <from>$emailSubject</from>
                                <to>$ErrorLoggerData.body/ns12:ErrorDetails/ns12:ErrorDescription</to>
                            </copy>
                            <copy>
                                <from>$errorText</from>
                                <to>$ErrorLoggerData.body/ns12:ErrorDetails/ns12:ErrorText</to>
                            </copy>
                            <copy>
                                <from>ora:getPreference('ERROR_TYPE')</from>
                                <to>$ErrorLoggerData.body/ns12:ErrorDetails/ns12:ErrorType</to>
                            </copy>
                            <copy>
                                <from>ora:getPreference('ERROR_SEVERITY')</from>
                                <to>$ErrorLoggerData.body/ns12:ErrorDetails/ns12:ErrorSeverity</to>
                            </copy>
                            <copy>
                                <from>ora:getCompositeInstanceId()</from>
                                <to>$ErrorLoggerData.body/ns12:MessageDetails/ns12:MessageId</to>
                            </copy>
                            <copy>
                                <from>ora:getCurrentDateTime()</from>
                                <to>$ErrorLoggerData.body/ns12:MessageDetails/ns12:MessageDateTime</to>
                            </copy>
                            <copy>
                                <from>ora:getPreference('MESSAGE_TYPE')</from>
                                <to>$ErrorLoggerData.body/ns12:MessageDetails/ns12:MessageType</to>
                            </copy>
                            <copy>
                                <from>ora:getPreference('MESSAGE_VERSION')</from>
                                <to>$ErrorLoggerData.body/ns12:MessageDetails/ns12:MessageVersion</to>
                            </copy>
                            <copy>
                                <from>$messageOperation</from>
                                <to>$ErrorLoggerData.body/ns12:MessageDetails/ns12:MessageOperation</to>
                            </copy>
                            <copy>
                                <from>ora:getPreference('SOURCE_SYSTEM_NAME')</from>
                                <to>$ErrorLoggerData.body/ns12:MessageDetails/ns12:MessageSourceSystem</to>
                            </copy>
                            <copy>
                                <from>$messagePayload</from>
                                <to>$ErrorLoggerData.body/ns12:MessageDetails/ns12:MessageData</to>
                            </copy>
                            <copy>
                                <from>ora:getPreference('SEND_NOTIFICATION')</from>
                                <to>$ErrorLoggerData.body/ns12:Notification/ns12:sendNotification</to>
                            </copy>
                        </assign>
                        <invoke name="InvokeErrorLoggerToSendErrorData"
                                partnerLink="InsertErrorLogger"
                                portType="ns11:Produce_Message_ptt"
                                operation="Produce_Message"
                                inputVariable="ErrorLoggerData"
                                bpelx:invokeAsDetail="no"/>
                    </sequence>
                </scope>
                
                                        <scope name="LogTransactionErrorScope" exitOnStandardFault="no">
                    <sequence name="LogTransactionErrorSequence">
                        <assign name="copyTransactionData">
                            <copy>
                                <from>count($Read_File_Data_SynchRead_OutputVariable.body/ns6:Supplier)</from>
                                <to>$NumberOfRecords</to>
                            </copy>
                            <copy>
                                <from>'Error'</from>
                                <to>$logTransactionInput.body/ns16:ProcessInfo/ns16:ProcessStatus</to>
                            </copy>
                            <copy>
                                <from><literal><EntiltyList xmlns="http://xmlns.oracle.com/TransactionData">
                      <EntityID EntityType="SourceFileName"/>
                      <EntityID EntityType="FileSize"/>
                      <EntityID EntityType="NumberOfRecordsInserted"/>
                      <EntityID EntityType="RMS_ret_code"/>
                      <EntityID EntityType="RMS_ret_message"/>
                      <EntityID EntityType="TargetSystemName"/>
                      <EntityID EntityType="TableName"/>
                      <EntityID EntityType="ReleaseESPJob"/>
      </EntiltyList></literal></from>
                                <to>$logTransactionInput.body/ns16:EntiltyList</to>
                            </copy>
                            <copy>
                                <from>concat('&amp;lt;EntityID EntityType=&amp;quot;SourceFileName&amp;quot;&gt;',$fileName, '&amp;lt;/EntityID&gt;')</from>
                                <to>$xmlFragment</to>
                            </copy>
                            <copy>
                                <from>ora:parseEscapedXML($xmlFragment)</from>
                                <to>$logTransactionInput.body/ns16:EntiltyList/ns16:EntityID[1]</to>
                            </copy>
                            <copy>
                                <from>concat('&amp;lt;EntityID EntityType=&amp;quot;FileSize&amp;quot;&gt;', $fileSize, ' bytes', '&amp;lt;/EntityID&gt;')</from>
                                <to>$xmlFragment</to>
                            </copy>
                            <copy>
                                <from>ora:parseEscapedXML($xmlFragment)</from>
                                <to>$logTransactionInput.body/ns16:EntiltyList/ns16:EntityID[2]</to>
                            </copy>
                            <copy>
                                <from>concat('&amp;lt;EntityID EntityType=&amp;quot;RMS_ret_code&amp;quot;&gt;',ora:getFaultName(), '&amp;lt;/EntityID&gt;')</from>
                                <to>$xmlFragment</to>
                            </copy>
                            <copy>
                                <from>ora:parseEscapedXML($xmlFragment)</from>
                                <to>$logTransactionInput.body/ns16:EntiltyList/ns16:EntityID[4]</to>
                            </copy>
                            <copy>
                                <from>concat('&amp;lt;EntityID EntityType=&amp;quot;RMS_ret_message&amp;quot;&gt;',ora:getFaultName(), '&amp;lt;/EntityID&gt;')</from>
                                <to>$xmlFragment</to>
                            </copy>
                            <copy>
                                <from>ora:parseEscapedXML($xmlFragment)</from>
                                <to>$logTransactionInput.body/ns16:EntiltyList/ns16:EntityID[5]</to>
                            </copy>
                            <copy>
                              <from>concat('&amp;lt;EntityID EntityType=&amp;quot;TargetSystemName&amp;quot;&gt;', 'PSFT', '&amp;lt;/EntityID&gt;')</from>
                              <to>$xmlFragment</to>
                            </copy>
                            <copy>
                              <from>ora:parseEscapedXML($xmlFragment)</from>
                              <to>$logTransactionInput.body/ns16:EntiltyList/ns16:EntityID[6]</to>
                            </copy>
                            <copy>
                              <from>concat('&amp;lt;EntityID EntityType=&amp;quot;TableName&amp;quot;&gt;', 'XxApPsVendor , xxApPsVendorAddr, xxApPsVendorLoc, xxApPsVndrAddrScrol, xxApPsVndrLocScrol', '&amp;lt;/EntityID&gt;')</from>
                              <to>$xmlFragment</to>
                            </copy>
                            <copy>
                              <from>ora:parseEscapedXML($xmlFragment)</from>
                              <to>$logTransactionInput.body/ns16:EntiltyList/ns16:EntityID[7]</to>
                            </copy>
                            <copy>
                              <from>concat('&amp;lt;EntityID EntityType=&amp;quot;ReleaseESPJob&amp;quot;&gt;', 'No', '&amp;lt;/EntityID&gt;')</from>
                              <to>$xmlFragment</to>
                            </copy>
                            <copy>
                              <from>ora:parseEscapedXML($xmlFragment)</from>
                              <to>$logTransactionInput.body/ns16:EntiltyList/ns16:EntityID[8]</to>
                            </copy>
                        </assign>
                        <invoke name="logTransaction"
                                partnerLink="InsertTransactionLogger"
                                portType="ns13:Produce_Message_ptt"
                                operation="Produce_Message"
                                inputVariable="logTransactionInput"
                                bpelx:invokeAsDetail="no"/>
                    </sequence>
                </scope>

                <scope name="Scope5">
                    <variables>
                        <variable name="Update_Ebiz_Supplier_Extract_CP_Error_Details_InputVariable"
                                  messageType="ns9:XxApSuppExtractCollection_msg"/>
                    </variables>
                    <sequence name="Sequence6">
                        <assign name="Prepare_Error_Details">
                            <copy>
                                <from>$receiveInput_synchronizeSupplier_InputVariable.body/ns1:TargetSystem</from>
                                <to>$Update_Ebiz_Supplier_Extract_CP_Error_Details_InputVariable.XxApSuppExtractCollection/ns10:XxApSuppExtract/ns10:extSystem</to>
                            </copy>
                            <copy>
                                <from><literal>E</literal></from>
                                <to>$Update_Ebiz_Supplier_Extract_CP_Error_Details_InputVariable.XxApSuppExtractCollection/ns10:XxApSuppExtract/ns10:bpelRunningFlag</to>
                            </copy>
                        </assign>
                        <invoke name="Update_Ebiz_Supplier_Extract_CP_Error_Details"
                                bpelx:invokeAsDetail="no"
                                partnerLink="SelectUpdateSupplierCPEbizDBAdaptorV1"
                                portType="ns9:UpdateSupplierCPEbizDBAdaptorV1_ptt"
                                operation="merge"
                                inputVariable="Update_Ebiz_Supplier_Extract_CP_Error_Details_InputVariable"/>
                    </sequence>
                </scope>
            </sequence>
        </catchAll>
    </faultHandlers>
    <!-- 
      ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
       ORCHESTRATION LOGIC                                               
       Set of activities coordinating the flow of messages across the    
       services integrated within this business process                  
      ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    -->
    <sequence name="main">
        <!-- Receive input from requestor. (Note: This maps to operation defined in SynchSupplierPSFTProvABCS.wsdl) -->
        <receive name="receiveInput" partnerLink="SynchSupplierPSFTService"
                 portType="ns1:SynchSupplierEBS" operation="synchronizeSupplier"
                 variable="receiveInput_synchronizeSupplier_InputVariable"
                 createInstance="yes"/>
        <!-- 
          Asynchronous callback to the requester. (Note: the callback location and correlation id is transparently handled using WS-addressing.)
        -->
        
        <scope name="logTransactionStartScope" exitOnStandardFault="no">
            <bpelx:annotation>
                <bpelx:general>
                    <bpelx:property name="userLabel">logTransactionScope</bpelx:property>
                </bpelx:general>
            </bpelx:annotation>
            <sequence name="logTransactionSequence">
                <assign name="copyTransactionData">
          <copy>
            <from>ora:getPreference('GlobalParameters_FNAME')</from>
            <to>$GlobalParameterFileName</to>
          </copy>
          <copy>
            <from>$receiveInput_synchronizeSupplier_InputVariable.body/ns4:FileMetaData/ns4:FileName</from>
            <to>$fileName</to>
          </copy>
          <copy>
            <from>$receiveInput_synchronizeSupplier_InputVariable.body/ns4:FileMetaData/ns4:FileSize</from>
            <to>$fileSize</to>
          </copy>
          <copy>
            <from>ora:doc(concat('oramds:/apps/ODCommon/xmllib/finance/xml/', $GlobalParameterFileName),'/GlobalParameters/Finance_Domain/PROCESS_DOMAIN')</from>
            <to>$logTransactionInput.body/ns16:ProcessInfo/ns16:Domain</to>
          </copy>
          <copy>
            <from>ora:getProcessId()</from>
            <to>$logTransactionInput.body/ns16:ProcessInfo/ns16:ProcessName</to>
          </copy>
          <copy>
            <from>ora:getCompositeInstanceId()</from>
            <to>$logTransactionInput.body/ns16:ProcessInfo/ns16:InstanceId</to>
          </copy>
          <copy>
            <from>'Start'</from>
            <to>$logTransactionInput.body/ns16:ProcessInfo/ns16:ProcessStatus</to>
          </copy>
          <copy>
            <from>'SyncSupplier File Read'</from>
            <to>$logTransactionInput.body/ns16:MessageDetails/ns16:MessageOperation</to>
          </copy>
          <copy>
            <from>'OD: AP GSS/PSFT/RMS Supplier Outbound'</from>
            <to>$logTransactionInput.body/ns16:MessageDetails/ns16:MessageSourceSystem</to>
          </copy>
          <copy>
            <from>'Payload'</from>
            <to>$logTransactionInput.body/ns16:MessageDetails/ns16:MessageType</to>
          </copy>
          <copy>
            <from>ora:getCurrentDateTime()</from>
            <to>$logTransactionInput.body/ns16:MessageDetails/ns16:MessageDateTime</to>
          </copy>
          <copy>
            <from>$fileName</from>
            <to>$logTransactionInput.body/ns16:EntiltyList/ns16:EntityID</to>
          </copy>
          <copy>
            <from><literal><EntiltyList xmlns="http://xmlns.oracle.com/TransactionData">
<EntityID EntityType="SourceFileName"/>
</EntiltyList></literal></from>
            <to>$logTransactionInput.body/ns16:EntiltyList</to>
          </copy>
          <copy>
            <from>concat('&amp;lt;EntityID EntityType=&amp;quot;SourceFileName&amp;quot;&gt;',$fileName , '&amp;lt;/EntityID&gt;')</from>
            <to>$xmlFragment</to>
          </copy>
          <copy>
            <from>ora:parseEscapedXML($xmlFragment)</from>
            <to>$logTransactionInput.body/ns16:EntiltyList</to>
          </copy>
          <copy>
            <from>'EBS'</from>
            <to>$logTransactionInput.body/ns16:ProcessInfo/ns16:TradingPartnerDetails/ns16:TPFrom</to>
          </copy>
          <copy>
            <from>'PSFT'</from>
            <to>$logTransactionInput.body/ns16:ProcessInfo/ns16:TradingPartnerDetails/ns16:TPTo</to>
          </copy>
          <copy>
            <from>'I0380 Supplier Interface'</from>
            <to>$logTransactionInput.body/ns16:ProcessInfo/ns16:SystemName</to>
          </copy>
        </assign>
                <invoke name="logTransaction"
                        partnerLink="InsertTransactionLogger"
                        portType="ns13:Produce_Message_ptt"
                        operation="Produce_Message"
                        inputVariable="logTransactionInput"
                        bpelx:invokeAsDetail="no"/>
            </sequence>
        </scope>

        <assign name="AssignAcknowledgement">
            <copy>
                <from><literal>0</literal></from>
                <to>$Acknowledge_synchronizeSupplier_OutputVariable.body/ns1:ReturnCode</to>
            </copy>
            <copy>
                <from><literal>Sucess</literal></from>
                <to>$Acknowledge_synchronizeSupplier_OutputVariable.body/ns1:ReturnMessage</to>
            </copy>
        </assign>
        <reply name="Acknowledge"
               variable="Acknowledge_synchronizeSupplier_OutputVariable"
               partnerLink="SynchSupplierPSFTService"
               portType="ns1:SynchSupplierEBS" operation="synchronizeSupplier"/>
        <assign name="Prepare_Sync_Details">
            <copy>
                <from>$receiveInput_synchronizeSupplier_InputVariable.body/ns4:FileMetaData/ns4:FileName</from>
                <to>$SyncFileName</to>
            </copy>
            <copy>
                <from>$receiveInput_synchronizeSupplier_InputVariable.body/ns4:FileMetaData/ns4:DirectoryName</from>
                <to>$SyncDirName</to>
            </copy>
        </assign>
        <scope name="Scope1">
            <sequence name="Sequence1">
                <invoke name="Read_File_Data"
                        partnerLink="SynchSupplierPSFTFileAdaptorV1"
                        portType="ns2:SynchRead_ptt" operation="SynchRead"
                        inputVariable="Read_File_Data_SynchRead_InputVariable"
                        outputVariable="Read_File_Data_SynchRead_OutputVariable"
                        bpelx:invokeAsDetail="no">
                    <bpelx:toProperties>
                        <bpelx:toProperty name="jca.file.FileName"
                                          variable="SyncFileName"/>
                        <bpelx:toProperty name="jca.file.Directory"
                                          variable="SyncDirName"/>
                    </bpelx:toProperties>
                </invoke>
            </sequence>
        </scope>
        <extensionActivity>
            <bpelx:exec name="Initialize" language="java">
                <![CDATA[/*Write your java code below e.g.  
	System.out.println("Hello, World"); 
*/ 
checkpoint();]]>
            </bpelx:exec>
        </extensionActivity>
        <scope name="Scope2">
            <variables>
                <variable name="Update_PSFT_Supplier_Data_VENDOR_SYNC_InputVariable"
                          messageType="ns3:VENDOR_SYNC.VERSION_1"/>
            </variables>
            <faultHandlers>
                <catchAll>
                    <rethrow name="Rethrow"/>
                </catchAll>
            </faultHandlers>
            <sequence name="Sequence2">
                <assign name="Transform_to_PSFT_Supplier_Format">
                    <bpelx:annotation>
                        <bpelx:pattern patternName="bpelx:transformation"/>
                    </bpelx:annotation>
                    <copy>
                        <from>ora:doXSLTransformForDoc("xsl/EBiz_to_PSFT_Supplier_Map.xsl", $Read_File_Data_SynchRead_OutputVariable.body)</from>
                        <to variable="Update_PSFT_Supplier_Data_VENDOR_SYNC_InputVariable"
                            part="parameter"/>
                    </copy>
                </assign>
                <invoke name="Update_PSFT_Supplier_Data"
                        partnerLink="UpdateSupplierPSFTService"
                        portType="ns3:VENDOR_SYNC_PortType"
                        operation="VENDOR_SYNC"
                        inputVariable="Update_PSFT_Supplier_Data_VENDOR_SYNC_InputVariable"
                        bpelx:invokeAsDetail="no"/>
            </sequence>
        </scope>
        <scope name="Scope4">
            <variables>
                <variable name="Update_Ebiz_Supplier_CP_Select_InputVariable"
                          messageType="ns9:UpdateSupplierCPEbizDBAdaptorV1Select_inputParameters"/>
                <variable name="Update_Ebiz_Supplier_CP_Select_OutputVariable"
                          messageType="ns9:XxApSuppExtractCollection_msg"/>
                <variable name="Update_Ebiz_Supplier_Extract_CP_Details_merge_InputVariable"
                          messageType="ns9:XxApSuppExtractCollection_msg"/>
            </variables>
            <sequence name="Sequence5">
                <assign name="Prepare_CP_Query">
                    <copy>
                        <from>$receiveInput_synchronizeSupplier_InputVariable.body/ns1:TargetSystem</from>
                        <to>$Update_Ebiz_Supplier_CP_Select_InputVariable.UpdateSupplierCPEbizDBAdaptorV1Select_inputParameters/ns10:Ext_System</to>
                    </copy>
                </assign>
                <invoke name="Query_Ebiz_Supplier_Extract_CP_Details"
                        partnerLink="SelectUpdateSupplierCPEbizDBAdaptorV1"
                        portType="ns9:UpdateSupplierCPEbizDBAdaptorV1_ptt"
                        operation="UpdateSupplierCPEbizDBAdaptorV1Select"
                        inputVariable="Update_Ebiz_Supplier_CP_Select_InputVariable"
                        outputVariable="Update_Ebiz_Supplier_CP_Select_OutputVariable"
                        bpelx:invokeAsDetail="no"/>
                <assign name="Prepare_Update_Ebiz_Supplier_Extract_CP_Message">
                    <copy>
                        <from>$Update_Ebiz_Supplier_CP_Select_OutputVariable.XxApSuppExtractCollection/ns10:XxApSuppExtract/ns10:extSystem</from>
                        <to>$Update_Ebiz_Supplier_Extract_CP_Details_merge_InputVariable.XxApSuppExtractCollection/ns10:XxApSuppExtract/ns10:extSystem</to>
                    </copy>
                    <copy>
                        <from>$Update_Ebiz_Supplier_CP_Select_OutputVariable.XxApSuppExtractCollection/ns10:XxApSuppExtract/ns10:extractTime</from>
                        <to>$Update_Ebiz_Supplier_Extract_CP_Details_merge_InputVariable.XxApSuppExtractCollection/ns10:XxApSuppExtract/ns10:lastUpdateDate</to>
                    </copy>
                    <copy>
                        <from><literal>N</literal></from>
                        <to>$Update_Ebiz_Supplier_Extract_CP_Details_merge_InputVariable.XxApSuppExtractCollection/ns10:XxApSuppExtract/ns10:bpelRunningFlag</to>
                    </copy>
                </assign>
                <invoke name="Update_Ebiz_Supplier_Extract_CP_Details"
                        bpelx:invokeAsDetail="no"
                        partnerLink="SelectUpdateSupplierCPEbizDBAdaptorV1"
                        portType="ns9:UpdateSupplierCPEbizDBAdaptorV1_ptt"
                        operation="merge"
                        inputVariable="Update_Ebiz_Supplier_Extract_CP_Details_merge_InputVariable"/>
            </sequence>
        </scope>
                    <scope name="logTranscationEndScope" exitOnStandardFault="no">
            <sequence name="logTransactionEndSequence">
                <assign name="copyTransactionData">
                    <copy>
                        <from>count($Read_File_Data_SynchRead_OutputVariable.body/ns6:Supplier)</from>
                        <to>$NumberOfRecords</to>
                    </copy>
                    <copy>
                        <from>'Success'</from>
                        <to>$logTransactionInput.body/ns16:ProcessInfo/ns16:ProcessStatus</to>
                    </copy>
                    <copy>
                        <from><literal><EntiltyList xmlns="http://xmlns.oracle.com/TransactionData">
                <EntityID EntityType="SourceFileName"/>
                <EntityID EntityType="FileSize"/>
                <EntityID EntityType="NumberOfRecordsInserted"/>
                <EntityID EntityType="RMS_ret_code"/>
                <EntityID EntityType="RMS_ret_message"/>
                <EntityID EntityType="TargetSystemName"/>
                <EntityID EntityType="TableName"/>
                <EntityID EntityType="ReleaseESPJob"/>
</EntiltyList></literal></from>
                        <to>$logTransactionInput.body/ns16:EntiltyList</to>
                    </copy>
                    <copy>
                        <from>concat('&amp;lt;EntityID EntityType=&amp;quot;SourceFileName&amp;quot;&gt;',$fileName, '&amp;lt;/EntityID&gt;')</from>
                        <to>$xmlFragment</to>
                    </copy>
                    <copy>
                        <from>ora:parseEscapedXML($xmlFragment)</from>
                        <to>$logTransactionInput.body/ns16:EntiltyList/ns16:EntityID[1]</to>
                    </copy>
                    <copy>
                        <from>concat('&amp;lt;EntityID EntityType=&amp;quot;FileSize&amp;quot;&gt;', $fileSize, ' bytes', '&amp;lt;/EntityID&gt;')</from>
                        <to>$xmlFragment</to>
                    </copy>
                    <copy>
                        <from>ora:parseEscapedXML($xmlFragment)</from>
                        <to>$logTransactionInput.body/ns16:EntiltyList/ns16:EntityID[2]</to>
                    </copy>
                    <copy>
                        <from>concat('&amp;lt;EntityID EntityType=&amp;quot;NumberOfRecordsInserted&amp;quot;&gt;', $NumberOfRecords, '&amp;lt;/EntityID&gt;')</from>
                        <to>$xmlFragment</to>
                    </copy>
                    <copy>
                        <from>ora:parseEscapedXML($xmlFragment)</from>
                        <to>$logTransactionInput.body/ns16:EntiltyList/ns16:EntityID[3]</to>
                    </copy>
                    <copy>
                        <from>concat('&amp;lt;EntityID EntityType=&amp;quot;TargetSystemName&amp;quot;&gt;', 'PSFT', '&amp;lt;/EntityID&gt;')</from>
                        <to>$xmlFragment</to>
                    </copy>
                    <copy>
                        <from>ora:parseEscapedXML($xmlFragment)</from>
                        <to>$logTransactionInput.body/ns16:EntiltyList/ns16:EntityID[6]</to>
                    </copy>
                    <copy>
                        <from>concat('&amp;lt;EntityID EntityType=&amp;quot;TableName&amp;quot;&gt;', 'XxApPsVendor , xxApPsVendorAddr, xxApPsVendorLoc, xxApPsVndrAddrScrol, xxApPsVndrLocScrol', '&amp;lt;/EntityID&gt;')</from>
                        <to>$xmlFragment</to>
                    </copy>
                    <copy>
                        <from>ora:parseEscapedXML($xmlFragment)</from>
                        <to>$logTransactionInput.body/ns16:EntiltyList/ns16:EntityID[7]</to>
                    </copy>
                    <copy>
                        <from>concat('&amp;lt;EntityID EntityType=&amp;quot;ReleaseESPJob&amp;quot;&gt;', 'No', '&amp;lt;/EntityID&gt;')</from>
                        <to>$xmlFragment</to>
                    </copy>
                    <copy>
                        <from>ora:parseEscapedXML($xmlFragment)</from>
                        <to>$logTransactionInput.body/ns16:EntiltyList/ns16:EntityID[8]</to>
                    </copy>
                </assign>
                <invoke name="logTransaction"
                        partnerLink="InsertTransactionLogger"
                        portType="ns13:Produce_Message_ptt"
                        operation="Produce_Message"
                        inputVariable="logTransactionInput"
                        bpelx:invokeAsDetail="no"/>
            </sequence>
        </scope>

    </sequence>
</process>
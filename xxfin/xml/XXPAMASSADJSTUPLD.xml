<dataTemplate name="ProjectMassAdjustmentsUploadReport" description="" Version="1.0">
<properties>
    <property name="scalable_mode" value="on" /> 
    <property name="rtf-output-default-font">Arial:8</property> 
</properties>
<parameters>
</parameters>
<dataQuery>
    <sqlStatement name="Q_PROJECT_INFO">
        <![CDATA[
		SELECT  * FROM (select ppa.SEGMENT1 "PROJECT_NUMBER",
ppa.NAME "PROJECT_NAME",
ppa.LONG_NAME "PROJECT_LONG_NAME",
(SELECT project_status_name FROM PA_PROJECT_STATUSES PPS WHERE PPS.project_status_code=PPA.project_status_code AND PPS.status_type='PROJECT') "PROJECT_STATUS",
substr(ppa.START_DATE,1,10) "PROJECT_START_DATE",
substr(ppa.COMPLETION_DATE,1,10) "PROJECT_END_DATE",
ppa.ATTRIBUTE1 "PROJECT_LOCATION",
(SELECT name FROM HR_ALL_ORGANIZATION_UNITS WHERE ORGANIZATION_ID=PPA.CARRYING_OUT_ORGANIZATION_ID) "PROJECT_ORG",
(SELECT TASK_NUMBER FROM pa_tasks WHERE project_id=ppa.PROJECT_ID AND task_id=upldstg.task_id)"TASK_NUMBER",
(SELECT TASK_NAME FROM pa_tasks WHERE project_id=ppa.PROJECT_ID AND task_id=upldstg.task_id) "TASK_NAME",
(SELECT substr(START_DATE,1,10) FROM pa_tasks WHERE project_id=ppa.PROJECT_ID AND task_id=upldstg.task_id) "TASK_START_DATE",
(SELECT substr(COMPLETION_DATE,1,10) FROM pa_tasks WHERE project_id=ppa.PROJECT_ID AND task_id=upldstg.task_id) "TASK_END_DATE",
(SELECT attribute1 FROM pa_tasks WHERE project_id=ppa.PROJECT_ID AND task_id=upldstg.task_id) "TASK_LOCATION",
(SELECT name FROM HR_ALL_ORGANIZATION_UNITS,PA_TASKS pt WHERE ORGANIZATION_ID=pt.CARRYING_OUT_ORGANIZATION_ID AND
pt.task_id=upldstg.task_id) "TASK_ORG",
(select ppaa.asset_name from PA_PROJECT_ASSETS_ALL ppaa,PA_PROJECT_ASSET_ASSIGNMENTS passg,PA_TASKS pt
where ppaa.project_id=ppa.PROJECT_ID
and ppaa.project_id=passg.project_id
and ppaa.project_asset_id=passg.project_asset_id
and passg.task_id=pt.task_id
and pt.task_id=upldstg.task_id
and ppaa.project_asset_id=upldstg.project_asset_id) "ASSIGN_ASSETS",
(SELECT CHARGEABLE_FLAG FROM pa_tasks WHERE project_id=ppa.PROJECT_ID AND task_id=upldstg.task_id) "ALLOW_CHARGES",
(SELECT flv.meaning FROM FND_LOOKUP_VALUES flv,PA_TASKS pt
WHERE flv.lookup_type='SERVICE TYPE' 
AND flv.language=USERENV('LANG') 
AND flv.lookup_code=pt.service_type_code 
AND pt.task_id=upldstg.task_id) "SERVICE_TYPE",
keym.full_name "EMPLOYEE_NAME",
keym.employee_num "EMPLOYEE_NUMBER",
keym.meaning "ROLE",
substr(keym.start_date_active,1,10) "ROLE_START_DATE",
substr(keym.end_date_active,1,10) "ROLE_END_DATE",
STATUS_MESG "COMPLETION_STATUS",
FND_GLOBAL.CONC_REQUEST_ID "REQUEST_ID"
from XX_PA_MASS_ADJUST_UPLD_STG upldstg,
PA_PROJECTS_ALL ppa,
(SELECT ppp.project_id,hre.employee_id,hre.employee_num,hre.full_name,pprt.meaning,ppp.start_date_active,ppp.end_date_active 
FROM HR_EMPLOYEES hre,PA_PROJECT_PLAYERS ppp,PA_PROJECT_ROLE_TYPES pprt 
WHERE hre.employee_id=ppp.person_id
AND ppp.project_role_type=pprt.project_role_type) keym
where 1=1
AND upldstg.PROJECT_ID=ppa.PROJECT_ID
AND upldstg.status='P'
AND upldstg.employee_id=keym.employee_id
AND ppa.project_id=keym.project_id
UNION
SELECT UPPER(TRIM(PROJECT_NUMBER)) PROJECT_NUMBER,
		  PROJECT_NAME,
		  PROJECT_LONG_NAME,
		  PROJECT_STATUS,
		  substr(PROJECT_START_DATE,1,10) "PROJECT_START_DATE",
		  substr(PROJECT_END_DATE,1,10) "PROJECT_END_DATE",
		  PROJECT_LOCATION,
		  PROJECT_ORG,
		  TASK_NUMBER,
		  TASK_NAME,
		  substr(TASK_START_DATE,1,10) "TASK_START_DATE",
		  substr(TASK_END_DATE,1,10) "TASK_END_DATE",
      TASK_LOCATION,
		  TASK_ORG,
		  ASSIGN_ASSETS,
		  ALLOW_CHARGES,
      SERVICE_TYPE,
		  EMPLOYEE_NAME,
		  EMPLOYEE_NUMBER,
		  ROLE,
		  substr(ROLE_START_DATE,1,10) "ROLE_START_DATE",
		  substr(ROLE_END_DATE,1,10) "ROLE_END_DATE",
      STATUS_MESG "COMPLETION_STATUS",
      FND_GLOBAL.CONC_REQUEST_ID "REQUEST_ID"
		FROM XX_PA_MASS_ADJUST_UPLD_STG
		WHERE status ='E')
    ORDER BY PROJECT_NUMBER,PROJECT_NAME,TASK_NUMBER,TASK_NAME,ASSIGN_ASSETS,EMPLOYEE_NUMBER
        ]]> 
    </sqlStatement>
</dataQuery>
<dataStructure>
    <group name="G_PROJECT_INFO" source="Q_PROJECT_INFO">
        <element name="PROJECT_NUMBER" value="PROJECT_NUMBER" function="" /> 
        <element name="PROJECT_NAME" value="PROJECT_NAME" function="" /> 
        <element name="PROJECT_LONG_NAME" value="PROJECT_LONG_NAME" function="" />
        <element name="PROJECT_STATUS" value="PROJECT_STATUS" function="" />
        <element name="PROJECT_START_DATE" value="PROJECT_START_DATE" function="" /> 
		<element name="PROJECT_END_DATE" value="PROJECT_END_DATE" function="" />
        <element name="PROJECT_LOCATION" value="PROJECT_LOCATION" function="" />
        <element name="PROJECT_ORG" value="PROJECT_ORG" function="" />
        <element name="TASK_NUMBER" value="TASK_NUMBER" function="" />
        <element name="TASK_NAME" value="TASK_NAME" function="" />
        <element name="TASK_START_DATE" value="TASK_START_DATE" function="" />
        <element name="TASK_END_DATE" value="TASK_END_DATE" function="" />
        <element name="TASK_LOCATION" value="TASK_LOCATION" function="" />
        <element name="TASK_ORG" value="TASK_ORG" function="" />
        <element name="ASSIGN_ASSETS" value="ASSIGN_ASSETS" function="" />
        <element name="ALLOW_CHARGES" value="ALLOW_CHARGES" function="" />
        <element name="SERVICE_TYPE" value="SERVICE_TYPE" function="" />
        <element name="EMPLOYEE_NAME" value="EMPLOYEE_NAME" function="" />
        <element name="EMPLOYEE_NUMBER" value="EMPLOYEE_NUMBER" function="" />
        <element name="ROLE" value="ROLE" function="" />
        <element name="ROLE_START_DATE" value="ROLE_START_DATE" function="" />
        <element name="ROLE_END_DATE" value="ROLE_END_DATE" function="" />
		<element name="COMPLETION_STATUS" value="COMPLETION_STATUS" function="" />
        <element name="REQUEST_ID" value="REQUEST_ID" function="" />
	</group>
</dataStructure>
</dataTemplate>

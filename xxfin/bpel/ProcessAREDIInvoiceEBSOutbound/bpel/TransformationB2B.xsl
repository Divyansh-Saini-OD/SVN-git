<?xml version="1.0" encoding="UTF-8" ?>
<?oracle-xsl-mapper
  <!-- SPECIFICATION OF MAP SOURCES AND TARGETS, DO NOT MODIFY. -->
  <mapSources>
    <source type="XSD">
      <schema location="../../../../Office%20Depot/BPEL_Projects/ProcessAREDIInvoiceEBSOutbound/bpel/XXARINVPRNTSLCTEDI.xsd"/>
      <rootElement name="XXARINVPRNEDI" namespace="http://www.openapplications.org/oagis/9/officedepot/1"/>
    </source>
  </mapSources>
  <mapTargets>
    <target type="XSD">
      <schema location="http://chilsoa01d.na.odcorp.net:7778/orabpel/xmllib/eaixml/oagis/v91/message/bod/ProcessInvoice.xsd"/>
      <rootElement name="ProcessInvoice" namespace="http://www.openapplications.org/oagis/9"/>
    </target>
  </mapTargets>
  <!-- GENERATED BY ORACLE XSL MAPPER 10.1.3.3.0(build 070615.0525) AT [WED OCT 24 10:36:23 EDT 2007]. -->
?>
<xsl:stylesheet version="1.0"
                xmlns:ns6="http://www.openapplications.org/oagis/9/unqualifieddatatypes/1.1"
                xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/"
                xmlns:ns8="http://www.openapplications.org/oagis/9/currencycode/54217:2001"
                xmlns:ns5="http://www.openapplications.org/oagis/9/qualifieddatatypes/1.1"
                xmlns:ehdr="http://www.oracle.com/XSL/Transform/java/oracle.tip.esb.server.headers.ESBHeaderFunctions"
                xmlns:ns2="http://www.openapplications.org/oagis/9/officedepot/1/codelists"
                xmlns:ns3="http://www.openapplications.org/oagis/9/IANAMIMEMediaTypes:2003"
                xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                xmlns:ns4="http://www.openapplications.org/oagis/9/codelists"
                xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath"
                xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
                xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions"
                xmlns:ns0="http://www.openapplications.org/oagis/9/officedepot/1"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:ora="http://schemas.oracle.com/xpath/extension"
                xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath"
                xmlns:orcl="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
                xmlns:ns1="http://www.openapplications.org/oagis/9"
                xmlns:ns7="http://www.openapplications.org/oagis/9/unitcode/66411:2001"
                xmlns:ns9="http://www.openapplications.org/oagis/9/languagecode/5639:1988"
                exclude-result-prefixes="xsl xsd ns0 ns6 ns8 ns5 ns2 ns3 ns4 ns1 ns7 ns9 bpws ehdr hwf xp20 xref ora ids orcl">
  <xsl:template match="/">
    <ns1:ProcessInvoice>
      <ns1:DataArea>
     <xsl:for-each select="/ns0:XXARINVPRNEDI/ns0:G_INVOICES">
        <ns1:Invoice>
         <ns1:InvoiceHeader>
              <ns1:DocumentID>
                <ns1:ID>
                  <xsl:value-of select="ns0:ORIGINAL_TRANSACTION_NUMBER"/>
                </ns1:ID>
                <ns1:VariationID>
                  <xsl:value-of select="ns0:INVOICE_TYPE"/>
                </ns1:VariationID>
              </ns1:DocumentID>
              <ns1:AlternateDocumentID>
                <ns1:ID>
                  <xsl:value-of select="ns0:ORGORDNBR"/>
                </ns1:ID>
              </ns1:AlternateDocumentID>
              <ns1:DocumentDateTime>
                <xsl:value-of select="ns0:INVDATE"/>
              </ns1:DocumentDateTime>
              <ns1:Note>
                <xsl:value-of select="ns0:COMMENTS"/>
              </ns1:Note>
    <!-- Document Reference Document Id / Id is the Sales order number for the invoice for the credit memo -->          
              <ns1:DocumentReference>
                <ns1:DocumentID>
                  <ns1:ID>
                    <xsl:value-of select="ns0:CP_RETURN_ORDER_NUMBER"/>
                  </ns1:ID>
                </ns1:DocumentID>
                <ns1:DocumentDateTime>
                  <xsl:value-of select="ns0:CP_RETURN_ORDER_DATE"/>
                </ns1:DocumentDateTime>
                <ns1:EffectiveTimePeriod>
                  <ns1:StartDateTime>
                    <xsl:value-of select="ns0:BILL_FROM_DATE"/>
                  </ns1:StartDateTime>
                  <ns1:EndDateTime>
                    <xsl:value-of select="ns0:BILL_TO_DATE"/>
                  </ns1:EndDateTime>
                </ns1:EffectiveTimePeriod>
              </ns1:DocumentReference>
              <ns1:ExtendedAmount>
                <xsl:value-of select="ns0:ORDSUBTOTAL"/>
              </ns1:ExtendedAmount>
              <ns1:TotalAmount>
                <!--Added the currencyID attribute for defect 2646-->
                <xsl:attribute name="currencyID">
                   <xsl:value-of select="ns0:PAYTERM_CURRENCY"/>
                </xsl:attribute>
                <xsl:value-of select="ns0:TOTALORDAMT"/>
              </ns1:TotalAmount>
              <ns1:SupplierParty>
                <ns1:Name>
                  <xsl:value-of select="ns0:SUPPLIER_NAME"/>
                </ns1:Name>
                <ns1:Location>
                  <ns1:Name>
                    <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:SUPPLIER_NAME1"/>
                  </ns1:Name>
                  <ns1:Address>
                    <ns1:LineOne>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:SUPPLIER_ADDRESS1"/>
                    </ns1:LineOne>
                    <ns1:LineTwo>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:SUPPLIER_ADDRESS2"/>
                    </ns1:LineTwo>
                    <ns1:LineThree>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:SUPPLIER_ADDRESS3"/>
                    </ns1:LineThree>
                    <ns1:LineFour>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:SUPPLIER_ADDRESS4"/>
                    </ns1:LineFour>
                    <ns1:CityName>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:SUPPLIER_CITY"/>
                    </ns1:CityName>
                    <ns1:CountryCode>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:SUPPLIER_COUNTRY"/>
                    </ns1:CountryCode>
                    <ns1:PostalCode>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:SUPPLIER_POSTAL_CODE"/>
                    </ns1:PostalCode>
                  </ns1:Address>
                </ns1:Location>
                <ns1:Contact>
                  <ns1:Communication>
                    <ns1:AreaDialing>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:SUPPLIER_PHONE_AREACODE"/>
                    </ns1:AreaDialing>
                    <ns1:DialNumber>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:SUPPLIER_PHONE_NUMBER"/>
                    </ns1:DialNumber>
                    <ns1:Extension>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:SUPPLIER_PHONE_EXT"/>
                    </ns1:Extension>
                  </ns1:Communication>
                </ns1:Contact>
                <ns1:SalesContact>
                  <ns1:Name>
                    <xsl:value-of select="ns0:SALESPERSON"/>
                  </ns1:Name>
                </ns1:SalesContact>
                <ns1:ShippingContact>
                  <xsl:value-of select="ns0:SALESPERSON"/>
                </ns1:ShippingContact>
              </ns1:SupplierParty>
              <ns1:CustomerParty>
                <ns1:PartyIDs>
                  <ns1:ID>
                    <xsl:value-of select="ns0:LIST_G_INVOICE_BILL_TO_SITE/ns0:G_INVOICE_BILL_TO_SITE/ns0:BILL_TO_CUSTOMER_NUMBER"/>
                  </ns1:ID>
                  <ns1:AlternateID>
                    <xsl:value-of select="ns0:LIST_G_INVOICE_BILL_TO_SITE/ns0:G_INVOICE_BILL_TO_SITE/ns0:BILL_TO_CUST_ACCT_NUMBER_LEGACY"/>
                  </ns1:AlternateID>
                </ns1:PartyIDs>
                <ns1:Name>
                    <xsl:value-of select="ns0:LIST_G_INVOICE_BILL_TO_SITE/ns0:G_INVOICE_BILL_TO_SITE/ns0:BILL_TO_CUSTOMER_NAME"/>
                  </ns1:Name>
                <ns1:Location>
                  <ns1:name>
                      <xsl:value-of select="ns0:LIST_G_INVOICE_BILL_TO_SITE/ns0:G_INVOICE_BILL_TO_SITE/ns0:BILL_TO_LOCATION_NAME"/>  
                  </ns1:name>
                  <ns1:Address>
                    <ns1:ID>
                      <xsl:value-of select="ns0:LIST_G_INVOICE_BILL_TO_SITE/ns0:G_INVOICE_BILL_TO_SITE/ns0:BILL_TO_SITE_NUMBER"/>
                    </ns1:ID>
                    <ns1:AttentionOfName>
                      <xsl:value-of select="ns0:BILL_TO_CONTACT_NAME"/>
                    </ns1:AttentionOfName>
                    <ns1:CareOfName>
                      <xsl:value-of select="ns0:BILL_TO_CONTACT_NAME"/>
                    </ns1:CareOfName>
                    <ns1:LineOne>
                      <xsl:value-of select="ns0:LIST_G_INVOICE_BILL_TO_SITE/ns0:G_INVOICE_BILL_TO_SITE/ns0:BILL_TO_ADDRESS1"/>
                    </ns1:LineOne>
                    <ns1:LineTwo>
                      <xsl:value-of select="ns0:LIST_G_INVOICE_BILL_TO_SITE/ns0:G_INVOICE_BILL_TO_SITE/ns0:BILL_TO_ADDRESS2"/>
                    </ns1:LineTwo>
                    <ns1:LineThree>
                      <xsl:value-of select="ns0:LIST_G_INVOICE_BILL_TO_SITE/ns0:G_INVOICE_BILL_TO_SITE/ns0:BILL_TO_ADDRESS3"/>
                    </ns1:LineThree>
                    <ns1:LineFour>
                      <xsl:value-of select="ns0:LIST_G_INVOICE_BILL_TO_SITE/ns0:G_INVOICE_BILL_TO_SITE/ns0:BILL_TO_ADDRESS4"/>
                    </ns1:LineFour>
                    <ns1:CitySubDivisionName>
                      <xsl:value-of select="ns0:LIST_G_INVOICE_BILL_TO_SITE/ns0:G_INVOICE_BILL_TO_SITE/ns0:BILL_TO_PROVINCE"/>
                    </ns1:CitySubDivisionName>
                    <ns1:CityName>
                      <xsl:value-of select="ns0:LIST_G_INVOICE_BILL_TO_SITE/ns0:G_INVOICE_BILL_TO_SITE/ns0:BILL_TO_CITY"/>
                    </ns1:CityName>
                    <ns1:CountrySubDivisionCode>
                      <xsl:value-of select="ns0:LIST_G_INVOICE_BILL_TO_SITE/ns0:G_INVOICE_BILL_TO_SITE/ns0:BILL_TO_STATE"/>
                    </ns1:CountrySubDivisionCode>
                    <ns1:CountryCode>
                      <xsl:value-of select="ns0:LIST_G_INVOICE_BILL_TO_SITE/ns0:G_INVOICE_BILL_TO_SITE/ns0:BILL_TO_COUNTRY"/>
                    </ns1:CountryCode>
                    <ns1:PostalCode>
                      <xsl:value-of select="ns0:LIST_G_INVOICE_BILL_TO_SITE/ns0:G_INVOICE_BILL_TO_SITE/ns0:BILL_TO_POSTAL_CODE"/>
                    </ns1:PostalCode>
                  </ns1:Address>
                </ns1:Location>
                <ns1:Contact>
                  <ns1:Name>
                    <xsl:value-of select="ns0:BILL_TO_CONTACT_NAME"/>
                  </ns1:Name>
                 <ns1:Communication>
                    <ns1:AreaDialing>
                      <xsl:value-of select="ns0:BILL_TO_AREA_CODE"/>
                    </ns1:AreaDialing>
                    <ns1:DialNumber>
                      <xsl:value-of select="ns0:BILL_TO_CONTACT_PHONE_NUMBER"/>
                    </ns1:DialNumber>
                    <ns1:Extension>
                      <xsl:value-of select="ns0:BILL_TO_CONTACT_EXTENSION"/>
                    </ns1:Extension>
                    </ns1:Communication>
                   <ns1:URI>
                      <xsl:value-of select="ns0:BILL_TO_CONTACT_EMAIL_ADDRESS"/>
                    </ns1:URI>
               </ns1:Contact>
                <ns1:BuyerContact>
                  <ns1:Name>
                    <xsl:value-of select="ns0:BILL_TO_CONTACT_NAME"/>"
                  </ns1:Name>
                  <ns1:DepartmentName>
                    <xsl:value-of select="ns0:BILL_TO_SITE_LOCATION"/>
                  </ns1:DepartmentName>
                  <ns1:Communication>
                    <ns1:AreaDialing>
                      <xsl:value-of select="ns0:BILL_TO_AREA_CODE"/>
                    </ns1:AreaDialing>
                    <ns1:DialNumber>
                      <xsl:value-of select="ns0:BILL_TO_CONTACT_PHONE_NUMBER"/>
                    </ns1:DialNumber>
                    <ns1:Extension>
                      <xsl:value-of select="ns0:BILL_TO_CONTACT_EXTENSION"/>
                    </ns1:Extension>
                  </ns1:Communication>
                </ns1:BuyerContact>
                <ns1:ReceivingContact>
                  <ns1:Name>
                    <xsl:value-of select="ns0:SHIP_TO_CONTACT_NAME"/>
                  </ns1:Name>
                  <ns1:Communication>
                    <ns1:AreaDialing>
                      <xsl:value-of select="ns0:SHIP_TO_CONTACT_AREA_CODE"/>
                    </ns1:AreaDialing>
                    <ns1:DialNumber>
                      <xsl:value-of select="ns0:SHIP_TO_CONTACT_PHONE_NUMBER"/>
                    </ns1:DialNumber>
                    <ns1:Extension>
                      <xsl:value-of select="ns0:SHIP_TO_CONTACT_EXTENSION "/>
                    </ns1:Extension>
                  </ns1:Communication>
                </ns1:ReceivingContact>
              </ns1:CustomerParty>
              <ns1:ShipToParty>
                <ns1:PartyIDs>
                  <ns1:ID>
                    <xsl:value-of select="ns0:LIST_G_INVOICE_SHIP_TO_SITE/ns0:G_INVOICE_SHIP_TO_SITE/ns0:SHIP_TO_CUSTOMER_NUMBER"/>
                  </ns1:ID>
                  <ns1:AlternateID>
                    <xsl:value-of select="ns0:LIST_G_INVOICE_SHIP_TO_SITE/ns0:G_INVOICE_SHIP_TO_SITE/ns0:SHIP_TO_CUST_ACCT_NUMBER_LEGACY"/>
                  </ns1:AlternateID>
                </ns1:PartyIDs>
                <ns1:Name>
                    <xsl:value-of select="ns0:LIST_G_INVOICE_SHIP_TO_SITE/ns0:G_INVOICE_SHIP_TO_SITE/ns0:SHIP_TO_CUSTOMER_NAME"/>
                </ns1:Name>
                <ns1:Location>
                <ns1:name>
                   <xsl:value-of select="ns0:LIST_G_INVOICE_SHIP_TO_SITE/ns0:G_INVOICE_SHIP_TO_SITE/ns0:SHIP_TO_LOCATION_NAME"/>  
                </ns1:name>
                  <ns1:Address>
                    <ns1:ID>
                      <xsl:value-of select="ns0:LIST_G_INVOICE_SHIP_TO_SITE/ns0:G_INVOICE_SHIP_TO_SITE/ns0:SHIP_TO_SITE_NUMBER"/>
                    </ns1:ID>
                    <ns1:AttentionOfName>
                      <xsl:value-of select="ns0:SHIP_TO_CONTACT_NAME"/>
                    </ns1:AttentionOfName>
                    <ns1:CareOfName>
                      <xsl:value-of select="ns0:SHIP_TO_CONTACT_NAME"/>
                    </ns1:CareOfName>
                    <ns1:LineOne>
                      <xsl:value-of select="ns0:EMBED_SHIP_TO_ADDRESS1"/>
                    </ns1:LineOne>
                    <ns1:LineTwo>
                      <xsl:value-of select="ns0:EMBED_SHIP_TO_ADDRESS2"/>
                    </ns1:LineTwo>
                    <ns1:CityName>
                      <xsl:value-of select="ns0:EMBED_SHIP_TO_CITY"/>
                    </ns1:CityName>
                    <ns1:CountrySubDivisionCode>
                      <xsl:value-of select="ns0:EMBED_SHIP_TO_STATE"/>
                    </ns1:CountrySubDivisionCode>
                    <ns1:CountryCode>
                      <xsl:value-of select="ns0:EMBED_SHIP_TO_COUNTRY"/>
                    </ns1:CountryCode>
                    <ns1:PostalCode>
                      <xsl:value-of select="ns0:EMBED_SHIP_TO_ZIP"/>
                    </ns1:PostalCode>
                  </ns1:Address>
                </ns1:Location>
                <ns1:Contact>
                 <ns1:name>
                   <xsl:value-of select="ns0:SHIP_TO_CONTACT_NAME"/>
                 </ns1:name>
                  <ns1:Communication>
                    <ns1:AreaDialing>
                      <xsl:value-of select="ns0:SHIP_TO_CONTACT_AREA_CODE"/>
                    </ns1:AreaDialing>
                    <ns1:DialNumber>
                      <xsl:value-of select="ns0:SHIP_TO_CONTACT_PHONE_NUMBER"/>
                    </ns1:DialNumber>
                    <ns1:Extension>
                      <xsl:value-of select="ns0:SHIP_TO_CONTACT_EXTENSION"/>
                    </ns1:Extension>
                    <ns1:URI>
                      <xsl:value-of select="ns0:SHIP_TO_CONTACT_EMAIL_ADDRESS"/>
                    </ns1:URI>
                  </ns1:Communication>
                </ns1:Contact>
              </ns1:ShipToParty>
              <ns1:RemitToParty>
                <ns1:PartyIDs>
                  <ns1:TaxID>
                    <xsl:value-of select="ns0:LIST_G_INVOICE_LINES/ns0:G_INVOICE_LINES/ns0:CUSTOMER_EXEMPTION_NUMBER"/>
                  </ns1:TaxID>
                </ns1:PartyIDs>
                <ns1:Location>
                  <ns1:Address>
                    <ns1:AttentionOfName>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:REMIT_TO_NAME"/>
                    </ns1:AttentionOfName>
                    <ns1:LineOne>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:REMIT_ADDRESS5"/>
                    </ns1:LineOne>
                    <ns1:LineTwo>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:REMIT_ADDRESS6"/>
                    </ns1:LineTwo>
                    <ns1:LineThree>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:REMIT_ADDRESS7"/>
                    </ns1:LineThree>
                    <ns1:LineFour>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:REMIT_ADDRESS8"/>
                    </ns1:LineFour>
                    <ns1:CitySubDivisionName>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:REMIT_PROVINCE"/>
                    </ns1:CitySubDivisionName>
                    <ns1:CityName>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:REMIT_CITY"/>
                    </ns1:CityName>
                    <ns1:CountrySubDivisionCode>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:REMIT_STATE"/>
                    </ns1:CountrySubDivisionCode>
                    <ns1:CountryCode>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:REMIT_COUNTRY1"/>
                    </ns1:CountryCode>
                    <ns1:PostalCode>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:REMIT_POSTAL_CODE1"/>
                    </ns1:PostalCode>
                  </ns1:Address>
                </ns1:Location>
                <ns1:Contact>
                  <ns1:Communication>
                    <ns1:AreaDialing>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:REMIT_PHONE_AREACODE"/>
                    </ns1:AreaDialing>
                    <ns1:DialNumber>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:REMIT_PHONE_NUMBER"/>
                    </ns1:DialNumber>
                    <ns1:Extension>
                      <xsl:value-of select="ns0:LIST_G_CUST_REMIT_TO_ADDRESS/ns0:G_CUST_REMIT_TO_ADDRESS/ns0:REMIT_PHONE_EXT"/>
                    </ns1:Extension>
                  </ns1:Communication>
                </ns1:Contact>
              </ns1:RemitToParty>
              <ns1:PurchaseOrderReference>
                <ns1:DocumentID>
                  <ns1:ID>
                    <xsl:value-of select="ns0:PURCHASE_ORDER"/>
                  </ns1:ID>
                </ns1:DocumentID>
                <ns1:DocumentDateTime>
                  <xsl:value-of select="ns0:PURCHASE_ORDER_DATE"/>
                </ns1:DocumentDateTime>
                <ns1:ReleaseNumber>
                  <xsl:value-of select="ns0:LIST_G_INVOICE_LINES/ns0:G_INVOICE_LINES/ns0:RELEASENUM"/>
                </ns1:ReleaseNumber>
                <ns1:LineNumber>
                  <xsl:value-of select="ns0:LIST_G_INVOICE_LINES/ns0:G_INVOICE_LINES/ns0:CUSTOMER_LINE_NUMBER"/>
                </ns1:LineNumber>
              </ns1:PurchaseOrderReference>
 <!-- Sales Order Reference contains details for the sales order number for the credit memo -->
              <ns1:SalesOrderReference>
                <ns1:DocumentID>
                  <ns1:ID>
                  <xsl:value-of select="ns0:LIST_G_INVOICE_LINES/ns0:G_INVOICE_LINES/ns0:SALES_ORDER"/>
                  </ns1:ID>
                </ns1:DocumentID>
                <ns1:DocumentDateTime>
                  <xsl:value-of select="ns0:ORDERED_DATE"/>
                </ns1:DocumentDateTime>
                <ns1:LineNumber>
                  <xsl:value-of select="ns0:LIST_G_INVOICE_LINES/ns0:G_INVOICE_LINES/ns0:ORDER_LINE_NUMBER"/>
                </ns1:LineNumber>
              </ns1:SalesOrderReference>
              <ns1:ActualShipDateTime>
                <xsl:value-of select="ns0:LIST_G_INVOICE_LINES/ns0:G_INVOICE_LINES/ns0:RECONCILEDATE"/>
              </ns1:ActualShipDateTime>
              <ns1:PaymentTerm>
                <ns1:Term>
                  <ns1:Description>
                    <xsl:value-of select="ns0:PAYTERM"/>
                  </ns1:Description>
                  <ns1:DueDateTime>
                    <xsl:value-of select="ns0:BILLPAYDUE"/>
                  </ns1:DueDateTime>
                </ns1:Term>
              </ns1:PaymentTerm>
        <xsl:for-each select="ns0:LIST_G_RECEIPT/ns0:G_RECEIPT">       
               <ns0:Settlement>
                <ns1:CreditCard>
                  <ns1:PaymentAuthorization>
                    <ns1:ID>
                      <xsl:value-of select="ns0:CREDIT_CARD_APPROVAL_CODE"/>
                    </ns1:ID>
                    <ns1:AuthorizationDate>
                      <xsl:value-of select="ns0:RECEIPT_DATE"/>
                    </ns1:AuthorizationDate>
                  </ns1:PaymentAuthorization>
                  <ns0:MaskedNumber>
                    <xsl:value-of select="ns0:CREDIT_CARD_GHOST_NUMBER"/>
                  </ns0:MaskedNumber>
                </ns1:CreditCard>
              </ns0:Settlement>
    </xsl:for-each>     
              <ns1:Tax>
                <ns1:ID>
                  <xsl:value-of select="ns0:FEDERALID"/>
                </ns1:ID>
                <ns1:BasisAmount>
                  <xsl:value-of select="ns0:ORDSUBTOTAL"/>
                </ns1:BasisAmount>
                <ns1:Amount>
                  <xsl:value-of select="ns0:TOT_TAXAMT"/>
                </ns1:Amount>
                <ns1:Calculation>
                   <ns1:RateNumeric>
                        <xsl:value-of select="ns0:OM_TAX_RATE"/>
                     </ns1:RateNumeric>
                </ns1:Calculation>
              </ns1:Tax>
              <!--Commenting the default Charge for defect 2646
              <ns1:Charge>
                <ns1:CurrencyExchangeRate>
                  <ns1:SourceCurrencyCode>
                    <xsl:value-of select="ns0:PAYTERM_CURRENCY"/>
                  </ns1:SourceCurrencyCode>
                </ns1:CurrencyExchangeRate>
              </ns1:Charge>              -->
      <xsl:if test="normalize-space(ns0:TOTALMISCCHRG) != '' and normalize-space(ns0:TOTALMISCCHRG) != 0" >
              <ns1:Charge>
             <xsl:attribute name="type">
                     <xsl:text disable-output-escaping="no">Miscellaneous</xsl:text>
                   </xsl:attribute>
                <ns1:Amount>
                  <xsl:value-of select="ns0:TOTALMISCCHRG"/>
                </ns1:Amount>
                <ns1:CurrencyExchangeRate>
                  <ns1:SourceCurrencyCode>
                    <xsl:value-of select="ns0:PAYTERM_CURRENCY"/>
                  </ns1:SourceCurrencyCode>
                </ns1:CurrencyExchangeRate>
              </ns1:Charge>
      </xsl:if>
      <xsl:if test="normalize-space(ns0:TOTALDELIVCHRG) != '' and normalize-space(ns0:TOTALDELIVCHRG) != 0" >
              <ns1:Charge>
             <xsl:attribute name="type">
                     <xsl:text disable-output-escaping="no">Delivery</xsl:text>
                   </xsl:attribute>
                <ns1:Amount>
                  <xsl:value-of select="ns0:TOTALDELIVCHRG"/>
                </ns1:Amount>
                <ns1:CurrencyExchangeRate>
                  <ns1:SourceCurrencyCode>
                    <xsl:value-of select="ns0:PAYTERM_CURRENCY"/>
                  </ns1:SourceCurrencyCode>
                </ns1:CurrencyExchangeRate>
              </ns1:Charge>
      </xsl:if>
      <xsl:if test="normalize-space(ns0:GIFTCARD_AMOUNT) != '' and normalize-space(ns0:GIFTCARD_AMOUNT) != 0" >
        <ns1:Charge>
          <xsl:attribute name="type">
            <xsl:text disable-output-escaping="no">GiftCard</xsl:text>
          </xsl:attribute>
          <ns1:Amount>
            <xsl:value-of select="ns0:GIFTCARD_AMOUNT"/>
          </ns1:Amount>
          <ns1:CurrencyExchangeRate>
            <ns1:SourceCurrencyCode>
              <xsl:value-of select="ns0:PAYTERM_CURRENCY"/>
            </ns1:SourceCurrencyCode>
          </ns1:CurrencyExchangeRate>
        </ns1:Charge>
      </xsl:if>
              <ns0:DesktopLocation>
                <ns1:ID>
                  <xsl:value-of select="ns0:CUSTLOC"/>
                </ns1:ID>
              </ns0:DesktopLocation>
              <ns0:CostCenterID>
                <xsl:value-of select="ns0:CUSTDEPT"/>
              </ns0:CostCenterID>
              <ns0:HardCopyDeliveryMethodCode>
                <xsl:value-of select="ns0:LIST_G_INVOICE_BILL_TO_SITE/ns0:G_INVOICE_BILL_TO_SITE/ns0:SPECHANDLING"/>
              </ns0:HardCopyDeliveryMethodCode>
     <xsl:if test="normalize-space(ns0:TOT_STGST_TAX_AMOUNT) != '' and normalize-space(ns0:TOT_STGST_TAX_AMOUNT) != 0 "> 
                <ns1:Tax>                     
                   <xsl:attribute name="type">
                     <xsl:text disable-output-escaping="no">STGST</xsl:text>
                   </xsl:attribute>  
                   <ns1:BasisAmount>
                     <xsl:value-of select="ns0:TOT_STGST_TAX_AMOUNT"/>
                   </ns1:BasisAmount>
                   <ns1:Calculation>
                     <ns1:RateNumeric>
                       <xsl:value-of select="ns0:MAX_STGST_RATE"/>
                     </ns1:RateNumeric>
                   </ns1:Calculation>
                </ns1:Tax>            
              </xsl:if>
      <xsl:if test="normalize-space(ns0:TOT_COPST_TAX_AMOUNT)!='' and normalize-space(ns0:TOT_COPST_TAX_AMOUNT) != 0 ">                         
                <ns1:Tax>      
                   <xsl:attribute name="type">
                     <xsl:text disable-output-escaping="no">COPST</xsl:text>
                   </xsl:attribute>                    
                   <ns1:BasisAmount>
                     <xsl:value-of select="ns0:TOT_COPST_TAX_AMOUNT"/>
                   </ns1:BasisAmount>
                   <ns1:Calculation>
                     <ns1:RateNumeric>
                       <xsl:value-of select="ns0:MAX_COPST_RATE"/>
                     </ns1:RateNumeric>
                   </ns1:Calculation>
                </ns1:Tax>
              </xsl:if>                 
         </ns1:InvoiceHeader>    
          <xsl:for-each select="ns0:LIST_G_INVOICE_LINES/ns0:G_INVOICE_LINES">
           <ns1:InvoiceLine>
                <ns1:LineNumber>
                  <xsl:value-of select="ns0:I_CUST_PO_LINE_NBR"/>
                </ns1:LineNumber>
            <ns1:DocumentReference>
              <ns1:SalesOrderReference>
                <ns1:DocumentID>
                  <ns1:ID>
                    <xsl:value-of select="ns0:SALES_ORDER"/>
                  </ns1:ID>
                </ns1:DocumentID>
                <ns1:DocumentDateTime>
                  <xsl:value-of select="../../ns0:ORDERED_DATE"/>
                </ns1:DocumentDateTime>
                <ns1:LineNumber>
                  <xsl:value-of select="ns0:SALES_ORDER_LINE"/>
                </ns1:LineNumber>
              </ns1:SalesOrderReference>
            </ns1:DocumentReference>     
                <ns0:GSAIndicator>
                 <xsl:value-of select="ns0:GSA_FLAG"/>
               </ns0:GSAIndicator>
                <ns1:Item>
                  <ns1:ItemID>
                    <ns1:ID>
                      <xsl:value-of select="ns0:SKU"/>
                    </ns1:ID>
                  </ns1:ItemID>
                  <ns1:CustomerItemID>
                    <ns1:ID>
                      <xsl:value-of select="ns0:PRODUCTCDENTERED"/>
                    </ns1:ID>
                  </ns1:CustomerItemID>
                  <ns1:SupplierItemID>
                    <ns1:ID>
                      <xsl:value-of select="ns0:VENDORPRODCD"/>
                    </ns1:ID>
                  </ns1:SupplierItemID>
                  <ns1:Description>
                    <xsl:value-of select="ns0:SKUDESCRIPTION"/>
                  </ns1:Description>
                  <ns1:Note>
                    <xsl:value-of select="ns0:ITEM_COMMENTS"/>
                  </ns1:Note>
                </ns1:Item>
                <ns1:Quantity>
                  <xsl:value-of select="ns0:QTYSHIPPED"/>
                </ns1:Quantity>
                <ns1:UnitPrice>
                  <ns1:Amount>
                    <xsl:value-of select="ns0:SKURETAILPRICE"/>
                  </ns1:Amount>
                   <ns1:PerQuantity>
                    <xsl:value-of select="ns0:EDISELL"/>
                 </ns1:PerQuantity>
                 </ns1:UnitPrice>
                <ns0:UnitListPriceAmount>
                  <xsl:value-of select="ns0:SKULISTPRICE"/>
                </ns0:UnitListPriceAmount>
                <ns1:PurchaseOrderReference>
                  <ns1:LineNumber>
                    <xsl:value-of select="ns0:CUSTOMER_LINE_NUMBER"/>
                  </ns1:LineNumber>
                </ns1:PurchaseOrderReference>
                <ns1:ExtendedAmount>
                  <xsl:value-of select="ns0:EXTPRICE"/>
                </ns1:ExtendedAmount>
                <ns1:Tax>
                  <ns1:TaxJurisdicationCodes>
                    <ns1:Code>
                      <xsl:value-of select="ns0:LIST_G_INVOICE_LINE_TAX/ns0:G_INVOICE_LINE_TAX/ns0:TAXABLECD"/>
                    </ns1:Code>
                  </ns1:TaxJurisdicationCodes>
                  <ns1:Amount>
                    <xsl:value-of select="ns0:TOT_TAXAMT"/>
                  </ns1:Amount>
                 <ns1:RateNumeric>
                   <xsl:value-of select="ns0:CS_TAX_RATE"/>
                 </ns1:RateNumeric>
                 <ns1:Exemption>
                   <ns1:Note>
                    <xsl:value-of select="ns0:TAXABLE_FLAG"/>
                   </ns1:Note>
                 </ns1:Exemption>
                </ns1:Tax>
              <xsl:if test="normalize-space(ns0:TOT_STGST_TAX_AMOUNT) != '' and normalize-space(ns0:TOT_STGST_TAX_AMOUNT) != 0"> 
                <ns1:Tax>                     
                   <xsl:attribute name="type">
                     <xsl:text disable-output-escaping="no">STGST</xsl:text>
                   </xsl:attribute>  
                   <ns1:BasisAmount>
                     <xsl:value-of select="ns0:TOT_STGST_TAX_AMOUNT"/>
                   </ns1:BasisAmount>
                   <ns1:Calculation>
                     <ns1:RateNumeric>
                       <xsl:value-of select="ns0:TOT_STGST_TAX_RATE"/>
                     </ns1:RateNumeric>
                   </ns1:Calculation>
                </ns1:Tax>            
              </xsl:if>
              <xsl:if test="normalize-space(ns0:TOT_COPST_TAX_AMOUNT)!='' and normalize-space(ns0:TOT_COPST_TAX_AMOUNT) != 0">                          
                <ns1:Tax>      
                   <xsl:attribute name="type">
                     <xsl:text disable-output-escaping="no">COPST</xsl:text>
                   </xsl:attribute>                    
                   <ns1:BasisAmount>
                     <xsl:value-of select="ns0:TOT_COPST_TAX_AMOUNT"/>
                   </ns1:BasisAmount>
                   <ns1:Calculation>
                     <ns1:RateNumeric>
                       <xsl:value-of select="ns0:TOT_COPST_TAX_RATE"/>
                     </ns1:RateNumeric>
                   </ns1:Calculation>
                </ns1:Tax>
              </xsl:if>   
              
              
              
              <xsl:if test="normalize-space(ns0:DELIV) != ''"> 
                <ns0:InvoiceCharge>                     
                   <xsl:attribute name="type">
                     <xsl:text disable-output-escaping="no">Delivery</xsl:text>
                   </xsl:attribute>  
                   <ns1:Description>
                     <xsl:value-of select="ns0:DELIV"/>
                   </ns1:Description>
                </ns0:InvoiceCharge>            
              </xsl:if>
              <xsl:if test="normalize-space(ns0:MISC)!=''">                         
                <ns0:InvoiceCharge>      
                   <xsl:attribute name="type">
                     <xsl:text disable-output-escaping="no">Miscellaneous</xsl:text>
                   </xsl:attribute>                    
                   <ns1:Description>
                     <xsl:value-of select="ns0:MISC"/>
                   </ns1:Description>
                </ns0:InvoiceCharge>
              </xsl:if> 
                <ns0:InvoiceCharge>
                  <ns1:Amount>
                    <xsl:value-of select="../../ns0:TOTALDELIVCHRG"/>
                  </ns1:Amount>
                </ns0:InvoiceCharge>
                <ns1:BackOrderedQuantity>
                  <xsl:value-of select="ns0:QTYBACKORD"/>
                </ns1:BackOrderedQuantity>
                <ns1:WarehouseLocation>
                  <ns1:ID>
                    <xsl:value-of select="ns0:DTLOCID"/>
                  </ns1:ID>
                </ns1:WarehouseLocation>
                <ns0:OriginalCustomerData>
                <xsl:attribute name="name">
                     <xsl:text disable-output-escaping="no">CustomerUnitPrice</xsl:text>
                   </xsl:attribute>                    
                <ns0:NameValue>
                  <xsl:value-of select="ns0:CUSTOMER_UNIT_PRICE"/>
                </ns0:NameValue>
                </ns0:OriginalCustomerData>
                <ns0:OriginalCustomerData>
                    <xsl:attribute name="name">
                     <xsl:text disable-output-escaping="no">CustomerUOM</xsl:text>
                   </xsl:attribute>
                  <ns0:NameValue> 
                  <xsl:value-of select="ns0:CUSTOMER_UOM"/>
                  </ns0:NameValue>
                </ns0:OriginalCustomerData>
             </ns1:InvoiceLine>
          </xsl:for-each>
        </ns1:Invoice>
        </xsl:for-each>
      </ns1:DataArea>
    </ns1:ProcessInvoice>
  </xsl:template>
</xsl:stylesheet>

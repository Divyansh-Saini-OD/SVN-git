<?xml version="1.0" encoding="WINDOWS-1252"?>
<dataTemplate name="XXARSELFSERVICE" defaultPackage="XX_AR_SELF_SERVICE" description="OD: AR Invalid details report" Version="1.0">
  <properties>
    <property name="scalable_mode" value="on"/>
    <property name="rtf-output-default-font">Arial:8</property>
  </properties>
  <parameters>
    <parameter name = "P_TYPE"               dataType = "character"/>
    <parameter name = "P_AS_OF_DATE"         datatype = "character"/>
    <parameter name = "P_MAIL_TO"         datatype = "character"/>
    <parameter name="P_SMTP_SERVER" dataType="character" defaultValue=""/>
    <parameter name="P_MAIL_FROM" dataType="character" defaultValue=""/>
  </parameters>
  <dataQuery>
    <sqlStatement name="Q_PARAMS">
      <![CDATA[
         SELECT INITCAP(:P_TYPE) req_type
               ,to_char(fnd_conc_date.string_to_date(:P_AS_OF_DATE),'DD-MON-RRRR') AS_OF_DATE
               ,:P_MAIL_TO MAIL_TO
               ,:P_SMTP_SERVER SMTP_SERVER
               ,:P_MAIL_FROM FROM_EMAIL
         FROM   DUAL
      ]]>
    </sqlStatement>
    <sqlStatement name="Q_BAD_ADDRESS">
      <![CDATA[
         SELECT  CUSTOMER_NAME, 
                 AOPS_ACCOUNT, 
                 ADDRESS1, 
                 ADDRESS2, 
                 CITY, 
                 STATE, 
                 ZIP, 
                 CREATION_DATE, 
                 REQUEST_ID, 
                 DIRECT_BILL_FLAG,
                 COUNTRY, 
                 ACCOUNT_NUMBER,
                 INVOICE_DATE
           FROM  xx_ar_self_serv_bad_addr
          WHERE  DIRECT_BILL_FLAG  = 'N'
            AND  TRUNC(CREATION_DATE)     >= TRUNC(NVL(fnd_conc_date.string_to_date(:P_AS_OF_DATE),CREATION_DATE))
            AND  :P_TYPE           = 'ADDRESS'
            ORDER BY Creation_date desc,AOPS_ACCOUNT
         ]]>
    </sqlStatement>
  </dataQuery>
    <dataStructure>
    <group name = "G_PARAMS" source = "Q_PARAMS">
      <element name = "REQ_TYPE"           value = "REQ_TYPE"/>
      <element name = "AS_OF_DATE"         value = "AS_OF_DATE"/>
      <element name = "MAIL_TO"            value = "MAIL_TO"/>
	  <element name="SMTP_SERVER"          value="SMTP_SERVER"/>
	  <element name="FROM_EMAIL"           value="FROM_EMAIL"/>
      <group name="Q_BAD_ADDRESS" source="Q_BAD_ADDRESS">
        <element name = "CUSTOMER_NAME"    value = "CUSTOMER_NAME" />
        <element name = "AOPS_ACCOUNT"     value = "AOPS_ACCOUNT" />
        <element name = "ADDRESS1"         value = "ADDRESS1" />
        <element name = "ADDRESS2"         value = "ADDRESS2" />
        <element name = "CITY"             value = "CITY" />
        <element name = "STATE"            value = "STATE" />
        <element name = "ZIP"              value = "ZIP" />
        <element name = "COUNTRY"          value = "COUNTRY" />
        <element name = "INVOICE_DATE"     value = "INVOICE_DATE" />
        <element name = "ACCOUNT_NUMBER"   value = "ACCOUNT_NUMBER" />
        <element name = "CREATION_DATE"   value = "CREATION_DATE" />
      </group>
    </group>
    </dataStructure>
  <dataTrigger name="afterReportTrigger" source="xx_ar_self_service.afterreport"/>
</dataTemplate>
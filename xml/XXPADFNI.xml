<?xml version="1.0" encoding="WINDOWS-1252" ?>
<dataTemplate name="XXPADFNI" description="OD Projects Delay Financial Impact Report" Version="1.0">
<parameters>
 <parameter name="p_division" datatype="character" />
 <parameter name="p_dept" datatype="character" />
 <parameter name="p_di_merchant" datatype="character" />
 <parameter name="p_delay_days" datatype="number" />
 <parameter name="p_year" datatype="number" />
</parameters>
<dataQuery>
<sqlStatement name="DFNI">
<![CDATA[
SELECT  
        PPA1.PROJECT_ID  AS PROJECT_ID
       ,COALESCE(EEB1.C_EXT_ATTR5,'') AS DIVISION
       ,COALESCE(EEB1.C_EXT_ATTR1,'') AS DEPARTMENT 
       ,COALESCE(EEB1.C_EXT_ATTR6,'') AS DI_MERCHANT
       ,COALESCE(EEB1.C_EXT_ATTR7,'') AS DOMESTIC_MERCHANT
       ,EEB3.C_EXT_ATTR1 tracker_type
       ,PPA1.SEGMENT1 AS PROJECT_NUMBER 
       ,PPA1.NAME  AS PROJECT_NAME
       ,PPS1.PROJECT_STATUS_NAME  AS PROJECT_STATUS 
	 ,APPS.XX_PA_XXPAPRJI_PKG.get_proj_progress_status(EEB1.C_EXT_ATTR4) AS PROJECT_PROGRESS_STATUS 
       ,'TBD' AS STATUS_BY_SYSTEM
       ,NVL(EEB1.D_EXT_ATTR2,EEB1.D_EXT_ATTR1)-EEB1.D_EXT_ATTR1 Delay_days 
       ,EEB1.D_EXT_ATTR1 AS INIT_LAUNCH_DATE
       ,EEB1.D_EXT_ATTR2 AS REV_LAUNCH_DATE
       ,COALESCE(EEB2.C_EXT_ATTR4,'') AS SUPPLIER   
       ,COALESCE(EEB1.N_EXT_ATTR1,0) AS SKU_NUM
       ,APPS.XX_PA_XXPAPRJI_PKG.get_orig_forecast(PPA1.PROJECT_ID) Init_fcst
	 ,APPS.XX_PA_XXPAPRJI_PKG.get_rev_forecast(PPA1.PROJECT_ID) rev_fcst
	 ,(APPS.XX_PA_XXPAPRJI_PKG.get_rev_forecast(PPA1.PROJECT_ID)-APPS.XX_PA_XXPAPRJI_PKG.get_orig_forecast(PPA1.PROJECT_ID)) 
        dollar_impact
      FROM apps.PA_PROJECT_STATUSES PPS1,
           apps.PA_PROJECTS_ALL PPA1 LEFT OUTER JOIN 
              ( apps.PA_PROJECTS_ERP_EXT_B EEB1 JOIN 
                 apps.EGO_FND_DSC_FLX_CTX_EXT FND1 ON 
                 EEB1.ATTR_GROUP_ID = FND1.ATTR_GROUP_ID AND
                 FND1.DESCRIPTIVE_FLEX_CONTEXT_CODE = 'PB_GEN_INFO') ON
                 PPA1.PROJECT_ID = EEB1.PROJECT_ID,
           apps.PA_PROJECTS_ALL PPA2 LEFT OUTER JOIN 
              ( apps.PA_PROJECTS_ERP_EXT_B EEB2 JOIN 
                 apps.EGO_FND_DSC_FLX_CTX_EXT FND2 ON 
                 EEB2.ATTR_GROUP_ID = FND2.ATTR_GROUP_ID AND
                 FND2.DESCRIPTIVE_FLEX_CONTEXT_CODE = 'PB_SOURCING') ON
                 PPA2.PROJECT_ID = EEB2.PROJECT_ID,     
           apps.PA_PROJECTS_ALL PPA3 LEFT OUTER JOIN 
              ( apps.PA_PROJECTS_ERP_EXT_B EEB3 JOIN 
                 apps.EGO_FND_DSC_FLX_CTX_EXT FND3 ON 
                 EEB3.ATTR_GROUP_ID = FND3.ATTR_GROUP_ID AND
                 FND3.DESCRIPTIVE_FLEX_CONTEXT_CODE = 'RPB_TRACKER') ON
                 PPA3.PROJECT_ID = EEB3.PROJECT_ID
       WHERE PPA1.PROJECT_ID > 0
         AND PPA1.TEMPLATE_FLAG = 'N'
         AND PPA1.PROJECT_STATUS_CODE = PPS1.PROJECT_STATUS_CODE
         AND PPA1.SEGMENT1 LIKE 'PB%' 
         AND PPA1.PROJECT_ID = PPA2.PROJECT_ID
         AND PPA1.PROJECT_ID = PPA3.PROJECT_ID
         AND NVL(EEB1.C_EXT_ATTR5,'X')=NVL(:p_division,NVL(EEB1.C_EXT_ATTR5,'X'))
         AND NVL(EEB1.C_EXT_ATTR1,'X')=NVL(:p_dept,NVL(EEB1.C_EXT_ATTR1,'X'))
         AND NVL(EEB1.C_EXT_ATTR6,'X')=NVL(:p_di_merchant,NVL(EEB1.C_EXT_ATTR6,'X'))
  	   AND TRUNC(EEB1.D_EXT_ATTR2)- TRUNC(EEB1.D_EXT_ATTR1) BETWEEN 1 AND :p_delay_days
	   AND TO_NUMBER(TO_CHAR(NVL(EEB1.D_EXT_ATTR2,EEB1.D_EXT_ATTR1),'YYYY'))=NVL(:p_year,TO_NUMBER(TO_CHAR(NVL(EEB1.D_EXT_ATTR2,EEB1.D_EXT_ATTR1),'YYYY')))
ORDER BY 1
]]>
</sqlStatement>
<sqlStatement name="Q_TOTAL">
<![CDATA[
SELECT  
  SUM(NVL(EEB1.N_EXT_ATTR1,0)) AS TNO_of_skus
 ,SUM(APPS.XX_PA_XXPAPRJI_PKG.get_orig_forecast(PPA1.PROJECT_ID)) TInit_fcst
 ,SUM(APPS.XX_PA_XXPAPRJI_PKG.get_rev_forecast(PPA1.PROJECT_ID)) Trev_fcst
 ,SUM((APPS.XX_PA_XXPAPRJI_PKG.get_rev_forecast(PPA1.PROJECT_ID)-APPS.XX_PA_XXPAPRJI_PKG.get_orig_forecast(PPA1.PROJECT_ID))) 
        Tdollar_impact
  FROM apps.PA_PROJECT_STATUSES PPS1,
       apps.PA_PROJECTS_ALL PPA1 LEFT OUTER JOIN 
              ( apps.PA_PROJECTS_ERP_EXT_B EEB1 JOIN 
                 apps.EGO_FND_DSC_FLX_CTX_EXT FND1 ON 
                 EEB1.ATTR_GROUP_ID = FND1.ATTR_GROUP_ID AND
                 FND1.DESCRIPTIVE_FLEX_CONTEXT_CODE = 'PB_GEN_INFO') ON
                 PPA1.PROJECT_ID = EEB1.PROJECT_ID,
       apps.PA_PROJECTS_ALL PPA2 LEFT OUTER JOIN 
              ( apps.PA_PROJECTS_ERP_EXT_B EEB2 JOIN 
                 apps.EGO_FND_DSC_FLX_CTX_EXT FND2 ON 
                 EEB2.ATTR_GROUP_ID = FND2.ATTR_GROUP_ID AND
                 FND2.DESCRIPTIVE_FLEX_CONTEXT_CODE = 'PB_SOURCING') ON
                 PPA2.PROJECT_ID = EEB2.PROJECT_ID,     
       apps.PA_PROJECTS_ALL PPA3 LEFT OUTER JOIN 
              ( apps.PA_PROJECTS_ERP_EXT_B EEB3 JOIN 
                 apps.EGO_FND_DSC_FLX_CTX_EXT FND3 ON 
                 EEB3.ATTR_GROUP_ID = FND3.ATTR_GROUP_ID AND
                 FND3.DESCRIPTIVE_FLEX_CONTEXT_CODE = 'RPB_TRACKER') ON
                 PPA3.PROJECT_ID = EEB3.PROJECT_ID
WHERE PPA1.PROJECT_ID > 0
  AND PPA1.TEMPLATE_FLAG = 'N'
  AND PPA1.PROJECT_STATUS_CODE = PPS1.PROJECT_STATUS_CODE
  AND PPA1.SEGMENT1 LIKE 'PB%' 
  AND PPA1.PROJECT_ID = PPA2.PROJECT_ID
  AND PPA1.PROJECT_ID = PPA3.PROJECT_ID
  AND NVL(EEB1.C_EXT_ATTR5,'X')=NVL(:p_division,NVL(EEB1.C_EXT_ATTR5,'X'))
  AND NVL(EEB1.C_EXT_ATTR1,'X')=NVL(:p_dept,NVL(EEB1.C_EXT_ATTR1,'X'))
  AND NVL(EEB1.C_EXT_ATTR6,'X')=NVL(:p_di_merchant,NVL(EEB1.C_EXT_ATTR6,'X'))
  AND TRUNC(EEB1.D_EXT_ATTR2)- TRUNC(EEB1.D_EXT_ATTR1) BETWEEN 1 AND :p_delay_days
  AND TO_NUMBER(TO_CHAR(NVL(EEB1.D_EXT_ATTR2,EEB1.D_EXT_ATTR1),'YYYY'))=NVL(:p_year,TO_NUMBER(TO_CHAR(NVL(EEB1.D_EXT_ATTR2,EEB1.D_EXT_ATTR1),'YYYY')))
]]>
</sqlStatement>
</dataQuery>
<dataStructure>
<group name="G_DFNI" source="DFNI">
<element name="DIVISION" value="DIVISION" />
<element name="DEPARTMENT" value="DEPARTMENT" />
<element name="DI_MERCHANT_NAME" value="DI_MERCHANT" />
<element name="DOMESTIC_MERCHANT_NAME" value="DOMESTIC_MERCHANT" />
<element name="TRACKER_TYPE" value="TRACKER_TYPE" />
<element name="PROJECT_NO" value="PROJECT_NUMBER" />
<element name="PROJECT_NAME" value="PROJECT_NAME" />
<element name="PROJECT_STATUS" value="PROJECT_STATUS" />
<element name="PROJECT_PROGRESS_STATUS" value="PROJECT_PROGRESS_STATUS" />
<element name="SYSTEM_STATUS" value="STATUS_BY_SYSTEM" />
<element name="DELAY_DAYS" value="DELAY_DAYS" />
<element name="INIT_LAUNCH_DATE" value="INIT_LAUNCH_DATE" />
<element name="REV_LAUNCH_DATE" value="REV_LAUNCH_DATE" />
<element name="SUPPLIER" value="SUPPLIER" />
<element name="SKU_NUM" value="SKU_NUM" />
<element name="INIT_FCST" value="INIT_FCST" />
<element name="REV_FCST" value="REV_FCST" />
<element name="DOLLAR_IMPACT" value="DOLLAR_IMPACT" />
</group>
<group name="G_TOTAL" source="Q_TOTAL">
<element name="TNO_OF_SKUS" value="TNO_OF_SKUS" />
<element name="TINIT_FCST" value="TINIT_FCST" />
<element name="TREV_FCST" value="TREV_FCST" />
<element name="TDOLLAR_IMPACT" value="TDOLLAR_IMPACT" />
</group>
</dataStructure>
</dataTemplate>

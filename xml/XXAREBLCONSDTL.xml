<?xml version="1.0" encoding="WINDOWS-1252"?>
<dataTemplate name="XXAREBLCONS" description="OD: AR EBL Consolidated ePDF Render Child - Detail" defaultPackage="XX_AR_EBL_CONS_ePDF_PKG" Version="1.0">
  <properties>
    <property name="scalable_mode" value="on"/>
    <property name="rtf-output-default-font">Arial:8</property>
  </properties>
  <parameters>
    <!-- <parameter name = "P_SUMM_BILL_NUM"      datatype = "character"/>
 <parameter name = "P_SUMM_BILL_NUM_TO"   datatype = "character"/>
 <parameter name = "P_CUST_ACCOUNT_ID"    datatype = "number"/>
 <parameter name = "P_MBS_DOCUMENT_ID"    datatype = "number"/>
 <parameter name = "P_MBS_EXTENSION_ID"   datatype = "number"/>
 <parameter name = "P_SPL_HANDLING_FLAG"  datatype = "character"/>
 <parameter name = "P_REQUEST_ID"         datatype = "number"/>
 <parameter name = "P_ORIGIN"             datatype = "character"/>
 <parameter name = "P_DOC_DETAIL"         datatype = "character"/>
 <parameter name = "P_AS_OF_DATE1"        datatype = "character"/>
 <parameter name = "P_SEND_TO"            datatype = "character"/>
 <parameter name = "P_CUST_DOC_ID"        dataType = "number"/>
 <parameter name = "P_INFOCOPY_FLAG"      dataType = "character"/>
 <parameter name = "P_VIRTUAL_BILL_FLAG"  dataType = "character"/>
 <parameter name = "P_VIRTUAL_BILL_NUM"   dataType = "character"/>
 <parameter name = "P_MULTIPLE_BILL"      dataType = "character"/>
 <parameter name = "P_DATE_FROM"          dataType = "character"/>
 <parameter name = "P_DATE_TO"            dataType = "character"/>
 <parameter name = "P_EMAIL_OPTION"       dataType = "character"/>
 <parameter name = "P_EMAIL_ADDRESS"      dataType = "character"/>
 <parameter name = "DataTemplateCode"     dataType = "character"/>-->
    <parameter name = "P_CONC_NAME"          dataType = "character"/>
    <parameter name = "P_APPL_NAME"          dataType = "character"/>
    <parameter name = "P_BATCH_ID"           dataType = "number"/>
    <parameter name = "P_CM_TEXT1"           datatype = "character"/>
    <parameter name = "P_CM_TEXT2"           datatype = "character"/>
    <parameter name = "P_GIFT_CARD_TEXT1"    dataType = "character"/>
    <parameter name = "P_GIFT_CARD_TEXT2"    dataType = "character"/>
    <parameter name = "P_GIFT_CARD_TEXT3"    dataType = "character"/>
  </parameters>
  <dataQuery>
    <sqlStatement name="Q_FILE_ID">
      <![CDATA[
         SELECT DISTINCT XAECHM.file_id                         file_id
               ,SUBSTR( file_name
                       ,1,INSTR(XAECHM.file_name,'.PDF',1)-1
                       )||'_'||XAECHM.file_id||'.PDF'           file_name
         FROM   xx_ar_ebl_cons_hdr_main      XAECHM
         WHERE  XAECHM.batch_id              = :p_batch_id
      ]]>
    </sqlStatement>
    <sqlStatement name="Q_BILL_TO_SITES">
       <![CDATA[
          SELECT  DISTINCT XAECTS.bill_to_address                                                   bill_to
                 ,XAECHM.mail_to_attention                                                          mail_to_attention
                 ,XAECTS.remit_to_address                                                           remit_to
                 ,XX_AR_EBL_CONS_ePDF_PKG.RETURN_ADDRESS()                                          return_address
                 ,NVL(XAECHM.us_federal_id,XAECHM.canadian_tax_number)                              tax_id
                 ,DECODE ( XAECHM.invoice_currency_code
                          ,'USD', 'FEDERAL ID #:'
                          ,'CAD', 'GST REGISTRATION #:'
                          )                                                                         tax_id_desc
                 ,XAECHM.oracle_account_number                                                      billing_id
                 ,XAECHM.aops_account_number                                                        account_number
                 ,XAECHM.bill_to_name                                                               customer_name
                 ,XAECHM.account_contact                                                            account_contact
                 ,XAECHM.order_contact                                                              order_contact
                 ,XAECHM.bill_to_country                                                            bill_to_country
                 ,XAECHM.bill_to_zip                                                                bill_to_postal_code
                 ,XAECHM.mbs_doc_id                                                                 doc_id
                 ,XAECHM.invoice_currency_code                                                      currency_code
                 ,SUBSTR(XAECHM.payment_term_description ,1 ,15)                                    terms
                 ,XAECHM.cust_account_id                                                            cust_account_id
                 ,XAECHM.bill_to_site_use_id                                                        bill_to_id
                 ,XAECHM.parent_cust_doc_id                                                         parent_cust_doc_id
          FROM     xx_ar_ebl_cons_trx_stg       XAECTS
                  ,xx_ar_ebl_cons_hdr_main      XAECHM
          WHERE   XAECTS.request_id                   = XAECHM.batch_id
          AND     XAECHM.batch_id                     = :p_batch_id
          AND     XAECTS.inv_type                     NOT IN ('SOFTHDR_TOTALS' ,'BILLTO_TOTALS' ,'GRAND_TOTAL')
          AND     XAECTS.bill_to_site_use_id          = XAECHM.bill_to_site_use_id
          AND     XAECHM.file_id                      = :file_id
          AND     XAECHM.cust_doc_id                  = XAECTS.cust_doc_id
          AND     XAECHM.customer_trx_id              = XAECTS.customer_trx_id
          AND     XAECHM.cons_inv_id                  = XAECTS.cons_inv_id
       ]]>
    </sqlStatement>
    <sqlStatement name="Q_CONSOLIDATED_BILLS">
       <![CDATA[
		  with xx_disc_info AS (																			--Added for defect 37807
		  SELECT 	MAX(XAECTS.customer_trx_id) customer_trx_id, XAECTS.cons_inv_id
		  	FROM     xx_ar_ebl_cons_trx_stg       XAECTS
					,xx_ar_ebl_cons_hdr_main      XAECHM
					,ra_customer_trx			  RCT
		  		WHERE    XAECTS.request_id                   = XAECHM.batch_id
		  		AND      XAECHM.batch_id                     = :p_batch_id
		  		AND      XAECTS.inv_type                     = 'Invoice'
		  		AND      XAECTS.bill_to_site_use_id          = XAECHM.bill_to_site_use_id
		  		AND      XAECHM.bill_to_site_use_id          = :bill_to_id
		  		AND      XAECHM.parent_cust_doc_id           = :parent_cust_doc_id
		  		AND      XAECHM.cust_doc_id                  = XAECTS.cust_doc_id
		  		AND      XAECHM.customer_trx_id              = XAECTS.customer_trx_id
		  		AND      XAECHM.cons_inv_id                  = XAECTS.cons_inv_id
		  		AND      XAECHM.file_id                      = :file_id
				AND		 XAECTS.customer_trx_id				 = RCT.customer_trx_id
				AND		 RCT.billing_date					 = (SELECT 	MAX(RCT1.billing_date)
																 FROM     xx_ar_ebl_cons_trx_stg       XAECTS1
																		 ,xx_ar_ebl_cons_hdr_main      XAECHM1
																		 ,ra_customer_trx			   RCT1
																 WHERE    XAECTS1.request_id                   = XAECHM1.batch_id
																 AND      XAECHM1.batch_id                     = :p_batch_id
																 AND      XAECTS1.inv_type                     = 'Invoice'
																 AND      XAECTS1.bill_to_site_use_id          = XAECHM1.bill_to_site_use_id
																 AND      XAECHM1.bill_to_site_use_id          = :bill_to_id
																 AND      XAECHM1.parent_cust_doc_id           = :parent_cust_doc_id
																 AND      XAECHM1.cust_doc_id                  = XAECTS1.cust_doc_id
																 AND      XAECHM1.customer_trx_id              = XAECTS1.customer_trx_id
																 AND      XAECHM1.cons_inv_id                  = XAECTS1.cons_inv_id
																 AND      XAECHM1.file_id                      = :file_id
																 AND	  XAECTS1.customer_trx_id			   = RCT1.customer_trx_id)
				group by XAECTS.cons_inv_id
		  )
          SELECT   XAECTS.cons_inv_id                                         cbi_id
                  ,XAECHM.consolidated_bill_number                            billing_number
                  ,:currency_code                                             currency
                  ,TO_CHAR(XAECHM.bill_from_date,'MM/DD/YYYY')                bill_from_date
                  ,TO_CHAR(XAECHM.bill_to_date,'MM/DD/YYYY')                  bill_to_date
                  ,DECODE( XAECHM.document_type
                          ,'Paydoc',TO_CHAR(XAECHM.bill_due_date,'MM/DD/YYYY')
                          )                                                   payment_due
                  ,:terms                                                     terms
                  ,SUM(XAECHM.sku_lines_subtotal
                       + XAECHM.total_coupon_amount
                       + XAECHM.total_bulk_amount
                       + XAECHM.total_freight_amount
                       )                                                      cbi_extamt_plus_delvy
                  ,SUM(XAECHM.total_miscellaneous_amount
                       + XAECHM.total_association_discount
                       + XAECHM.total_tiered_discount_amount
                       - XAECHM.total_gift_card_amount
                       )                                                       cbi_discounts
                  ,SUM(XAECHM.total_us_tax_amount
                       + XAECHM.total_gst_amount
                       + XAECHM.total_pst_amount
                       + XAECHM.total_qst_amount
                       )                                                       cbi_tax
			      ,MAX( NVL(( SELECT SUM(XX_AR_EBL_COMMON_UTIL_PKG.get_line_fee_amount(xx.customer_trx_id) +
				                   XX_AR_EBL_COMMON_UTIL_PKG.get_hea_fee_amount(xx.customer_trx_id))
                          FROM xx_ar_ebl_cons_hdr_main xx
						 WHERE cons_inv_id = XAECHM.cons_inv_id
						   AND cust_doc_id = XAECHM.cust_doc_id
						   AND batch_id    = :p_batch_id
						   AND file_id     = :file_id),0) )           cbi_fee_amt
                  ,SUM(XAECHM.original_invoice_amount
                       - XAECHM.total_gift_card_amount
                       )                                                       cbi_amount_due
                  ,SUM(XAECHM.original_invoice_amount
                       - XAECHM.total_gift_card_amount) *100                    total_amount
                  ,DECODE( XAECHM.document_type
                          ,'Infocopy','**DO NOT PAY**'
                          ,'Paydoc',DECODE(SIGN(SUM(XAECHM.original_invoice_amount - XAECHM.total_gift_card_amount)
                                           )
                                      ,1,'**BAL DUE**'
                                      ,'**DO NOT PAY**'
                                      )
                          )                                                    no_payment_text
                  ,DECODE( XAECHM.document_type
                          ,'Infocopy','Informational Copy of Consolidated Bill'
                          ,'Paydoc','Original Consolidated Bill'
                          )                                                    doc_title
                  ,XAECTS.cust_doc_id                                          cust_doc_id
                  ,XAECHM.document_type                                        document_type
				  --,DECODE(XAECHM.document_type,'Paydoc',xx_ar_ebl_common_util_pkg.get_header_discount(XAECHM.customer_trx_id),NULL) discount_info   -- Added for Defect 36437	--Commented for defect #37640
				  --,NULL														DISCOUNT_INFO 		--Added for Defect 37640       --Commented for Defect 37807
				  ,DECODE(XAECHM.document_type,'Paydoc',xx_ar_ebl_common_util_pkg.get_header_discount(xx_disc_info.customer_trx_id),NULL) DISCOUNT_INFO     --Added for Defect 37807
                  ,MAX((  SELECT fee_option 
						FROM xx_cdh_cust_acct_ext_b
					   WHERE cust_account_id = XAECHM.cust_account_id
						 AND ATTR_GROUP_ID = 166
						 AND N_EXT_ATTR1 = XAECHM.MBS_DOC_ID
						 AND N_EXT_ATTR2 = XAECHM.CUST_DOC_ID 
						 AND rownum =1)) FEE_OPTION
		  FROM     xx_ar_ebl_cons_trx_stg       XAECTS
                  ,xx_ar_ebl_cons_hdr_main      XAECHM
				  ,xx_disc_info													 		--Added for Defect 37807
          WHERE    XAECTS.request_id                   = XAECHM.batch_id
          AND      XAECHM.batch_id                     = :p_batch_id
          AND      XAECTS.inv_type                     NOT IN ('SOFTHDR_TOTALS' ,'BILLTO_TOTALS' ,'GRAND_TOTAL')
          AND      XAECTS.bill_to_site_use_id          = XAECHM.bill_to_site_use_id
          AND      XAECHM.bill_to_site_use_id          = :bill_to_id
          AND      XAECHM.parent_cust_doc_id           = :parent_cust_doc_id
          AND      XAECHM.cust_doc_id                  = XAECTS.cust_doc_id
          AND      XAECHM.customer_trx_id              = XAECTS.customer_trx_id
          AND      XAECHM.cons_inv_id                  = XAECTS.cons_inv_id
		  AND	   XAECHM.cons_inv_id				   = xx_disc_info.cons_inv_id(+)		--Added for Defect 37807
          AND      XAECHM.file_id                      = :file_id
          GROUP BY XAECTS.cons_inv_id
                  ,XAECHM.consolidated_bill_number
                  ,:currency_code
                  ,XAECHM.bill_from_date
                  ,XAECHM.bill_to_date
                  ,DECODE( XAECHM.document_type
                          ,'Paydoc',TO_CHAR(XAECHM.bill_due_date,'MM/DD/YYYY')
                          )
                  ,XAECHM.document_type
                  ,:terms
                  ,DECODE( XAECHM.document_type
                          ,'Infocopy','Informational Copy of Consolidated Bill'
                          ,'Paydoc','Original Consolidated Bill'
                          )
                  ,XAECTS.cust_doc_id
                  ,XAECHM.document_type
				  --,DECODE(XAECHM.document_type,'Paydoc',xx_ar_ebl_common_util_pkg.get_header_discount(XAECHM.customer_trx_id),NULL)   -- Added for Defect 36437	--Commented for defect #37640
				  ,DECODE(XAECHM.document_type,'Paydoc',xx_ar_ebl_common_util_pkg.get_header_discount(xx_disc_info.customer_trx_id),NULL)     -- Added for Defect 37807
          ORDER BY XAECTS.cons_inv_id
       ]]>
    </sqlStatement>
    <sqlStatement name="Q_SCAN_LINE">
       <![CDATA[
          SELECT xx_ar_ebl_common_util_pkg.xx_fin_check_digit( :account_number
                                                              ,:cbi_id
                                                              ,:total_amount
                                                              ) scan_line
          FROM   dual
          WHERE  :document_type  = 'Paydoc'
       ]]>
    </sqlStatement>
    <sqlStatement name="Q_INVOICE">
       <![CDATA[
	SELECT DISTINCT XAECTS.customer_trx_id               trx_id
                ,XAECTS.inv_number                          order_no
                ,TO_CHAR(XAECTS.order_date ,'MM/DD/YYYY')   order_dt
                ,TO_CHAR(XAECTS.ship_date ,'MM/DD/YYYY')    ship_dt
                ,TRIM(XAECTS.sfhdr1)                        sfhdr1
                ,TRIM(XAECTS.sfhdr2)                        sfhdr2
                ,TRIM(XAECTS.sfhdr3)                        sfhdr3
                ,TRIM(XAECTS.sfhdr4)                        sfhdr4
                ,TRIM(XAECTS.sfhdr5)                        sfhdr5
                ,'ORDERED BY:'                              sfhdr6
                ,'SHIP TO:'                                 sfhdr7
                ,TRIM(XAECTS.sfdata1)                       sfdata1
                ,TRIM(XAECTS.sfdata2)                       sfdata2
                ,TRIM(XAECTS.sfdata3)                       sfdata3
                ,TRIM(XAECTS.sfdata4)                       sfdata4
                ,TRIM(XAECTS.sfdata5)                       sfdata5
                ,TRIM(XAECHM.ordered_by)                    sfdata6
                ,trim(XAECHM.ship_to_address1||DECODE(trim(XAECHM.ship_to_address2),'','',', '||trim(XAECHM.ship_to_address2))||DECODE(trim(XAECHM.ship_to_address3),'','',', '||trim(XAECHM.ship_to_address3))||DECODE(trim(XAECHM.ship_to_address4),'','',', '||trim(XAECHM.ship_to_address4))||DECODE(trim(XAECHM.ship_to_city),'','',', '||trim(XAECHM.ship_to_city))||DECODE(trim(XAECHM.ship_to_state),'','',', '||trim(XAECHM.ship_to_state))||DECODE(trim(XAECHM.ship_to_zip),'','',' '||trim(XAECHM.ship_to_zip))	
              ) sfdata7
			  ,XAECTS.insert_seq
			  ,DECODE(XAECTS.inv_type,'Credit Memo',DECODE((SELECT '1' 
                                                                  FROM xx_om_line_attributes_all a,
                                                                       oe_order_lines_all b
                                                                 WHERE a.line_id = b.line_id
                                                                   AND b.header_id = XAECHM.order_header_id
                                                                   AND a.return_act_cat_code IN (SELECT  source_value1
                                                                                                  FROM  xx_fin_translatevalues xftv
                                                                                                       ,xx_fin_translatedefinition xftd
                                                                                                 WHERE xftv.translate_id = xftd.translate_id
                                                                                                   AND xftd.translation_name = 'XX_AR_REBATE_CODE'
                                                                                                   AND SYSDATE BETWEEN xftv.start_date_active AND NVL (xftv.end_date_active, SYSDATE + 1)
                                                                                                   AND SYSDATE BETWEEN xftd.start_date_active AND NVL (xftd.end_date_active, SYSDATE + 1)
                                                                                                   AND xftv.enabled_flag = 'Y'
                                                                                                   AND xftd.enabled_flag = 'Y')
                                                                   AND ROWNUM < 2),'1',XAECHM.ORDER_LEVEL_COMMENT,NULL),NULL)  REBATE_INFO   -- Added for Defect 36437
          FROM   xx_ar_ebl_cons_trx_stg       XAECTS
                  ,xx_ar_ebl_cons_hdr_main    XAECHM
          WHERE  XAECTS.request_id                   = :p_batch_id
          AND    XAECTS.cons_inv_id                  = :cbi_id
          AND    XAECTS.cust_doc_id                  = :cust_doc_id
          AND    XAECTS.bill_to_site_use_id          = :bill_to_id
	   AND	   XAECTS.request_id                   = XAECHM.batch_id
          AND    XAECTS.inv_type            NOT IN ('SOFTHDR_TOTALS' ,'BILLTO_TOTALS' ,'GRAND_TOTAL')
		  AND    XAECTS.request_id                   = XAECHM.batch_id(+) 
          AND    XAECTS.bill_to_site_use_id          = XAECHM.bill_to_site_use_id(+)
          AND    XAECTS.cust_doc_id                  = XAECHM.cust_doc_id(+)
          AND    XAECTS.customer_trx_id              = XAECHM.customer_trx_id(+)
          AND    XAECTS.cons_inv_id                  = XAECHM.cons_inv_id(+)
          ORDER BY XAECTS.insert_seq, XAECTS.inv_number
       ]]>
    </sqlStatement>
    <sqlStatement name="Q_INV_STATEMENT">
       <![CDATA[
          SELECT *
          FROM ( SELECT 1                                       view_seq
                       ,'Order# '||XAECTS.inv_number            sf_text1
                       ,'SUB-TOTAL'                             sf_text2
                       ,NVL(XAECTS.subtotal_amount ,0)          sf_amount
                       ,XAECTS.insert_seq                       insert_seq
                       ,TO_CHAR(NULL)                           pg_break
                       , 'N'                                    show_line
                 FROM   xx_ar_ebl_cons_trx_stg XAECTS
                 WHERE  XAECTS.request_id                = :p_batch_id
                 AND    XAECTS.cons_inv_id               = :cbi_id
                 AND    XAECTS.customer_trx_id           = :trx_id
                 AND    XAECTS.bill_to_site_use_id       = :bill_to_id
                 AND    XAECTS.cust_doc_id               = :cust_doc_id
                 AND    XAECTS.inv_type                  NOT IN ('SOFTHDR_TOTALS' ,'BILLTO_TOTALS' ,'GRAND_TOTAL')
                 UNION ALL
                 SELECT 2                                       view_seq
                       ,TO_CHAR(NULL)                           sf_text1
                       ,'PROMOTIONS AND DISCOUNTS'              sf_text2
                       ,NVL(XAECTS.promo_and_disc ,0)           sf_amount
                       ,XAECTS.insert_seq                       insert_seq
                       ,TO_CHAR(NULL)                           pg_break
                       , 'N'                                    show_line
                 FROM   xx_ar_ebl_cons_trx_stg XAECTS
                 WHERE  XAECTS.request_id                = :p_batch_id
                 AND    XAECTS.cons_inv_id               = :cbi_id
                 AND    XAECTS.customer_trx_id           = :trx_id
                 AND    XAECTS.bill_to_site_use_id       = :bill_to_id
                 AND    XAECTS.cust_doc_id               = :cust_doc_id
                 AND    XAECTS.promo_and_disc            <>0
                 AND    XAECTS.inv_type                  NOT IN ('SOFTHDR_TOTALS' ,'BILLTO_TOTALS' ,'GRAND_TOTAL')
                 UNION ALL
                 SELECT 3                                       view_seq
                       ,TO_CHAR(NULL)                           sf_text1
                       ,'SALES TAX'                             sf_text2
                       ,NVL(XAECTS.tax_amount ,0)               sf_amount
                       ,XAECTS.insert_seq                       insert_seq
                       ,TO_CHAR(NULL)                           pg_break
					  , 'N'									   show_line
                 FROM   xx_ar_ebl_cons_trx_stg XAECTS
                 WHERE  XAECTS.request_id                = :p_batch_id
                 AND    XAECTS.cons_inv_id               = :cbi_id
                 AND    XAECTS.customer_trx_id           = :trx_id
                 AND    XAECTS.bill_to_site_use_id       = :bill_to_id
                 AND    XAECTS.cust_doc_id               = :cust_doc_id
                 AND    xx_fin_country_defaults_pkg.f_org_id('US')
                                                         = FND_PROFILE.VALUE('ORG_ID')
                 AND    XAECTS.inv_type                  NOT IN ('SOFTHDR_TOTALS' ,'BILLTO_TOTALS' ,'GRAND_TOTAL')
                 UNION ALL
                 SELECT 4                                       view_seq
                       ,TO_CHAR(NULL)                           sf_text1
                       ,'TAX - PST'                             sf_text2
                       ,NVL(XAECTS.cad_county_tax_amount ,0)    sf_amount
                       ,XAECTS.insert_seq                       insert_seq
                       ,TO_CHAR(NULL)                           pg_break
					  , 'N'									   show_line
                FROM   xx_ar_ebl_cons_trx_stg XAECTS
                WHERE  XAECTS.request_id               = :p_batch_id
                AND    XAECTS.cons_inv_id              = :cbi_id
                AND    XAECTS.customer_trx_id          = :trx_id
                AND    XAECTS.bill_to_site_use_id      = :bill_to_id
                AND    XAECTS.cust_doc_id              = :cust_doc_id
                AND    xx_fin_country_defaults_pkg.f_org_id('CA')
                                                       = FND_PROFILE.VALUE('ORG_ID')
                AND    XAECTS.inv_type                 NOT IN ('SOFTHDR_TOTALS' ,'BILLTO_TOTALS' ,'GRAND_TOTAL')
                UNION ALL
                SELECT 5                                       view_seq
                      ,TO_CHAR(NULL)                           sf_text1
                      ,'TAX - GST / HST'                       sf_text2
                      ,NVL(XAECTS.cad_state_tax_amount ,0)     sf_amount
                      ,XAECTS.insert_seq                       insert_seq
                      ,TO_CHAR(NULL)                           pg_break
					  , 'N'									   show_line
                FROM   xx_ar_ebl_cons_trx_stg XAECTS
                WHERE  XAECTS.request_id               = :p_batch_id
                AND    XAECTS.cons_inv_id              = :cbi_id
                AND    XAECTS.customer_trx_id          = :trx_id
                AND    XAECTS.bill_to_site_use_id      = :bill_to_id
                AND    XAECTS.cust_doc_id              = :cust_doc_id
                AND    xx_fin_country_defaults_pkg.f_org_id('CA')
                                                       = FND_PROFILE.VALUE('ORG_ID')
                AND    XAECTS.inv_type                 NOT IN ('SOFTHDR_TOTALS' ,'BILLTO_TOTALS' ,'GRAND_TOTAL')
                UNION ALL
                SELECT 8                                       view_seq
                      ,XAECTTS.sf_text                         sf_text1
                      ,'SUB-TOTAL'                             sf_text2
                      ,NVL(XAECTTS.sf_amount ,0)               sf_amount
                      ,XAECTTS.line_seq                        insert_seq
                      ,TO_CHAR(NULL)                           pg_break
					  , 'N'									   show_line
                FROM   xx_ar_ebl_cons_trx_total_stg XAECTTS
                WHERE  XAECTTS.request_id              = :p_batch_id
                AND    XAECTTS.cons_inv_id             = :cbi_id
                AND    XAECTTS.customer_trx_id         = :trx_id
                AND    XAECTTS.bill_to_site_use_id     = :bill_to_id
                AND    XAECTTS.cust_doc_id             = :cust_doc_id
                AND    XAECTTS.line_type               = 'SOFTHDR_SUBTOTAL'
                UNION ALL
                SELECT 9                                       view_seq
                      ,TO_CHAR(NULL)                           sf_text1
                      ,'PROMOTIONS AND DISCOUNTS'              sf_text2
                      ,NVL(XAECTTS.sf_amount ,0)               sf_amount
                      ,XAECTTS.line_seq                        insert_seq
                      ,TO_CHAR(NULL)                           pg_break
					  , 'N'									   show_line
                FROM   xx_ar_ebl_cons_trx_total_stg XAECTTS
                WHERE  XAECTTS.request_id              = :p_batch_id
                AND    XAECTTS.cons_inv_id             = :cbi_id
                AND    XAECTTS.customer_trx_id         = :trx_id
                AND    XAECTTS.sf_amount               <>0
                AND    XAECTTS.bill_to_site_use_id     = :bill_to_id
                AND    XAECTTS.cust_doc_id             = :cust_doc_id
                AND    XAECTTS.line_type               = 'SOFTHDR_DISCOUNTS'
                UNION ALL
                SELECT 10                                      view_seq
                      ,TO_CHAR(NULL)                           sf_text1
                      ,'SALES TAX'                             sf_text2
                      ,NVL(XAECTTS.sf_amount ,0)               sf_amount
                      ,XAECTTS.line_seq                        insert_seq
                      ,TO_CHAR(NULL)                           pg_break
					  , 'N'									   show_line
                FROM   xx_ar_ebl_cons_trx_total_stg XAECTTS
                WHERE  XAECTTS.request_id              = :p_batch_id
                AND    XAECTTS.cons_inv_id             = :cbi_id
                AND    XAECTTS.customer_trx_id         = :trx_id
                AND    XAECTTS.bill_to_site_use_id     = :bill_to_id
                AND    XAECTTS.cust_doc_id             = :cust_doc_id
                AND    xx_fin_country_defaults_pkg.f_org_id('US')
                                                       = FND_PROFILE.VALUE('ORG_ID')
                AND    XAECTTS.line_type               = 'SOFTHDR_TAX'
                UNION ALL
                SELECT 11                                      view_seq
                      ,TO_CHAR(NULL)                           sf_text1
                      ,'TAX - PST'                             sf_text2
                      ,NVL(XAECTTS.sf_amount ,0)               sf_amount
                      ,XAECTTS.line_seq                        insert_seq
                      ,TO_CHAR(NULL)                           pg_break
					  , 'N'									   show_line
                FROM   xx_ar_ebl_cons_trx_total_stg XAECTTS
                WHERE  XAECTTS.request_id              = :p_batch_id
                AND    XAECTTS.cons_inv_id             = :cbi_id
                AND    XAECTTS.customer_trx_id         = :trx_id
                AND    XAECTTS.bill_to_site_use_id     = :bill_to_id
                AND    XAECTTS.cust_doc_id             = :cust_doc_id
                AND    xx_fin_country_defaults_pkg.f_org_id('CA')
                                                       = FND_PROFILE.VALUE('ORG_ID')
                AND    XAECTTS.line_type               = 'SOFTHDR_PROV_TAX'
                UNION ALL
                SELECT 12                                      view_seq
                      ,TO_CHAR(NULL)                           sf_text1
                      ,'TAX - GST / HST'                       sf_text2
                      ,NVL(XAECTTS.sf_amount ,0)               sf_amount
                      ,XAECTTS.line_seq                        insert_seq
                      ,TO_CHAR(NULL)                           pg_break
					  , 'N'									   show_line
                FROM   xx_ar_ebl_cons_trx_total_stg XAECTTS
                WHERE  XAECTTS.request_id              = :p_batch_id
                AND    XAECTTS.cons_inv_id             = :cbi_id
                AND    XAECTTS.customer_trx_id         = :trx_id
                AND    XAECTTS.bill_to_site_use_id     = :bill_to_id
                AND    XAECTTS.cust_doc_id             = :cust_doc_id
                AND    xx_fin_country_defaults_pkg.f_org_id('CA')
                                                       = FND_PROFILE.VALUE('ORG_ID')
                AND    XAECTTS.line_type               = 'SOFTHDR_STATE_TAX'
                UNION ALL
                SELECT 14                                      view_seq
                      ,XAECTTS.sf_text                         sf_text1
                      ,'SUB-TOTAL'                             sf_text2
                      ,NVL(XAECTTS.sf_amount ,0)               sf_amount
                      ,XAECTTS.line_seq                        insert_seq
                      ,TO_CHAR(NULL)                           pg_break
					  , 'N'									   show_line
                FROM   xx_ar_ebl_cons_trx_total_stg XAECTTS
                WHERE  XAECTTS.request_id              = :p_batch_id
                AND    XAECTTS.cons_inv_id             = :cbi_id
                AND    XAECTTS.customer_trx_id         = :trx_id
                AND    XAECTTS.bill_to_site_use_id     = :bill_to_id
                AND    XAECTTS.cust_doc_id             = :cust_doc_id
                AND    XAECTTS.line_type               = 'BILLTO_SUBTOTAL'
                UNION ALL
                SELECT 15                                      view_seq
                      ,TO_CHAR(NULL)                           sf_text1
                      ,'PROMOTIONS AND DISCOUNTS'              sf_text2
                      ,NVL(XAECTTS.sf_amount ,0)               sf_amount
                      ,XAECTTS.line_seq                        insert_seq
                      ,TO_CHAR(NULL)                           pg_break
					  , 'N'									   show_line
                FROM   xx_ar_ebl_cons_trx_total_stg XAECTTS
                WHERE  XAECTTS.request_id              = :p_batch_id
                AND    XAECTTS.cons_inv_id             = :cbi_id
                AND    XAECTTS.customer_trx_id         = :trx_id
                AND    XAECTTS.bill_to_site_use_id     = :bill_to_id
                AND    XAECTTS.cust_doc_id             = :cust_doc_id
                AND    XAECTTS.sf_amount               <> 0
                AND    XAECTTS.line_type               = 'BILLTO_DISCOUNTS'
                UNION ALL
                SELECT 16                                      view_seq
                      ,TO_CHAR(NULL)                           sf_text1
                      ,'SALES TAX'                             sf_text2
                      ,NVL(XAECTTS.sf_amount ,0)               sf_amount
                      ,XAECTTS.line_seq                        insert_seq
                      ,TO_CHAR(NULL)                           pg_break
					  , 'N'									   show_line
                FROM   xx_ar_ebl_cons_trx_total_stg XAECTTS
                WHERE  XAECTTS.request_id              = :p_batch_id
                AND    XAECTTS.cons_inv_id             = :cbi_id
                AND    XAECTTS.customer_trx_id         = :trx_id
                AND    XAECTTS.cust_doc_id             = :cust_doc_id
                AND    XAECTTS.line_type               = 'BILLTO_TAX'
                AND    XAECTTS.bill_to_site_use_id     = :bill_to_id
                AND    xx_fin_country_defaults_pkg.f_org_id('US')
                                                       = FND_PROFILE.VALUE('ORG_ID')
                UNION ALL
                SELECT 17                                      view_seq
                      ,TO_CHAR(NULL)                           sf_text1
                      ,'TAX - PST'                             sf_text2
                      ,NVL(XAECTTS.sf_amount ,0)               sf_amount
                      ,XAECTTS.line_seq                        insert_seq
                      ,TO_CHAR(NULL)                           pg_break
					  , 'N'									   show_line
                FROM   xx_ar_ebl_cons_trx_total_stg XAECTTS
                WHERE  XAECTTS.request_id              = :p_batch_id
                AND    XAECTTS.cons_inv_id             = :cbi_id
                AND    XAECTTS.customer_trx_id         = :trx_id
                AND    XAECTTS.bill_to_site_use_id     = :bill_to_id
                AND    XAECTTS.cust_doc_id             = :cust_doc_id
                AND    xx_fin_country_defaults_pkg.f_org_id('CA')
                                                       = FND_PROFILE.VALUE('ORG_ID')
                AND    XAECTTS.line_type               = 'BILLTO_PROV_TAX'
                UNION ALL
                SELECT 18                                      view_seq
                      ,TO_CHAR(NULL)                           sf_text1
                      ,'TAX - GST / HST'                       sf_text2
                      ,NVL(XAECTTS.sf_amount ,0)               sf_amount
                      ,XAECTTS.line_seq                        insert_seq
                      ,TO_CHAR(NULL)                           pg_break
					  , 'N'									   show_line
                FROM   xx_ar_ebl_cons_trx_total_stg XAECTTS
                WHERE  XAECTTS.request_id              = :p_batch_id
                AND    XAECTTS.cons_inv_id             = :cbi_id
                AND    XAECTTS.customer_trx_id         = :trx_id
                AND    XAECTTS.bill_to_site_use_id     = :bill_to_id
                AND    XAECTTS.cust_doc_id             = :cust_doc_id
                AND    xx_fin_country_defaults_pkg.f_org_id('CA')
                                                       = FND_PROFILE.VALUE('ORG_ID')
                AND    XAECTTS.line_type               = 'BILLTO_STATE_TAX'
                UNION ALL
                SELECT 20                                      view_seq
                      ,REPLACE(sf_text ,'_' ,' ')              sf_text1
                      ,TO_CHAR(NULL)                           sf_text2
                      ,NVL(XAECTTS.sf_amount ,0)               sf_amount
                      ,XAECTTS.line_seq                        insert_seq
                      ,TO_CHAR(NULL)                           pg_break
					  , 'N'									   show_line
                FROM   xx_ar_ebl_cons_trx_total_stg XAECTTS
                WHERE  XAECTTS.request_id              = :p_batch_id
                AND    XAECTTS.cons_inv_id             = :cbi_id
                AND    XAECTTS.customer_trx_id         = :trx_id
                AND    XAECTTS.bill_to_site_use_id     = :bill_to_id
                AND    XAECTTS.cust_doc_id             = :cust_doc_id
                AND    XAECTTS.line_type               = 'GRAND_TOTAL'
				UNION ALL
				SELECT view_seq,
		               sf_text1,
                       sf_text2,
                       sf_amount,
                       insert_seq,
                       pg_break,
		               DECODE (lead(insert_seq,1,0) OVER (PARTITION BY sf_text2 ORDER BY  insert_seq,view_seq ),0,'N','Y') show_line
		        FROM (
		        SELECT 6                                       view_seq
                      ,TO_CHAR(NULL)                           sf_text1
                      ,'TOTAL'                                 sf_text2
                      ,( NVL(XAECTS.subtotal_amount ,0)
                        + NVL(XAECTS.promo_and_disc ,0)
                        + NVL(XAECTS.tax_amount ,0)
                        )                                      sf_amount
                      ,XAECTS.insert_seq                       insert_seq
                      ,TO_CHAR(NULL)                           pg_break
                FROM   xx_ar_ebl_cons_trx_stg XAECTS
                WHERE  XAECTS.request_id               = :p_batch_id
                AND    XAECTS.cons_inv_id              = :cbi_id
                AND    XAECTS.customer_trx_id          = :trx_id
                AND    XAECTS.bill_to_site_use_id      = :bill_to_id
                AND    XAECTS.cust_doc_id              = :cust_doc_id
                AND    xx_fin_country_defaults_pkg.f_org_id('US')
                                                       = FND_PROFILE.VALUE('ORG_ID')
                AND    XAECTS.inv_type                 NOT IN ('SOFTHDR_TOTALS' ,'BILLTO_TOTALS' ,'GRAND_TOTAL')
                UNION ALL
                SELECT 7                                       view_seq
                      ,TO_CHAR(NULL)                           sf_text1
                      ,'TOTAL'                                 sf_text2
                      ,( NVL(XAECTS.subtotal_amount ,0)
                        + NVL(XAECTS.delivery_charges ,0)
                        + NVL(XAECTS.promo_and_disc ,0)
                        + NVL(XAECTS.cad_county_tax_amount ,0)
                        + NVL(XAECTS.cad_state_tax_amount ,0)
                        )                                      sf_amount
                     ,XAECTS.insert_seq                        insert_seq
                     ,TO_CHAR(NULL)                            pg_break
                FROM   xx_ar_ebl_cons_trx_stg XAECTS
                WHERE  XAECTS.request_id               = :p_batch_id
                AND    XAECTS.cons_inv_id              = :cbi_id
                AND    XAECTS.customer_trx_id          = :trx_id
                AND    XAECTS.bill_to_site_use_id      = :bill_to_id
                AND    XAECTS.cust_doc_id              = :cust_doc_id
                AND    xx_fin_country_defaults_pkg.f_org_id('CA')
                                                       = FND_PROFILE.VALUE('ORG_ID')
                AND    XAECTS.inv_type                 NOT IN ('SOFTHDR_TOTALS' ,'BILLTO_TOTALS' ,'GRAND_TOTAL')
		        UNION ALL
                SELECT 13                                      view_seq
                      ,TO_CHAR(NULL)                           sf_text1
                      ,'TOTAL'                                 sf_text2
                      ,NVL(XAECTTS.sf_amount ,0)               sf_amount
                      ,XAECTTS.line_seq                        insert_seq
                      ,nvl(XAECTTS.page_break, 'N')            pg_break
                FROM   xx_ar_ebl_cons_trx_total_stg XAECTTS
                WHERE  XAECTTS.request_id              = :p_batch_id
                AND    XAECTTS.cons_inv_id             = :cbi_id
                AND    XAECTTS.customer_trx_id         = :trx_id
                AND    XAECTTS.bill_to_site_use_id     = :bill_to_id
                AND    XAECTTS.cust_doc_id             = :cust_doc_id
                AND    XAECTTS.line_type               = 'SOFTHDR_TOTAL'
		        UNION ALL
                SELECT 19                                      view_seq
                      ,TO_CHAR(NULL)                           sf_text1
                      ,'TOTAL'                                 sf_text2
                      ,NVL(XAECTTS.sf_amount ,0)               sf_amount
                      ,XAECTTS.line_seq                        insert_seq
                      ,TO_CHAR(NULL)                           pg_break
                FROM   xx_ar_ebl_cons_trx_total_stg XAECTTS
                WHERE  XAECTTS.request_id              = :p_batch_id
                AND    XAECTTS.cons_inv_id             = :cbi_id
                AND    XAECTTS.customer_trx_id         = :trx_id
                AND    XAECTTS.bill_to_site_use_id     = :bill_to_id
                AND    XAECTTS.cust_doc_id             = :cust_doc_id
                AND    XAECTTS.line_type               = 'BILLTO_TOTAL'
		      )
               ) trx_totals
          ORDER BY insert_seq, view_seq
       ]]>
    </sqlStatement>
    <sqlStatement name="Q_SPC">
       <![CDATA[
          SELECT '        '||XAECLS.item_description||'        '                spc_text
          FROM   xx_ar_ebl_cons_lines_stg XAECLS
          WHERE XAECLS.request_id            = :p_batch_id
          AND   XAECLS.cons_inv_id           = :cbi_id
          AND   XAECLS.customer_trx_id       = :trx_id
          AND   XAECLS.bill_to_site_use_id   = :bill_to_id
                  AND   XAECLS.cust_doc_id           = :cust_doc_id
          AND   XAECLS.item_code             = 'SPC_CARD_INFO'
       ]]>
    </sqlStatement>
    <sqlStatement name="Q_DETAIL">
       <![CDATA[
		  SELECT item_code                                     item_no
                ,customer_product_code                         cust_prod_cd
                ,item_description                              item_desc
                ,manuf_code                                    manuf_code
                ,qty                                           qty
                ,uom                                           uom
                ,unit_price                                    unit_price
                ,extended_price                                ext_price
                ,line_comments                                 line_comments
                ,gsa_comments                                  gsa_comments
				,NVL2(ltrim(rtrim(dept_code||dept_desc)),NVL(dept_sft_hdr,'Department')||' : '||rtrim(ltrim(dept_code))||nvl2(rtrim(ltrim(dept_desc)),' - '||dept_desc,null),NULL) dept_desc  -- Added for Defect 36437
				,DECODE( kit_sku,NULL,NULL,SUBSTR(('KIT'||'-'||kit_sku||'-'||kit_sku_desc),1,80) )   KIT_SKU  -- Added for Kitting, Defect# 37675
		  FROM   xx_ar_ebl_cons_lines_stg XAECLS
          WHERE XAECLS.request_id           = :p_batch_id
          AND   XAECLS.cons_inv_id          = :cbi_id
          AND   XAECLS.customer_trx_id      = :trx_id
          AND   XAECLS.bill_to_site_use_id  = :bill_to_id
                  AND   XAECLS.cust_doc_id          = :cust_doc_id
          AND  (XAECLS.item_code            IS NULL
                OR XAECLS.item_code         NOT IN ('SPC_CARD_INFO' ,'TD','ACM','GIFT_CARD_CM','GIFT_CARD_INV')
                )
		  order by line_seq
       ]]>
    </sqlStatement>
    <sqlStatement name="Q_TD">
       <![CDATA[
          SELECT '        Note: A Discount of '
                 || TRIM(TO_CHAR(XAECLS.extended_price ,'9G999D99'))
                 || ' has been applied to your order        '                   td_text
          FROM   xx_ar_ebl_cons_lines_stg XAECLS
          WHERE  XAECLS.request_id           = :p_batch_id
          AND    XAECLS.cons_inv_id          = :cbi_id
          AND    XAECLS.customer_trx_id      = :trx_id
          AND    XAECLS.bill_to_site_use_id  = :bill_to_id
          AND    XAECLS.cust_doc_id          = :cust_doc_id
          AND    XAECLS.item_code            = 'TD'
          UNION ALL
          SELECT '        '||:P_CM_TEXT1||' '
                 || TRIM(TO_CHAR(XAECLS.extended_price ,'$9G999G999D99'))
                 || ' '||:P_CM_TEXT2||' '|| XAECLS.customer_product_code||'.'   td_text
          FROM   xx_ar_ebl_cons_lines_stg XAECLS
          WHERE  XAECLS.request_id            = :p_batch_id
          AND    XAECLS.cons_inv_id           = :cbi_id
          AND    XAECLS.customer_trx_id       = :trx_id
          AND    XAECLS.bill_to_site_use_id   = :bill_to_id
          AND    XAECLS.cust_doc_id           = :cust_doc_id
          AND    XAECLS.item_code             = 'ACM'
          UNION ALL
          SELECT '        '||:P_GIFT_CARD_TEXT1
                 ||TRIM(TO_CHAR(XAECLS.extended_price*-1 ,'9G999G999D99'))
                 ||:P_GIFT_CARD_TEXT2                                           td_text
          FROM   xx_ar_ebl_cons_lines_stg XAECLS
          WHERE  XAECLS.request_id            = :p_batch_id
          AND    XAECLS.cons_inv_id           = :cbi_id
          AND    XAECLS.customer_trx_id       = :trx_id
          AND    XAECLS.bill_to_site_use_id   = :bill_to_id
          AND    XAECLS.cust_doc_id           = :cust_doc_id
          AND    XAECLS.item_code             = 'GIFT_CARD_INV'
          UNION ALL
          SELECT '        '||:P_GIFT_CARD_TEXT3
                 ||TRIM(TO_CHAR(XAECLS.extended_price*-1 ,'9G999G999D99'))         td_text
          FROM   xx_ar_ebl_cons_lines_stg XAECLS
          WHERE  XAECLS.request_id            = :p_batch_id
          AND    XAECLS.cons_inv_id           = :cbi_id
          AND    XAECLS.customer_trx_id       = :trx_id
          AND    XAECLS.bill_to_site_use_id   = :bill_to_id
          AND    XAECLS.cust_doc_id           = :cust_doc_id
          AND    XAECLS.item_code             = 'GIFT_CARD_CM'
       ]]>
    </sqlStatement>
	<sqlStatement name="Q_POD_MSG">  <!--Added this sqlStatement for POD NAIT-70471-->
       <![CDATA[
          SELECT xx_ar_ebl_pod_invoices_pkg.get_pod_msg(:cust_account_id ,:trx_id,:cust_doc_id) PD_CUST_MSG
		  FROM DUAL
       ]]>
    </sqlStatement>	
	<sqlStatement name="Q_POD_IMAGE">  <!--Added this sqlStatement for POD NAIT-70471-->
       <![CDATA[
          SELECT NVL(xx_ar_ebl_pod_invoices_pkg.resize_image(customer_trx_id),pod_image)  PD_IMG,
				 TO_CHAR(delivery_date,'DD-MON-YYYY HH24:MI:SS') DEL_DT_TM,
			     trim(consignee)  CNSNEE			     					 
		  FROM  xx_ar_ebl_pod_dtl
		  WHERE customer_trx_id = :trx_id
		  AND 'Y' = xx_ar_ebl_pod_invoices_pkg.get_pay_doc_flag(:cust_doc_id)
       ]]>
    </sqlStatement>
	<sqlStatement name="Q_CONS_MSG_BCC">  <!--Added this sqlStatement for NAIT-65564-->
       <![CDATA[
          SELECT xx_ar_ebl_common_util_pkg.get_cons_msg_bcc(:cust_doc_id,:cust_account_id,:billing_number) CONS_MSG_BCC 
		  FROM DUAL
       ]]>
    </sqlStatement>
	<sqlStatement name="Q_CONS_FEE">
       <![CDATA[	
SELECT 
      flv.lookup_code FEE_CODE
     ,upper(flv.meaning)  FEE_DESCRIPTION
     ,flv.attribute7
     ,TO_CHAR(sum(RCTL.unit_selling_price*
	 CASE WHEN aps.class = 'CM' THEN
	  quantity_credited
	 ELSE 
	  NVL(quantity_ordered,quantity_invoiced)
	  END
	  ),'9999999999.999')       FEE_AMT  
FROM
     ra_customer_trx_lines_All RCTL
	 ,xx_ar_ebl_cons_hdr_main  XAECTRS
     ,fnd_lookup_values flv
     ,ar_payment_schedules_all aps
WHERE 1=1
  AND flv.lookup_type = 'OD_FEES_ITEMS'
  AND flv.LANGUAGE='US'
  AND flv.attribute6= rctl.INVENTORY_ITEM_ID
  AND FLV.enabled_flag = 'Y'                                   
  AND SYSDATE BETWEEN NVL(FLV.start_date_active,SYSDATE) AND NVL(FLV.end_date_active,SYSDATE+1)  
  AND FLV.attribute7 NOT IN ('DELIVERY','MISCELLANEOUS')  
  AND RCTL.customer_trx_id         = XAECTRS.customer_trx_id
  AND RCTL.customer_trx_id = aps.customer_trx_id
  AND XAECTRS.cons_inv_id           = :cbi_id 
  AND XAECTRS.batch_id    = :p_batch_id
  AND XAECTRS.file_id     = :file_id
GROUP BY flv.lookup_code,flv.meaning,flv.attribute7
order by flv.attribute7 desc,flv.lookup_code
       ]]>
    </sqlStatement>	
  </dataQuery>
  <dataTrigger name="beforeReportTrigger" source="xx_ar_ebl_cons_epdf_pkg.beforereport"/>
  <dataStructure>
    <group name = "G_FILE_ID" source = "Q_FILE_ID">
      <element name = "FILE_ID"             value = "FILE_ID"/>
      <element name = "FILE_NAME"           value = "FILE_NAME"/>
      <group name = "G_BILL_TO_SITES" source = "Q_BILL_TO_SITES">
        <element name = "BILL_TO_COUNTRY"       value = "BILL_TO_COUNTRY"/>
        <element name = "DOC_DESCRIPTION"       value = "DOC_DESCRIPTION"/>
        <element name = "POSTAL_CODE"           value = "BILL_TO_POSTAL_CODE"/>
        <element name = "RETURN_ADDRESS"        value = "RETURN_ADDRESS"/>
        <element name = "REMIT_TO"              value = "REMIT_TO"/>
        <element name = "MAIL_TO_ATTENTION"     value = "MAIL_TO_ATTENTION"/>
        <element name = "BILL_TO"               value = "BILL_TO"/>
        <element name = "TAX_ID_DESC"           value = "TAX_ID_DESC"/>
        <element name = "TAX_ID"                value = "TAX_ID"/>
        <element name = "ACCOUNT_CONTACT"       value = "ACCOUNT_CONTACT"/>
        <element name = "ORDER_CONTACT"         value = "ORDER_CONTACT"/>
        <element name = "CUSTOMER_NAME"         value = "CUSTOMER_NAME"/>
        <element name = "ACCOUNT_NUMBER"        value = "ACCOUNT_NUMBER"/>				
        <element name = "BILLING_ID"            value = "BILLING_ID"/>
        <element name = "DOC_ID"                value = "DOC_ID"/>
        <group name = "G_CONS_BILLS" source = "Q_CONSOLIDATED_BILLS">
          <element name = "BILLING_NUMBER"           value = "BILLING_NUMBER"/>
          <element name = "TERMS"                    value = "TERMS"/>
          <element name = "CURRENCY"                 value = "CURRENCY"/>
          <element name = "BILL_FROM_DATE"           value = "BILL_FROM_DATE"/>
          <element name = "BILL_TO_DATE"             value = "BILL_TO_DATE"/>
          <element name = "PAYMENT_DUE"              value = "PAYMENT_DUE"/>
          <element name = "DOC_TITLE"                value = "DOC_TITLE"/>
          <element name = "CBI_EXTAMT_PLUS_DELVY"    value = "CBI_EXTAMT_PLUS_DELVY"/>
          <element name = "CBI_DISCOUNTS"            value = "CBI_DISCOUNTS"/>
          <element name = "CBI_TAX"                  value = "CBI_TAX"/>
          <element name = "CBI_FEE_AMT"              value = "CBI_FEE_AMT"/>
		  <element name = "CBI_AMOUNT_DUE"           value = "CBI_AMOUNT_DUE"/>
          <element name = "NO_PAYMENT_TEXT"          value = "NO_PAYMENT_TEXT"/>
          <element name = "DOCUMENT_TYPE"            value = "DOCUMENT_TYPE"/>
		  <element name = "DISCOUNT_INFO"            value = "DISCOUNT_INFO"/> <!--Added for Defect # 36437-->
		  <element name = "FEE_OPTION"               value = "FEE_OPTION"/>
          <group name = "G_INVOICE" source = "Q_INVOICE">
            <element name = "ORDER_NO"                 value = "ORDER_NO"/>
            <element name = "ORDER_DT"                 value = "ORDER_DT"/>
            <element name = "SHIP_DT"                  value = "SHIP_DT"/>
            <element name = "SFHDR1"                   value = "SFHDR1"/>
            <element name = "SFDATA1"                  value = "SFDATA1"/>
            <element name = "SFHDR2"                   value = "SFHDR2"/>
            <element name = "SFDATA2"                  value = "SFDATA2"/>
            <element name = "SFHDR3"                   value = "SFHDR3"/>
            <element name = "SFDATA3"                  value = "SFDATA3"/>
            <element name = "SFHDR4"                   value = "SFHDR4"/>
            <element name = "SFDATA4"                  value = "SFDATA4"/>
            <element name = "SFHDR5"                   value = "SFHDR5"/>
            <element name = "SFDATA5"                  value = "SFDATA5"/>
            <element name = "SFHDR6"                   value = "SFHDR6"/>
            <element name = "SFDATA6"                  value = "SFDATA6"/>
            <element name = "SFHDR7"                   value = "SFHDR7"/>
            <element name = "SFDATA7"                  value = "SFDATA7"/>
			<element name = "REBATE_INFO"              value = "REBATE_INFO"/> <!--Added for Defect # 36437-->
            <group name = "G_SPC" source = "Q_SPC">
              <element name = "SPC_TEXT" value = "SPC_TEXT"/>
            </group>
            <group name = "G_DETAIL" source = "Q_DETAIL">
              <element name = "ITEM_NO"                  value = "ITEM_NO"/>
              <element name = "CUST_PROD_CD"             value = "CUST_PROD_CD"/>
              <element name = "ITEM_DESC"                value = "ITEM_DESC"/>
              <element name = "MANUF_CODE"               value = "MANUF_CODE"/>
              <element name = "QTY"                      value = "QTY"/>
              <element name = "UOM"                      value = "UOM"/>
              <element name = "UNIT_PRICE"               value = "UNIT_PRICE"/>
              <element name = "EXT_PRICE"                value = "EXT_PRICE"/>
              <element name = "LINE_COMMENTS"            value = "LINE_COMMENTS"/>
              <element name = "GSA_COMMENTS"             value = "GSA_COMMENTS"/>
			  <element name = "DEPT_DESC"                value = "DEPT_DESC"/>   <!--Added for Defect # 36437-->
			  <element name = "KIT_SKU"                  value = "KIT_SKU"/>     <!--Added for Kitting Defect # 37675-->
            </group>
            <group name = "G_TD" source = "Q_TD">
              <element name = "TD_TEXT" value = "TD_TEXT"/>
            </group>
            <group name = "G_INV_STATEMENT" source = "Q_INV_STATEMENT">
              <element name = "SF_TEXT1"                   value = "SF_TEXT1"/>
              <element name = "SF_TEXT2"                   value = "SF_TEXT2"/>
              <element name = "SUBTOTAL_AMOUNT"            value = "SF_AMOUNT"/>
              <element name = "PG_BREAK"                   value = "PG_BREAK"/>
              <element name = "DISPLAY_SEQ"                value = "VIEW_SEQ"/>
              <element name = "SHOW_LINE"                value = "SHOW_LINE"/>
            </group>
			<group name = "G_POD_MSG" source = "Q_POD_MSG">	<!--Added this Group for POD NAIT-70471-->
			<element name = "PD_CUST_MSG"              value = "PD_CUST_MSG"/>
			</group>
			<group name = "G_POD_DETAILS" source = "Q_POD_IMAGE">  <!--Added this Group for POD NAIT-70471-->
              <element name = "PD_IMG"                    value = "PD_IMG"/>
			  <element name = "DEL_DT_TM"                 value = "DEL_DT_TM"/>
              <element name = "CNSNEE"                    value = "CNSNEE"/>	
            </group>
          </group>
          <group name = "G_SCAN_LINE" source = "Q_SCAN_LINE">
            <element name = "SCANLINE"                 value = "SCAN_LINE"/>
          </group>                                                           	
		  <group name = "G_CONS_MSG_BCC" source = "Q_CONS_MSG_BCC">        	<!--Added this group for NAIT-65564-->
            <element name = "CONS_MSG_BCC"             value = "CONS_MSG_BCC"/>
          </group>
		  <group name="G_INV_FEE" source="Q_CONS_FEE">
			<element name = "FEE_NAME"                value = "FEE_DESCRIPTION" />
			<element name = "AMOUNT"                  value = "FEE_AMT" />
		  </group>		  
        </group>
      </group>
    </group>
  </dataStructure>
  <dataTrigger name="afterReportTrigger" source="xx_ar_ebl_cons_epdf_pkg.afterreport"/>
</dataTemplate>
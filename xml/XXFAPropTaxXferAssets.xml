<?xml version="1.0"?>
<dataTemplate name="XXFAPropTaxXferAssets" description="R1262 The OD FA Property Tax Report for Transferred Assets will provide information for a particular state, book, and specified date range for all transferred assets." version="1.0">
  <parameters>
    <parameter name="p_report_name"      dataType="character"/>
    <parameter name="p_book_name"        dataType="character"/>
    <parameter name="p_state"            dataType="character"/>
    <parameter name="p_from_period_name" dataType="character"/>
    <parameter name="p_to_period_name"   dataType="character"/>
  </parameters>
  <properties>
    <property name="include_parameters" value="true"/>
  </properties>
  <dataQuery>
    <sqlStatement name="Q1">
       <![CDATA[SELECT fb.book_type_code            book_name,
                       gcc.segment1                 company,
                       gcc.segment4                 location,
                       gcc.segment2                 cost_center,
                       gcc.segment6                 lob,
                       fa.asset_number              asset_number,
                       fa.attribute6                legacy_id,
                       fb.date_effective            effective_date,
                       fa.attribute8                hist_acq_date,
                       fb.date_placed_in_service    date_placed_in_service,
                       fc.segment1                  major,
                       fth.transaction_date_entered retire_date,
                       fc.segment2                  minor,
                       fa.description               description,
                       DECODE(fth.transaction_header_id,
                              fdh.transaction_header_id_in, TRUNC((  fb.COST
                                                                   / fa.current_units
                                                                   * fdh.units_assigned),
                                                                  2),
                              fdh.transaction_header_id_out, TRUNC((  fb.COST
                                                                    / fa.current_units
                                                                    * -1
                                                                    * fdh.units_assigned),
                                                                   2)) cost,
                       DECODE(fth.transaction_header_id,
                              fdh.transaction_header_id_in, TRUNC((  fa.attribute7
                                                                   / fa.current_units
                                                                   * fdh.units_assigned),
                                                                  2),
                              fdh.transaction_header_id_out, TRUNC((  fa.attribute7
                                                                    / fa.current_units
                                                                    * -1
                                                                    * fdh.units_assigned),
                                                                   2)) hist_cost,
                       1                            location_no,
                       DECODE(fth.transaction_header_id,
                              fdh.transaction_header_id_in, 'TRANSFER IN',
                              fdh.transaction_header_id_out, 'TRANSFER OUT') trans_type,
                       'building'                   building,
                          fl.segment1
                       || '.'
                       || fl.segment2
                       || '.'
                       || fl.segment3
                       || '.'
                       || fl.segment4
                       || '.'
                       || fl.segment5
                       || '.'
                       || fl.segment6               city,
                       'county'                     county,
                       fl.segment2                  state,
                       'zip'                        zip,
                       'invoice'                    invoice_number,
                       'voucher'                    voucher_number,
                       fdp.period_name              period_name,
                       fb.date_effective            book_effective,
                       fb.date_ineffective          book_ineffective,
                       fdh.date_effective           dist_effective,
                       fdh.date_ineffective         dist_ineffective,
                       fb.transaction_header_id_in  books_header_id,
                       fa.asset_id                  asset_id,
                       fth.date_effective           trans_effective_date
                FROM   gl_code_combinations gcc,
                       fa_additions fa,
                       fa_transaction_headers fth,
                       fa_books fb,
                       fa_locations fl,
                       fa_distribution_history fdh,
                       fa_categories fc,
                       fa_asset_history fah,
                       fa_deprn_periods fdp,
                       fa_book_controls fbc,
                       gl_period_statuses fgps,
                       gl_period_statuses tgps
                WHERE  fa.asset_id                   = fb.asset_id
                AND    fdp.book_type_code            = fb.book_type_code
                AND    fth.date_effective           >= fdp.period_open_date
                AND    fth.date_effective           <= NVL(fdp.period_close_date,
                                                           SYSDATE)
                AND    fdh.code_combination_id       = gcc.code_combination_id
                AND    fdh.asset_id                  = fa.asset_id
                AND    fah.asset_id                  = fa.asset_id
                AND    fdh.book_type_code            = fb.book_type_code
                AND    fdh.location_id               = fl.location_id
                AND    fth.asset_id                  = fa.asset_id
                AND    fth.book_type_code            = fb.book_type_code
                AND    fth.transaction_type_code     = 'TRANSFER'
                AND    fth.transaction_header_id    >= fah.transaction_header_id_in
                AND    fth.transaction_header_id     < NVL(fah.transaction_header_id_out,
                                                             fth.transaction_header_id
                                                           + 1)
                AND    fc.category_id                = fah.category_id
                AND    (   fth.transaction_header_id = fdh.transaction_header_id_in
                        OR fth.transaction_header_id = fdh.transaction_header_id_out)
                AND    fc.category_type             <> 'LEASE'
                AND    fb.book_type_code             = :p_book_name
                AND    fl.segment2                   = :p_state
                AND    fbc.book_type_code             = fb.book_type_code
                AND    fbc.set_of_books_id            = fgps.set_of_books_id
                AND    fbc.set_of_books_id            = tgps.set_of_books_id
                AND    fgps.period_name               = :p_from_period_name
                AND    fgps.application_id            = 101
                AND    tgps.period_name               = :p_to_period_name
                AND    tgps.application_id            = 101
                AND    fth.date_effective            BETWEEN fgps.start_date AND tgps.end_date
                ORDER BY gcc.segment4]]>
    </sqlStatement>
  </dataQuery>
  <dataStructure>
    <group name="G_ASSETS" source="Q1">
      <element name="BOOK_NAME"              value="book_name"/>
      <element name="COMPANY"                value="company"/>
      <element name="LOCATION"               value="location"/>
      <element name="COST_CENTER"            value="cost_center"/>
      <element name="LOB"                    value="lob"/>
      <element name="ASSET_NUMBER"           value="asset_number"/>
      <element name="LEGACY_ID"              value="legacy_id"/>
      <element name="EFFECTIVE_DATE"         value="effective_date"/>
      <element name="HIST_ACQ_DATE"          value="hist_acq_date"/>
      <element name="DATE_PLACED_IN_SERVICE" value="date_placed_in_service"/>
      <element name="MAJOR"                  value="major"/>
      <element name="RETIRE_DATE"            value="retire_date"/>
      <element name="MINOR"                  value="minor"/>
      <element name="DESCRIPTION"            value="description"/>
      <element name="COST"                   value="cost"/>
      <element name="HIST_COST"              value="hist_cost"/>
      <element name="LOCATION_NO"            value="location_no"/>
      <element name="TRANS_TYPE"             value="trans_type"/>
      <element name="ZIP"                    value="zip"/>
      <element name="CITY"                   value="city"/>
      <element name="COUNTY"                 value="county"/>
      <element name="STATE"                  value="state"/>
      <element name="BUILDING"               value="building"/>
      <element name="INVOICE_NUMBER"         value="invoice_number"/>
      <element name="VOUCHER_NUMBER"         value="voucher_number"/>
      <element name="PERIOD_NAME"            value="period_name"/>
      <element name="BOOK_EFFECTIVE"         value="book_effective"/>
      <element name="BOOK_INEFFECTIVE"       value="book_ineffective"/>
      <element name="DIST_EFFECTIVE"         value="dist_effective"/>
      <element name="DIST_INEFFECTIVE"       value="dist_ineffective"/>
      <element name="BOOKS_HEADER_ID"        value="books_header_id"/>
      <element name="ASSET_ID"               value="asset_id"/>
      <element name="TRANS_EFFECTIVE_DATE"   value="trans_effective_date"/> 
    </group>
  </dataStructure> 
</dataTemplate>
<?xml version="1.0" encoding="UTF-8" ?>
<dataTemplate name ="EDIINVSUMREP" description="EDI Invoice Data" Version="1.0" >
<parameters>
<parameter name="p_from_date" dataType="string"/>
<parameter name="p_to_date" dataType="string"/>
<parameter name="p_sup_site_cd_from" dataType="string"/>
<parameter name="p_sup_site_cd_to" dataType="string"/>
</parameters>
<dataQuery>
<sqlStatement name="Q1">
	<![CDATA[SELECT AIA.CREATION_DATE TRANSMISSION_DATE,
	(SELECT DECODE(SUBSTR(base_currency_code,1,2),'US','USTR','CA','CNTR',SUBSTR(base_currency_code,1,2))
   FROM   ap_system_parameters) AP_COMPANY,
	ASSA.VENDOR_SITE_CODE VENDOR_NUM,
	ASU.VENDOR_NAME,
  AIA.invoice_date,
  aia.invoice_num invoice_num,
  aia.invoice_amount,
  aia.source
FROM AP_INVOICES_ALL AIA,
    AP_SUPPLIERS ASU,
    ap_supplier_Sites_all assa
WHERE 1= 1
AND (AIA.SOURCE  ='US_OD_TRADE_EDI' OR (aia.source ='US_OD_DROPSHIP' AND aia.attribute2='Y'))
AND AIA.ORG_ID=NVL(MO_GLOBAL.get_current_org_id, AIA.ORG_ID)
AND ASU.VENDOR_ID          =AIA.VENDOR_ID
AND ASSA.VENDOR_ID =asu.vendor_id
AND assa.vendor_Site_id = aia.vendor_site_id
AND AIA.CREATION_DATE BETWEEN fnd_date.canonical_to_date(:P_FROM_DATE) AND fnd_date.canonical_to_date(:P_TO_DATE)--,'RRRR/MM/DD HH24:MI:SS')
--AND AIA.CREATION_DATE BETWEEN TO_DATE(:P_FROM_DATE) AND TO_DATE(:P_TO_DATE)
AND assa.VENDOR_SITE_CODE BETWEEN NVL(:p_sup_site_cd_from, ASSA.VENDOR_SITE_CODE) AND NVL(:p_sup_site_cd_to,ASSA.VENDOR_SITE_CODE)]]>
</sqlStatement>
</dataQuery>
- <dataStructure>
- <group name="G_EDI_INV" source="Q1">
  <element name="TRANSMISSION_DATE" value="TRANSMISSION_DATE"/> 
  <element name="AP_COMPANY" value="AP_COMPANY" /> 
  <element name="VENDOR_NUM" value="VENDOR_NUM" /> 
  <element name="VENDOR_NAME" value="VENDOR_NAME" /> 
  <element name="INVOICE_NUM" value="INVOICE_NUM" /> 
  <element name="INVOICE_DATE" value="INVOICE_DATE" /> 
  <element name="INVOICE_AMOUNT" value="INVOICE_AMOUNT" />  
  <element name="SOURCE" value="SOURCE" /> 
  </group>
  </dataStructure>
 </dataTemplate>  

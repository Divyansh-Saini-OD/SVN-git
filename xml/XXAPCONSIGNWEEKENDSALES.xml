<?xml version="1.0" encoding="UTF-8"?>
<dataTemplate name="XXAPCONSIGNWEEKENDSALES" defaultPackage="" dataSourceRef="">
	<properties>
		<property name="include_parameters" value="true"/>
		<property name="include_null_Element" value="true"/>
		<property name="db_fetch_size" value="300"/>
	</properties>
	<parameters>
		<parameter name="P_VENDOR_NUMBER" dataType="varchar2" defaultValue=""/>
		<parameter name="P_INVOICE_NUM" dataType="varchar2" defaultValue=""/>
		<parameter name="P_FROM_DATE" dataType="varchar2" /> 
        <parameter name="P_TO_DATE" dataType="varchar2" />
	</parameters>
<dataQuery>
<sqlStatement name="Q_DATA" dataSourceRef="">
<![CDATA[  
    SELECT 'USTR'                                     AP_COMPANY,
	       HDR.AP_VENDOR                              VENDOR_NUMBER,
           HDR.INVOICE_NUMBER                         INVOICE_NUMBER,
    	   LINES.LOCATION_NUMBER                      LOCATION_NUMBER,
		   LINES.INVOICE_DATE                         SALES_DATE,
		   AIA.INVOICE_DATE                           INVOICE_DATE,
		   LINES.SKU                                  SKU,
		   LINES.COST                                 AVG_COST,
		   LINES.QUANTITY                             QUANTITY,
		   LINES.PO_COST                              PO_COST,
		   LINES.TRACK_ID                             TRACK_ID,
		   LINES.ACCOUNT_NUMBER                       ACCOUNT_NUMBER   	   
      FROM XX_AP_TRADE_INV_LINES LINES,
           XX_AP_TRADE_INV_HDR HDR,
		   AP_SUPPLIERS ASP,
           AP_INVOICES_ALL AIA
     WHERE 1 = 1
	   AND LINES.INVOICE_ID = HDR.INVOICE_ID
       AND HDR.INVOICE_NUMBER = AIA.INVOICE_NUM
	   AND ASP.VENDOR_ID = AIA.VENDOR_ID
       AND AIA.SOURCE = 'US_OD_CONSIGNMENT_SALES'
       AND LINES.CONSIGN_FLAG = 'Y' 
       AND (:P_VENDOR_NUMBER IS NULL OR HDR.AP_VENDOR = :P_VENDOR_NUMBER)
       AND (:P_INVOICE_NUM IS NULL OR AIA.INVOICE_NUM = :P_INVOICE_NUM )
       AND  AIA.CREATION_DATE  BETWEEN TO_DATE(:P_FROM_DATE||' 00:00:00','DD-MON-RRRR HH24:MI:SS') AND TO_DATE(:P_TO_DATE||' 23:59:59','DD-MON-RRRR HH24:MI:SS')
     ORDER BY AIA.INVOICE_NUM
]]>
</sqlStatement>
</dataQuery>
<dataStructure>
<group name="G_DATA" source="Q_DATA" groupFilter="">
     <element name="C_AP_COMPANY" value="AP_COMPANY" function=""/>
     <element name="C_VENDOR_NUMBER" value="VENDOR_NUMBER" function=""/>
     <element name="C_INVOICE_NUMBER" value="INVOICE_NUMBER" function=""/>  	 
	 <element name="C_LOCATION_NUMBER" value="LOCATION_NUMBER" function=""/> 
	 <element name="C_SALES_DATE" value="SALES_DATE" function=""/>
     <element name="C_INVOICE_DATE" value="INVOICE_DATE" function=""/>	 
	 <element name="C_SKU" value="SKU" function=""/>
	 <element name="C_AVG_COST" value="AVG_COST" function=""/>
	 <element name="C_QUANTITY" value="QUANTITY" function=""/> 
	 <element name="C_PO_COST" value="PO_COST" function=""/>    
     <element name="C_TRACK_ID" value="TRACK_ID" function=""/>
     <element name="C_ACCOUNT_NUMBER" value="ACCOUNT_NUMBER" function=""/>		 
</group>
</dataStructure>
</dataTemplate>
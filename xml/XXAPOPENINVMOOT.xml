<?xml version="1.0" encoding="UTF-8"?>
<dataTemplate name ="XXAPMOOTINVHOLD" description="Moot hold inv hld report" Version="1.0">
<parameters>
<parameter name="P_HOLD_LOOKUP_CODE" dataType="character"/>
</parameters>
<dataQuery>
<sqlStatement name="Q_EMAIL1">
<![CDATA[SELECT TV.target_value1 out_email1
            	 ,TV.target_value2 out_email2             
       FROM   XX_FIN_TRANSLATEVALUES TV
          	   ,XX_FIN_TRANSLATEDEFINITION TD
       WHERE TV.TRANSLATE_ID  = TD.TRANSLATE_ID
       AND TRANSLATION_NAME = 'XX_AP_MOOT_HOLD'
       AND   source_value1    = 'OD_MOOT_HOLD'
]]>
</sqlStatement>
<sqlStatement name="Q_HEADERS">
<![CDATA[ 
SELECT a.invoice_num invoice_number,
  (SELECT segment1 FROM apps.ap_suppliers WHERE vendor_id = a.vendor_id
  ) supplier_number,
  (SELECT vendor_name FROM apps.ap_suppliers WHERE vendor_id = a.vendor_id
  ) supplier_name,
  (SELECT vendor_site_code
  FROM apps.ap_supplier_sites_all
  WHERE vendor_site_id = a.vendor_site_id
  ) supplier_site_code,
  a.invoice_amount,
  a.source,
  TO_CHAR(a.gl_date, 'DD-MON-YYYY') gl_date,
  DECODE(a.quick_po_header_id, NULL,'',
  (SELECT segment1
  FROM apps.po_headers_all
  WHERE po_header_id = a.quick_po_header_id
  )) po_number,
  b.hold_lookup_code,
  TO_CHAR(b.hold_date, 'DD-MON-YYYY HH24:MI:SS') hold_date,
  (SELECT user_name FROM apps.fnd_user WHERE user_id = b.held_by
  ) held_by,
  b.hold_reason,
  b.release_lookup_code,
  b.release_reason,
  :out_email1 EMAIL1,
:out_email2 EMAIL2,
(SELECT SUBSTR(UPPER(SYS_CONTEXT('USERENV','DB_NAME') ), 4,8)
                     FROM DUAL ) INSTANCE_NAME,
FND_PROFILE.VALUE('XX_XDO_SMTP_HOST') SMTP_SERVER,
to_char(SYSDATE,'MM/DD/YYYY') CURRENT_DATE
FROM apps.ap_invoices_all a,
  apps.ap_holds_all b
WHERE a.invoice_id          = b.invoice_id
AND b.hold_lookup_code      = :P_HOLD_LOOKUP_CODE
AND (b.release_lookup_code IS NULL)
]]>
</sqlStatement>
</dataQuery>
<dataStructure>
<group name="G_EMAIL1" source="Q_EMAIL1">
	<element name="out_email1" value="out_email1"/>	
	<element name="out_email2" value="out_email2"/>		
</group>
<group name="G_HEADERS" source="Q_HEADERS">
<element name="EMAIL1" value="EMAIL1"/>	
<element name="EMAIL2" value="EMAIL2"/>	
<element name="INSTANCE_NAME" value="INSTANCE_NAME"/>
<element name="SMTP_SERVER" value="SMTP_SERVER"/>
<element name="CURRENT_DATE" value="CURRENT_DATE"/>
  <group name="G_DATA" source="Q_HEADERS"> 
	<element name="invoice_number" value="invoice_number"/>
     <element name="supplier_number" value="supplier_number" function=""/>
     <element name="supplier_name" value="supplier_name" function=""/>	 
	 <element name="supplier_site_code" value="supplier_site_code" function=""/> 
	 <element name="invoice_amount" value="invoice_amount" function=""/> 
     <element name="source" value="source" function=""/>
	 <element name="gl_date" value="gl_date" function=""/>
	 <element name="po_number" value="po_number" function=""/> 
	 <element name="hold_date" value="hold_date" function=""/>
<element name="hold_lookup_code" value="hold_lookup_code" function=""/>	
	 <element name="held_by" value="held_by" function=""/>
	 <element name="hold_reason" value="hold_reason" function=""/>
	 </group>	 
</group>
</dataStructure>
</dataTemplate>
/*===========================================================================+
 |                       Office Depot - Project Simplify                     |
 |            Oracle NAIO/WIPRO/Office Depot/Consulting Organization         |
 +===========================================================================+
 |  FILENAME                                                                 |
 |             PartySiteVOImpl.java                                          |
 |                                                                           |
 |  DESCRIPTION                                                              |
 |    Class to initial the query with the given parameter and then execute   |
 |    the same inorder to fetch the required party site details.             |
 |                                                                           |
 |  NOTES                                                                    |
 |                                                                           |
 |                                                                           |
 |  DEPENDENCIES                                                             |
 |    This class file is called from SiteViewAMImpl.java                     |
 |                                                                           |
 |  HISTORY                                                                  |
 |                                                                           |
 |    04/09/2007 Ashok Kumar   Created                                       |
 |                                                                           |
 +===========================================================================*/
package od.oracle.apps.xxcrm.asn.partysite.common.server;

import oracle.apps.asn.common.schema.server.ASNUtil;
import oracle.apps.fnd.common.MessageToken;
import oracle.apps.fnd.common.VersionInfo;
import oracle.apps.fnd.framework.OAFwkConstants;
import oracle.apps.fnd.framework.server.OADBTransaction;
import oracle.apps.fnd.framework.server.OAViewObjectImpl;

import oracle.jbo.domain.Number;

//  ---------------------------------------------------------------
//  ---    File generated by Oracle Business Components for Java.
//  ---------------------------------------------------------------

public class ODPartySiteVOImpl extends OAViewObjectImpl 
{
  /**
  * Oracle Applications internal source control identifier.
  */
  public static final String RCS_ID="$Header: ODPartySiteVOImpl.java,v 1.3 2007/10/01 11:53:58 akumar Exp $";

 /**
  * Oracle Applications internal source control identifier.
  */
  public static final boolean RCS_ID_RECORDED =
    VersionInfo.recordClassVersion(RCS_ID, "od.oracle.apps.xxcrm.asn.partysite.common.server");

  /**
   * 
   * This is the default constructor (do not remove)
   */
  public ODPartySiteVOImpl()
  {
  }

  /** Initializes and executes the query.
   *
   * @param partyId        Customer party identifier
   * @param partySiteId    Party Site identifier
   */
  public void initQuery(String partyId, String partySiteId)
  { 
    final String METHOD_NAME = "xxcrm.asn.partysite.common.server.ODPartySiteVOImpl.initQuery";
    OADBTransaction dbTrx = (OADBTransaction)getDBTransaction();
    boolean isProcLogEnabled = dbTrx.isLoggingEnabled(OAFwkConstants.PROCEDURE);
    if (isProcLogEnabled)  {
      dbTrx.writeDiagnostics(METHOD_NAME, "Begin", OAFwkConstants.PROCEDURE);
      StringBuffer buf = new StringBuffer();
      buf.append("Input Parameters: partyId = ");
      buf.append(partyId);
      buf.append(", partySiteId = ");
      buf.append(partySiteId);      
      dbTrx.writeDiagnostics(METHOD_NAME,buf.toString(), OAFwkConstants.PROCEDURE);
    }

    Number custId = null;
    Number siteId = null;

    setWhereClauseParams(null); // Always reset

    if ((partyId != null) && (!("".equals(partyId.trim()))))
    {
        MessageToken[] tokens = { new MessageToken("IDNAME", partyId) };
        custId = ASNUtil.stringToJboNumber
                           (partyId, "ASN_CMMN_STR_TO_JBONUM_ERR", tokens);
        setWhereClauseParam(0, custId);    
    }

    if ((partySiteId != null) && (!("".equals(partySiteId.trim()))))
    {
        MessageToken[] tokens = { new MessageToken("IDNAME", partySiteId) };
        siteId = ASNUtil.stringToJboNumber
                           (partySiteId, "ASN_CMMN_STR_TO_JBONUM_ERR", tokens);
//        setWhereClause(" party_site_id = :2");
        setWhereClauseParam(1, siteId);
    }
    else{      
         siteId = new Number(-9999);
         setWhereClauseParam(1, siteId);
         //setWhereClause(" identifying_address_flag = 'Y'");
         if (isProcLogEnabled)  {
            dbTrx.writeDiagnostics(METHOD_NAME, "party_site_id = -9999 ", OAFwkConstants.PROCEDURE);
         }         
    }
    setMaxFetchSize(-1);
    executeQuery();
    
    if (isProcLogEnabled)  {
      dbTrx.writeDiagnostics(METHOD_NAME, "End", OAFwkConstants.PROCEDURE);
    }
  }
  
}
<?xml version="1.0" encoding="UTF-8" ?>
<?oracle-xsl-mapper
  <!-- SPECIFICATION OF MAP SOURCES AND TARGETS, DO NOT MODIFY. -->
  <mapSources>
    <source type="XSD">
      <schema location="GLogXML.xsd"/>
      <rootElement name="Transmission" namespace="http://xmlns.oracle.com/apps/otm"/>
    </source>
  </mapSources>
  <mapTargets>
    <target type="XSD">
      <schema location="APPS_XX_OM_WSH_OTM_INBOUND_GRP_INITIATE_PLANNED_SHIPMENT.xsd"/>
      <rootElement name="InputParameters" namespace="http://xmlns.oracle.com/pcbpel/adapter/db/APPS/XX_OM_WSH_OTM_INBOUND_GRP/INITIATE_PLANNED_SHIPMENT/"/>
    </target>
  </mapTargets>
  <!-- GENERATED BY ORACLE XSL MAPPER 10.1.3.1.0(build 061009.0802) AT [WED JUN 13 17:57:15 IST 2007]. -->
?>
<xsl:stylesheet version="1.0"
                xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/"
                xmlns:ns1="http://xmlns.oracle.com/apps/otm"
                xmlns:ehdr="http://www.oracle.com/XSL/Transform/java/oracle.tip.esb.server.headers.ESBHeaderFunctions"
                xmlns:ns0="http://www.w3.org/2001/XMLSchema"
                xmlns:db="http://xmlns.oracle.com/pcbpel/adapter/db/APPS/WSH_GLOG_INBOUND_PKG/INITIATE_PLANNED_SHIPMENT/"
                xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath"
                xmlns:ldap="http://schemas.oracle.com/xpath/extension/ldap"
                xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
                xmlns:ns2="http://xmlns.oracle.com/pcbpel/adapter/db/APPS/XX_OM_WSH_OTM_INBOUND_GRP/INITIATE_PLANNED_SHIPMENT/"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:ora="http://schemas.oracle.com/xpath/extension"
                xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath"
                xmlns:orcl="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
                exclude-result-prefixes="xsl ns1 ns0 ns2 bpws ehdr hwf xp20 ora ids orcl">
  <xsl:template match="/">
    <ns2:InputParameters>
      <P_INT_TRIP_INFO>
        <xsl:for-each select="/ns1:Transmission/ns1:TransmissionBody/ns1:GLogXMLElement/ns1:PlannedShipment/ns1:Shipment">
          <P_INT_TRIP_INFO_ITEM>
            <SHIPMENT_XID>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:ShipmentGid/ns1:Gid/ns1:Xid"/>
            </SHIPMENT_XID>
            <SHIPMENT_NAME>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:ShipmentName"/>
            </SHIPMENT_NAME>
            <SHIPMENT_REFNUM>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:ShipmentRefnum/ns1:ShipmentRefnumValue"/>
            </SHIPMENT_REFNUM>
            <TRANSACTION_CODE>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:TransactionCode"/>
            </TRANSACTION_CODE>
            <SERVICE_PROVIDER_XID>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:ServiceProviderGid/ns1:Gid/ns1:Xid"/>
            </SERVICE_PROVIDER_XID>
            <CONTACT_XID>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:ContactGid/ns1:Gid/ns1:Xid"/>
            </CONTACT_XID>
            <TRANSPORT_MODE_XID>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:TransportModeGid/ns1:Gid/ns1:Xid"/>
            </TRANSPORT_MODE_XID>
            <RATE_SERVICE_XID>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:RateServiceGid/ns1:Gid/ns1:Xid"/>
            </RATE_SERVICE_XID>
            <WEIGHT_UOM_XID>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:TotalWeightVolume/ns1:WeightVolume/ns1:Weight/ns1:WeightUOMGid/ns1:Gid/ns1:Xid"/>
            </WEIGHT_UOM_XID>
            <VOLUME>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:TotalWeightVolume/ns1:WeightVolume/ns1:Volume/ns1:VolumeValue"/>
            </VOLUME>
            <VOLUME_UOM_XID>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:TotalWeightVolume/ns1:WeightVolume/ns1:Volume/ns1:VolumeUOMGid/ns1:Gid/ns1:Xid"/>
            </VOLUME_UOM_XID>
            <SHIPUNIT_COUNT>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:TotalShipUnitCount"/>
            </SHIPUNIT_COUNT>
            <PAYMENT_CODE_XID>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:CommercialTerms/ns1:PaymentMethodCodeGid/ns1:Gid/ns1:Xid"/>
            </PAYMENT_CODE_XID>
            <STOP_COUNT>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:StopCount"/>
            </STOP_COUNT>
            <RELEASE_COUNT>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:NumOrderReleases"/>
            </RELEASE_COUNT>
            <VOYAGE_XID>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:VoyageGid/ns1:Gid/ns1:Xid"/>
            </VOYAGE_XID>
            <VESSEL_XID>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:VesselGid/ns1:Gid/ns1:Xid"/>
            </VESSEL_XID>
            <EQUIPMENT_XID>
              <xsl:value-of select="ns1:SEquipment/ns1:EquipmentGid/ns1:Gid/ns1:Xid"/>
            </EQUIPMENT_XID>
            <EQUIPMENT_INITIAL>
              <xsl:value-of select="ns1:SEquipment/ns1:EquipmentInitial"/>
            </EQUIPMENT_INITIAL>
            <EQUIPMENT_NUMBER>
              <xsl:value-of select="ns1:SEquipment/ns1:EquipmentNumber"/>
            </EQUIPMENT_NUMBER>
            <EQUIPMENT_TYPE_XID>
              <xsl:value-of select="ns1:SEquipment/ns1:EquipmentTypeGid/ns1:Gid/ns1:Xid"/>
            </EQUIPMENT_TYPE_XID>
            <EQUIPMENT_GROUP_XID>
              <xsl:value-of select="ns1:SEquipment/ns1:EquipmentGroupGid/ns1:Gid/ns1:Xid"/>
            </EQUIPMENT_GROUP_XID>
            <EQUIPMENT_SEAL>
              <xsl:value-of select="ns1:SEquipment/ns1:SEquipmentSeal/ns1:SealNumber"/>
            </EQUIPMENT_SEAL>
            <GROSS_WEIGHT>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:TotalWeightVolume/ns1:WeightVolume/ns1:Weight/ns1:WeightValue"/>
            </GROSS_WEIGHT>
            <NET_WEIGHT>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:TotalNetWeightVolume/ns1:Weight/ns1:WeightValue"/>
            </NET_WEIGHT>
            <SHIPMENT_STOPS>
              <xsl:for-each select="ns1:ShipmentStop">
                <SHIPMENT_STOPS_ITEM>
                  <STOP_LOCATION_XID>
                    <xsl:value-of select="ns1:LocationRef/ns1:LocationGid/ns1:Gid/ns1:Xid"/>
                  </STOP_LOCATION_XID>
                  <STOP_SEQUENCE_NUMBER>
                    <xsl:value-of select="ns1:StopSequence"/>
                  </STOP_SEQUENCE_NUMBER>
                  <TRANSACTION_CODE>
                    <xsl:value-of select="ns1:TransactionCode"/>
                  </TRANSACTION_CODE>
                  <PLANNED_ARRIVAL_TIME>
                    <xsl:value-of select="ns1:ArrivalTime/ns1:EventTime/ns1:PlannedTime/ns1:GLogDate"/>
                  </PLANNED_ARRIVAL_TIME>
                  <PLANNED_DEPARTURE_TIME>
                    <xsl:value-of select="ns1:DepartureTime/ns1:EventTime/ns1:PlannedTime/ns1:GLogDate"/>
                  </PLANNED_DEPARTURE_TIME>
                  <ACTUAL_ARRIVAL_TIME>
                    <xsl:value-of select="ns1:ArrivalTime/ns1:EventTime/ns1:ActualTime/ns1:GLogDate"/>
                  </ACTUAL_ARRIVAL_TIME>
                  <ACTUAL_DEPARTURE_TIME>
                    <xsl:value-of select="ns1:DepartureTime/ns1:EventTime/ns1:ActualTime/ns1:GLogDate"/>
                  </ACTUAL_DEPARTURE_TIME>
                </SHIPMENT_STOPS_ITEM>
              </xsl:for-each>
            </SHIPMENT_STOPS>
            <SHIPMENT_SHIP_UNITS>
              <xsl:for-each select="ns1:ShipUnit">
                <SHIPMENT_SHIP_UNITS_ITEM>
                  <SHIP_UNIT_XID>
                    <xsl:value-of select="ns1:ShipUnitGid/ns1:Gid/ns1:Xid"/>
                  </SHIP_UNIT_XID>
                  <TRANSACTION_CODE>
                    <xsl:value-of select="ns1:TransactionCode"/>
                  </TRANSACTION_CODE>
                  <SHIP_FROM_LOCATION_XID>
                    <xsl:value-of select="ns1:ShipFromLocationRef/ns1:LocationRef/ns1:LocationGid/ns1:Gid/ns1:Xid"/>
                  </SHIP_FROM_LOCATION_XID>
                  <SHIP_TO_LOCATION_XID>
                    <xsl:value-of select="ns1:ShipToLocationRef/ns1:LocationRef/ns1:LocationGid/ns1:Gid/ns1:Xid"/>
                  </SHIP_TO_LOCATION_XID>
                  <RELEASE_XID>
                    <xsl:value-of select="ns1:ShipUnitContent/ns1:ReleaseGid/ns1:Gid/ns1:Xid"/>
                  </RELEASE_XID>
                </SHIPMENT_SHIP_UNITS_ITEM>
              </xsl:for-each>
            </SHIPMENT_SHIP_UNITS>
            <SHIPMENT_RELEASES>
              <xsl:for-each select="ns1:Release">
                <SHIPMENT_RELEASES_ITEM>
                  <RELEASE_XID>
                    <xsl:value-of select="ns1:ReleaseGid/ns1:Gid/ns1:Xid"/>
                  </RELEASE_XID>
                  <TRANSACTION_CODE>
                    <xsl:value-of select="ns1:TransactionCode"/>
                  </TRANSACTION_CODE>
                  <SHIP_FROM_LOCATION_XID>
                    <xsl:value-of select="ns1:ShipFromLocationRef/ns1:LocationRef/ns1:LocationGid/ns1:Gid/ns1:Xid"/>
                  </SHIP_FROM_LOCATION_XID>
                  <SHIP_TO_LOCATION_XID>
                    <xsl:value-of select="ns1:ShipToLocationRef/ns1:LocationRef/ns1:LocationGid/ns1:Gid/ns1:Xid"/>
                  </SHIP_TO_LOCATION_XID>
                  <!-- REFNUM WAS HERE-->
                  <xsl:for-each select="ns1:ReleaseRefnum">
                    <xsl:if test='ns1:ReleaseRefnumQualifierGid/ns1:Gid/ns1:Xid = "REVNUM"'>
                      <RELEASE_REFNUM>
                        <xsl:value-of select="ns1:ReleaseRefnumValue"/>
                      </RELEASE_REFNUM>
                    </xsl:if>
                  </xsl:for-each>
                  <xsl:for-each select="ns1:ReleaseRefnum">
                    <xsl:if test='ns1:ReleaseRefnumQualifierGid/ns1:Gid/ns1:Xid = "REVNUM"'>
                      <RELEASE_REFNUM>
                        <xsl:value-of select="ns1:ReleaseRefnumValue"/>
                      </RELEASE_REFNUM>
                    </xsl:if>
                  </xsl:for-each>
                  <EARLY_PICKUP_DATE>
                    <xsl:value-of select="ns1:TimeWindow/ns1:EarlyPickupDate"/>
                  </EARLY_PICKUP_DATE>
                  <LATE_PICKUP_DATE>
                    <xsl:value-of select="ns1:TimeWindow/ns1:LatePickupDate"/>
                  </LATE_PICKUP_DATE>
                  <EARLY_DELIVERY_DATE>
                    <xsl:value-of select="ns1:TimeWindow/ns1:EarlyDeliveryDate"/>
                  </EARLY_DELIVERY_DATE>
                  <LATE_DELIVERY_DATE>
                    <xsl:value-of select="ns1:TimeWindow/ns1:LateDeliveryDate"/>
                  </LATE_DELIVERY_DATE>
                  <RELEASE_FREIGHT_COSTS>
                    <xsl:for-each select="ns1:ReleaseAllocationInfo/ns1:ReleaseAllocByType">
                      <xsl:if test='ns1:AllocTypeQualGid/ns1:Gid/ns1:Xid = "PLANNING"'>
                        <xsl:for-each select="ns1:ReleaseAllocShipment">
                          <RELEASE_FREIGHT_COSTS_ITEM>
                            <SHIPMENT_XID>
                              <xsl:value-of select="ns1:ShipmentGid/ns1:Gid/ns1:Xid"/>
                            </SHIPMENT_XID>
                            <MONETARY_AMOUNT>
                              <xsl:value-of select="ns1:TotalAllocCost/ns1:FinancialAmount/ns1:MonetaryAmount"/>
                            </MONETARY_AMOUNT>
                            <CURRENCY_CODE>
                              <xsl:value-of select="ns1:TotalAllocCost/ns1:FinancialAmount/ns1:GlobalCurrencyCode"/>
                            </CURRENCY_CODE>
                            <BASE_RATE>
                              <xsl:value-of select="ns1:TotalAllocCost/ns1:FinancialAmount/ns1:RateToBase"/>
                            </BASE_RATE>
                          </RELEASE_FREIGHT_COSTS_ITEM>
                        </xsl:for-each>
                      </xsl:if>
                    </xsl:for-each>
                  </RELEASE_FREIGHT_COSTS>
                </SHIPMENT_RELEASES_ITEM>
              </xsl:for-each>
            </SHIPMENT_RELEASES>
            <STOP_LOCATIONS>
              <xsl:for-each select="ns1:Location">
                <STOP_LOCATIONS_ITEM>
                  <LOCATION_XID>
                    <xsl:value-of select="ns1:LocationGid/ns1:Gid/ns1:Xid"/>
                  </LOCATION_XID>
                  <LOCATION_NAME>
                    <xsl:value-of select="ns1:LocationName"/>
                  </LOCATION_NAME>
                  <TIMEZONE_XID>
                    <xsl:value-of select="ns1:Address/ns1:TimeZoneGid/ns1:Gid/ns1:Xid"/>
                  </TIMEZONE_XID>
                  <LATITUDE>
                    <xsl:value-of select="ns1:Address/ns1:Latitude"/>
                  </LATITUDE>
                  <LONGITUDE>
                    <xsl:value-of select="ns1:Address/ns1:Longitude"/>
                  </LONGITUDE>
                </STOP_LOCATIONS_ITEM>
              </xsl:for-each>
            </STOP_LOCATIONS>
            <xsl:if test="/ns1:Transmission/ns1:TransmissionBody/ns1:GLogXMLElement/ns1:ActualShipment/ns1:Shipment/ns1:ShipmentHeader/ns1:ShipmentRefnum/ns1:ShipmentRefnumQualifierGid = 'ROUTE_NUMBER'">
              <ITINERARY_ID>
                <xsl:value-of select="ns1:ShipmentHeader/ns1:ShipmentRefnum/ns1:ShipmentRefnumValue"/>
              </ITINERARY_ID>
            </xsl:if>
            <xsl:if test="/ns1:Transmission/ns1:TransmissionBody/ns1:GLogXMLElement/ns1:ActualShipment/ns1:Shipment/ns1:ShipmentHeader/ns1:ShipmentRefnum/ns1:ShipmentRefnumQualifierGid = 'ROAD_NET'">            
            <MOBILECAST_FLAG>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:ShipmentRefnum/ns1:ShipmentRefnumValue"/>
            </MOBILECAST_FLAG>
            </xsl:if>
            <xsl:if test="/ns1:Transmission/ns1:TransmissionBody/ns1:GLogXMLElement/ns1:ActualShipment/ns1:Shipment/ns1:ShipmentHeader/ns1:ShipmentRefnum/ns1:ShipmentRefnumQualifierGid = 'MOBILE_CAST'">
            <ROADNET_FLAG>
              <xsl:value-of select="ns1:ShipmentHeader/ns1:ShipmentRefnum/ns1:ShipmentRefnumValue"/>
            </ROADNET_FLAG>
            </xsl:if>
          </P_INT_TRIP_INFO_ITEM>
        </xsl:for-each>
      </P_INT_TRIP_INFO>
    </ns2:InputParameters>
  </xsl:template>
</xsl:stylesheet>
